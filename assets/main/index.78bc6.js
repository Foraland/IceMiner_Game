window.__require=function t(e,n,o){function r(a,s){if(!n[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var u="function"==typeof __require&&__require;if(!s&&u)return u(c,!0);if(i)return i(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){return r(e[a][1][t]||t)},l,l.exports,t,e,n,o)}return n[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<o.length;a++)r(o[a]);return r}({AnimationManager:[function(t,e,n){"use strict";cc._RF.push(e,"f6d48dZfkZGQpINK4kw2KR8","AnimationManager"),Object.defineProperty(n,"__esModule",{value:!0}),n.AM=void 0;var o=t("../Controller/GameManager"),r=cc._decorator,i=(r.ccclass,r.property,function(t){this.animState=null,this.animSpeed=1,this.scaled=!0,this.animCom=t}),a=function(){function t(){}return t.play=function(t,e,n,r){void 0===n&&(n=1),void 0===r&&(r=!0);var a,s=t.play(e);s||console.error("\u52a8\u753b\u540d\u4e0d\u5b58\u5728\uff01\u8bf7\u68c0\u67e5",t.node.name,"\u4e2d\u7684\u52a8\u753b\u540d\uff1a",e),this.animMap.has(t)?((a=this.animMap.get(t)).animState=s,a.animSpeed=n,a.scaled=r,s.speed=a.scaled?o.default.Ins.timeScale*a.animSpeed:a.animSpeed):((a=new i(t)).animState=s,a.animSpeed=n,a.scaled=r,this.animMap.set(t,a),s.speed=a.scaled?o.default.Ins.timeScale*a.animSpeed:a.animSpeed)},t.setSpeed=function(t,e){if(this.animMap.has(t)){var n=this.animMap.get(t);n.animSpeed=e,n.animState.speed=n.scaled?o.default.Ins.timeScale*n.animSpeed:n.animSpeed}},t.updateScale=function(){this.animMap.forEach(function(t){t.animState.speed=t.scaled?o.default.Ins.timeScale*t.animSpeed:t.animSpeed})},t.getAnimState=function(t){var e;return null===(e=this.animMap.get(t))||void 0===e?void 0:e.animState},t.animMap=new Map,t}();n.AM=a,cc._RF.pop()},{"../Controller/GameManager":"GameManager"}],AreaInfo:[function(t,e,n){"use strict";cc._RF.push(e,"f7c5c9Xqi1PQKzz2w7+aidD","AreaInfo");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.OpenArea=void 0;var i=function(){function t(t){this.edgeGrids=[],this.areaGrids=[],this.map=t}return t.prototype.isInArea=function(t){return this.areaGrids.some(function(e){return e.crd.equals(t)})},t.prototype.isInEdge=function(t){return this.edgeGrids.some(function(e){return e.crd.equals(t)})},t.prototype.extendCrd=function(t){var e=this,n=this.map;if(t&&!t.isBlockVisual){this.isInEdge(t.crd)&&this.edgeGrids.splice(this.edgeGrids.findIndex(function(e){return e==t}),1);var o=n.searchAreaCrds(t.crd,function(t){return t.isBlockVisual&&!!e.edgeGrids.find(function(e){return e==t})||!t.isBlockVisual&&!!e.areaGrids.find(function(e){return e==t})});this.pushAreaToGrids(o.areas),this.pushAreaToGrids(o.edges),this.areaGrids=this.areaGrids.concat(o.areas),this.edgeGrids=this.edgeGrids.concat(o.edges)}},t.prototype.init=function(t){var e=this.map.searchAreaCrds(t);this.areaGrids=e.areas,this.edgeGrids=e.edges,this.pushAreaToGrids(this.areaGrids),this.pushAreaToGrids(this.edgeGrids)},t.prototype.pushAreaToGrids=function(t){var e=this;t.forEach(function(t){t.withAreas.find(function(t){return t==e})||(t.withAreas.push(e),e.attachAreaToGrid(t))})},t.prototype.removeAreaToGrids=function(t){var e=this;t.forEach(function(t){var n=t.withAreas.findIndex(function(t){return t==e});n>=0&&(t.withAreas.splice(n,1),e.detachAreaToGrid(t))})},t.prototype.attachAreaToGrid=function(){},t.prototype.detachAreaToGrid=function(){},t.prototype.clear=function(){this.removeAreaToGrids(this.areaGrids),this.removeAreaToGrids(this.edgeGrids),this.areaGrids=[],this.edgeGrids=[]},t}();n.default=i;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e}(i);n.OpenArea=a,cc._RF.pop()},{}],ArenaManager:[function(t,e,n){"use strict";cc._RF.push(e,"228957zG75I9odfzvaIrtKG","ArenaManager");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var u,l,f=t("./Controller/Drops"),p=t("./Controller/Map/MapCtrl"),h=t("./Controller/Map/TileTips"),d=t("./Controller/Monster/Monster"),g=t("./Controller/Player/PlayerCtrl"),y=t("./Controller/ScreenEffectMask"),m=t("./UI/FairyUI/U_HUD"),_=t("./UI/UI"),v=t("./Utils/CocosExtension"),I=t("./Utils/StateCtrl"),b=cc._decorator,C=b.ccclass;b.property,function(t){t[t.awaitToTrigger=0]="awaitToTrigger",t[t.inTurn=1]="inTurn",t[t.awaitToGetDrop=2]="awaitToGetDrop"}(u||(u={})),function(t){t[t.Close=0]="Close",t[t.Open=1]="Open"}(l||(l={}));var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.createEnemyFunc=null,e.createDropFunc=null,e.nextTriggerCrd=cc.v2(51,22),e.closeBlockCrds=[cc.v2(50,26),cc.v2(51,26),cc.v2(52,26)],e.rewardBlockCrd=[cc.v2(52,18),cc.v2(51,18),cc.v2(50,18),cc.v2(52,17),cc.v2(50,17),cc.v2(52,16),cc.v2(51,16),cc.v2(50,16)],e.ldFlagCrd=cc.v2(41,24),e.ruFlagCrd=cc.v2(61,13),e.rewardFlagCrd=cc.v2(51,17),e.turnNum=1,e.monsters=[],e.drops=null,e.maxMonsterCnt=0,e}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return n.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;n.instance=this,this.rewardState=new I.default(l.Close).bindState(l.Close,function(){t.drops&&(t.drops.off(f.EDropsEvent.Pickup,t.onGetDrops,t),t.drops.clear()),t.drops=null}).bindTrans(l.Close,l.Open,function(){t.createDropFunc&&(t.createDropFunc(),t.createDropFunc=null),t.drops&&t.drops.once(f.EDropsEvent.Pickup,t.onGetDrops,t)}),this.rewardDoorState=new I.default(l.Close).bindState(l.Close,function(){return t.rewardBlockCrd.forEach(function(t){return p.default.Ins.setObj(15,p.default.Ins.getGrid(t))})}).bindState(l.Open,function(){return t.rewardBlockCrd.forEach(function(t){return p.default.Ins.clearObj(p.default.Ins.getGrid(t))})}).bindTrans(l.Close,l.Open,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.rewardBlockCrd.forEach(function(t){return p.default.Ins.clearObj(p.default.Ins.getGrid(t))}),[4,this.highlightAsync(this.rewardBlockCrd)];case 1:return t.sent(),[2]}})})}).bindTrans(l.Open,l.Close,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.rewardBlockCrd.forEach(function(t){return p.default.Ins.setObj(15,p.default.Ins.getGrid(t))}),[4,this.highlightAsync(this.rewardBlockCrd)];case 1:return t.sent(),[2]}})})}),this.doorState=new I.default(l.Open).bindState(l.Close,function(){return t.closeBlockCrds.forEach(function(t){return p.default.Ins.setObj(14,p.default.Ins.getGrid(t))})}).bindState(l.Open,function(){return t.closeBlockCrds.forEach(function(t){return p.default.Ins.clearObj(p.default.Ins.getGrid(t))})}).bindTrans(l.Close,l.Open,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.highlightAsync(this.closeBlockCrds)];case 1:return[2,t.sent()]}})})}).bindTrans(l.Open,l.Close,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.highlightAsync(this.closeBlockCrds)];case 1:return[2,t.sent()]}})})}),this.triggerState=new I.default(l.Open).bindState(l.Open,function(){return p.default.Ins.setObj(17,p.default.Ins.getGrid(t.nextTriggerCrd))}).bindState(l.Close,function(){return p.default.Ins.clearObj(p.default.Ins.getGrid(t.nextTriggerCrd))}).bindTrans(l.Close,l.Open,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return p.default.Ins.setObj(17,p.default.Ins.getGrid(this.nextTriggerCrd)),[4,this.highlightAsync([this.nextTriggerCrd])];case 1:return t.sent(),[2]}})})}),this.state=new I.default(u.awaitToTrigger).bindState(u.awaitToTrigger,function(){t.triggerState.refreshTo(l.Open),t.doorState.refreshTo(l.Open),t.rewardState.refreshTo(l.Close),t.rewardDoorState.refreshTo(l.Open)}).bindState(u.awaitToGetDrop,function(){t.triggerState.refreshTo(l.Close),t.doorState.refreshTo(l.Open),t.rewardState.refreshTo(l.Open),t.rewardDoorState.refreshTo(l.Open)}).bindState(u.inTurn,function(){t.triggerState.refreshTo(l.Close),t.doorState.refreshTo(l.Close),t.rewardState.refreshTo(l.Open),t.rewardDoorState.refreshTo(l.Close)}).bindTrans(u.awaitToTrigger,u.inTurn,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.triggerState.switchTo(l.Close),_.default.getUI(m.default).enterTips(m.EHUDTipsEnum.arenaTips),[4,p.default.Ins.focusToCrdAsync(this.rewardFlagCrd)];case 1:return t.sent(),this.rewardState.switchTo(l.Open),[4,this.rewardDoorState.switchTo(l.Close)];case 2:return t.sent(),[4,p.default.Ins.focusToCrdAsync(this.closeBlockCrds[1])];case 3:return t.sent(),[4,this.doorState.switchTo(l.Close)];case 4:return t.sent(),[4,p.default.Ins.returnToPlayer()];case 5:return t.sent(),[4,v.delay(300)];case 6:return t.sent(),y.default.Ins.fadeIn(.5,cc.Color.WHITE,150),this.createEnemyFunc&&(this.createEnemyFunc(),this.createEnemyFunc=null),[2]}})})}).bindTrans(u.inTurn,u.awaitToGetDrop,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return _.default.getUI(m.default).exitTips(m.EHUDTipsEnum.arenaTips),[4,p.default.Ins.focusToCrdAsync(this.rewardFlagCrd)];case 1:return t.sent(),[4,this.rewardDoorState.switchTo(l.Open)];case 2:return t.sent(),[4,p.default.Ins.focusToCrdAsync(this.closeBlockCrds[1])];case 3:return t.sent(),[4,this.doorState.switchTo(l.Open)];case 4:return t.sent(),[4,p.default.Ins.returnToPlayer()];case 5:return t.sent(),[2]}})})}).bindTrans(u.awaitToGetDrop,u.awaitToTrigger,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,p.default.Ins.focusToCrdAsync(this.nextTriggerCrd)];case 1:return t.sent(),[4,this.triggerState.switchTo(l.Open)];case 2:return t.sent(),[4,p.default.Ins.returnToPlayer()];case 3:return t.sent(),[2]}})})})},e.prototype.isInArena=function(t){return t.x>=this.ldFlagCrd.x&&t.y<=this.ldFlagCrd.y&&t.x<=this.ruFlagCrd.x&&t.y>=this.ruFlagCrd.y},e.prototype.init=function(){},e.prototype.onTriggerNextTurn=function(){this.state.is(u.awaitToTrigger)&&this.startTurn()},e.prototype.startTurn=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(e){switch(e.label){case 0:return this.clearArena(),1==this.turnNum?(this.maxMonsterCnt=10,this.createEnemyFunc=function(){t.createEnemy(2,10)},this.createDropFunc=function(){var e=p.default.Ins.getGrid(t.rewardFlagCrd),n=p.default.Ins.createDrops(e,32,1);t.drops=n}):2==this.turnNum?(this.maxMonsterCnt=20,this.createEnemyFunc=function(){t.createEnemy(1,5),t.createEnemy(2,15)},this.createDropFunc=function(){var e=p.default.Ins.getGrid(t.rewardFlagCrd),n=p.default.Ins.createDrops(e,33,1);t.drops=n}):3==this.turnNum?(this.maxMonsterCnt=20,this.createEnemyFunc=function(){t.createEnemy(1,4),t.createEnemy(3,1),t.createEnemy(2,15)},this.createDropFunc=function(){var e=p.default.Ins.getGrid(t.rewardFlagCrd),n=p.default.Ins.createDrops(e,34,1);t.drops=n}):4==this.turnNum?(this.maxMonsterCnt=20,this.createEnemyFunc=function(){t.createEnemy(1,5),t.createEnemy(3,3),t.createEnemy(2,12)},this.createDropFunc=function(){var e=p.default.Ins.getGrid(t.rewardFlagCrd),n=p.default.Ins.createDrops(e,35,1);t.drops=n}):(this.maxMonsterCnt=1,this.createEnemyFunc=function(){t.createEnemy(4,1)[0].addDrops(41,1)},this.createDropFunc=function(){var e=p.default.Ins.getGrid(t.rewardFlagCrd),n=p.default.Ins.createDrops(e,35,1);t.drops=n}),g.default.Ins.banInput=!0,[4,this.state.switchTo(u.inTurn)];case 1:return e.sent(),g.default.Ins.banInput=!1,[2]}})})},e.prototype.leaveArena=function(){g.default.Ins.setCrdPos(p.default.Ins.spawnCrd),this.reset()},e.prototype.finishTurn=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.maxMonsterCnt=0,_.default.getUI(m.default).exitTips(m.EHUDTipsEnum.arenaTips),g.default.Ins.banInput=!0,[4,this.state.switchTo(u.awaitToGetDrop)];case 1:return t.sent(),g.default.Ins.banInput=!1,this.turnNum++,[2]}})})},e.prototype.update=function(){this.state.is(u.inTurn)},e.prototype.onGetDrops=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return g.default.Ins.banInput=!0,[4,this.state.switchTo(u.awaitToTrigger)];case 1:return t.sent(),g.default.Ins.banInput=!1,[2]}})})},e.prototype.highlightAsync=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(){return e=t.length,[2,new Promise(function(n){t.forEach(function(t){var o=p.default.Ins.getGrid(t);h.default.Ins.fullHighLightTile(o,cc.Color.WHITE,255,function(){--e<=0&&n()})})})]})})},e.prototype.createEnemy=function(t,e){for(var n=[],o=0;o<e;o++){var r=this.randCrd(),i=p.default.Ins.createMonster(t,r);this.monsters.push(i),i.once(d.EMonsterEvent.Dead,this.onDieMonster,this),n.push(i)}return n},e.prototype.onDieMonster=function(t){this.monsters.splice(this.monsters.indexOf(t),1),0==this.monsters.length&&this.finishTurn()},e.prototype.randCrd=function(){var t=Math.round(Math.random()*(this.ruFlagCrd.x-this.ldFlagCrd.x))+this.ldFlagCrd.x,e=Math.round(Math.random()*(this.ruFlagCrd.y-this.ldFlagCrd.y))+this.ldFlagCrd.y,n=cc.v2(t,e);return p.default.Ins.getGrid(n).isBlockMove||n.equals(this.rewardFlagCrd)?this.randCrd():n},e.prototype.clearArena=function(){var t=this;this.drops&&(this.drops.off(f.EDropsEvent.Pickup,this.onGetDrops,this),this.drops.clear()),this.drops=null,c(this.monsters).forEach(function(e){e.off(d.EMonsterEvent.Dead,t.onDieMonster,t),e.clear()}),this.monsters=[]},e.prototype.reset=function(){this.clearArena(),this.state.refreshTo(u.awaitToTrigger)},e.instance=null,n=i([C],e)}(cc.Component);n.default=M,window.ArenaManager=M,cc._RF.pop()},{"./Controller/Drops":"Drops","./Controller/Map/MapCtrl":"MapCtrl","./Controller/Map/TileTips":"TileTips","./Controller/Monster/Monster":"Monster","./Controller/Player/PlayerCtrl":"PlayerCtrl","./Controller/ScreenEffectMask":"ScreenEffectMask","./UI/FairyUI/U_HUD":"U_HUD","./UI/UI":"UI","./Utils/CocosExtension":"CocosExtension","./Utils/StateCtrl":"StateCtrl"}],AutoSorting:[function(t,e,n){"use strict";cc._RF.push(e,"01992srLJVKZr1iEt9RfqOP","AutoSorting");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.update=function(){for(var t=this.node.children,e=0;e<t.length;e++)t[e].zIndex=-t[e].y},i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],Bat2Monster:[function(t,e,n){"use strict";cc._RF.push(e,"9a50cdj3KdBLbzt/Vt3CtUc","Bat2Monster");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Map/MapCtrl"),s=t("../../Player/PlayerCtrl"),c=t("./BatMonster"),u=cc._decorator,l=u.ccclass,f=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.isReadyToAttack=function(){if(this.isTooFar)return!1;var t=s.default.Ins.curCrd,e=this.curCrd,n=t.sub(e);return Math.abs(n.x)<=1&&Math.abs(n.y)<=1},e.prototype.getAttackGrids=function(){for(var t=s.default.Ins.curCrd,e=this.curCrd,n=t.sub(e),o=[],r=(this.curCrd,[cc.v2(0,0),cc.v2(0,1),cc.v2(1,0),cc.v2(1,1)]),i=n.x>=0?1:-1,c=n.y>=0?1:-1,u=0;u<r.length;u++){var l=this.curCrd.add(cc.v2(r[u].x*i,r[u].y*c)),f=a.default.Ins.getGrid(l);f&&!f.isBlockMove&&o.push(f)}return o},i([l],e)}(c.default));n.default=f,cc._RF.pop()},{"../../Map/MapCtrl":"MapCtrl","../../Player/PlayerCtrl":"PlayerCtrl","./BatMonster":"BatMonster"}],BatMonster:[function(t,e,n){"use strict";cc._RF.push(e,"e76dfW7/69N079aRNNjjQl7","BatMonster");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Map/MapCtrl"),s=t("../../Player/PlayerCtrl"),c=t("../Monster"),u=cc._decorator,l=u.ccclass,f=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.isFindPlayer=function(){if(this.isTooFar)return!1;var t=a.default.Ins.findPathByDir8(this.curCrd,s.default.Ins.curCrd,function(t){return!t.isBlockMove},5);return!(!t||t.isEmpty)},e.prototype.getAttackGrids=function(){var t=s.default.Ins.curCrd,e=this.curCrd,n=t.sub(e),o=[];return o.push(a.default.Ins.getGrid(this.curCrd)),n.x>0?o.push(a.default.Ins.getGrid(this.curCrd.add(cc.v2(1,0)))):n.x<0?o.push(a.default.Ins.getGrid(this.curCrd.add(cc.v2(-1,0)))):n.y<0?o.push(a.default.Ins.getGrid(this.curCrd.add(cc.v2(0,-1)))):o.push(a.default.Ins.getGrid(this.curCrd.add(cc.v2(0,1)))),o},e.prototype.isReadyToAttack=function(){if(this.isTooFar)return!1;var t=s.default.Ins.curCrd,e=this.curCrd,n=t.sub(e);return Math.abs(n.x)+Math.abs(n.y)<=1},e.prototype.switchState=function(e,n){t.prototype.switchState.call(this,e,n),console.warn("bat switch to",e)},i([l],e)}(c.default));n.default=f,cc._RF.pop()},{"../../Map/MapCtrl":"MapCtrl","../../Player/PlayerCtrl":"PlayerCtrl","../Monster":"Monster"}],BlockCrack:[function(t,e,n){"use strict";cc._RF.push(e,"9bf34CgROtJOp3mzgxKjHOL","BlockCrack");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Managers/AnimationManager"),s=cc._decorator,c=s.ccclass,u=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.crackTex=[],e.crackLight=[],e.crack=null,e.crackBg=null,e.broken=null,e.endCall=null,e}return r(e,t),e.prototype.setData=function(t,e,n){this.endCall=n,this.crackBg.node.color=e,this.broken.node.color=e;var o=this.getComponent(cc.Animation);t>=0?(this.crack.spriteFrame=this.crackTex[t],this.crackBg.spriteFrame=this.crackLight[t],this.crackBg.node.rotation=360*Math.random(),a.AM.play(o,"crack")):a.AM.play(o,"broken")},e.prototype.A_EndCrack=function(){this.endCall&&this.endCall(),this.endCall=null},i([u(cc.SpriteFrame)],e.prototype,"crackTex",void 0),i([u(cc.SpriteFrame)],e.prototype,"crackLight",void 0),i([u(cc.Sprite)],e.prototype,"crack",void 0),i([u(cc.Sprite)],e.prototype,"crackBg",void 0),i([u(cc.Sprite)],e.prototype,"broken",void 0),i([c],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../Managers/AnimationManager":"AnimationManager"}],BlockObj:[function(t,e,n){"use strict";cc._RF.push(e,"455d2K128VNGrVtDHL7L1zM","BlockObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../Managers/SoundManager"),c=t("../../../Operator"),u=t("../../CameraCtrl"),l=t("../../Player/PlayerCtrl"),f=t("../MapCtrl"),p=t("../TileDrops"),h=t("../TileTips"),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.digTime=1,e.hp=100,e}return r(e,t),Object.defineProperty(e.prototype,"blockCfg",{get:function(){var t=this;return config.BlockObj.list.find(function(e){return e.objId==t.objId})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"quality",{get:function(){var t=config.Quality.WHITE;return this.drops.forEach(function(e){var n=config.Item.getById(e.resId),o=n?n.quality:config.Quality.WHITE;o>t&&(t=o)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlockMove",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.digged=function(t){var e=this;if(t<this.blockCfg.threshold)return l.EDigRet.Fail;this.hp-=t,s.SoundManager.playEffect(Math.random()<.5?s.SoundType.Dig:s.SoundType.Dig2);var n=cc.Color.fromHEX(cc.color(),config.QualityColor.getById(this.quality).color);if(this.hp>0)return this.grid&&h.default.Ins.crackBlock(this.grid,this.hp/this.blockCfg.hp,n,function(){return e.hp=e.blockCfg.hp}),u.default.Ins.shake(1.5),l.EDigRet.Common;s.SoundManager.playEffect(s.SoundType.Crack),h.default.Ins.breakBlock(this.grid,n);var o=this.grid;return c.default.applyDig(this.grid,function(){e.finishDig(o)}),l.EDigRet.Finish},e.prototype.finishDig=function(t){this.drops.forEach(function(e){var n=e.num,o=e.resId;f.default.Ins.createDrops(t,o,n)}),f.default.Ins.exploreGrid(t)},e.prototype.exploded=function(t){return i(this,void 0,void 0,function(){var e;return a(this,function(){return e=this.grid,t>=this.blockCfg.threshold&&(this.finishDig(e),s.SoundManager.playEffect(Math.random()<.5?s.SoundType.Dig:s.SoundType.Dig2),e.clearObj()),f.default.Ins.exploreGrid(e),[2]})})},e.prototype.onClick=function(){return i(this,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,c.default.canDig(this.grid)];case 1:return t.sent()&&l.default.Ins.moveToDig(this),[2]}})})},e.prototype.init=function(e){if(t.prototype.init.call(this,e),this.blockCfg.dropsId)for(var n=0;n<this.blockCfg.dropsId.length;n++)this.blockCfg.dropsId[n]>0&&this.drops.push(new p.default(this.blockCfg.dropsId[n],this.blockCfg.dropsNum[n]));this.hp=this.blockCfg.hp},e}(t("./TileObject").default);n.default=d,cc._RF.pop()},{"../../../Managers/SoundManager":"SoundManager","../../../Operator":"Operator","../../CameraCtrl":"CameraCtrl","../../Player/PlayerCtrl":"PlayerCtrl","../MapCtrl":"MapCtrl","../TileDrops":"TileDrops","../TileTips":"TileTips","./TileObject":"TileObject"}],BoardcastItemBase:[function(t,e,n){"use strict";cc._RF.push(e,"9265aragEFBP7znjG/6os9K","BoardcastItemBase");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetY=0,e.startTime=0,e}return r(e,t),Object.defineProperty(e.prototype,"height",{get:function(){return 45},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortingOrder",{get:function(){return 0},enumerable:!1,configurable:!0}),e.prototype.update=function(){var t=cc.misc.lerp(this.node.y,this.targetY,.1);this.node.position=cc.v3(0,t,0)},i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],BoardcastItemNew:[function(t,e,n){"use strict";cc._RF.push(e,"39159YywLVFlZSSMJxhR/4f","BoardcastItemNew");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Res"),s=t("./BoardcastItemBase"),c=cc._decorator,u=c.ccclass,l=c.property,f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"height",{get:function(){return 80},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sortingOrder",{get:function(){return 1},enumerable:!1,configurable:!0}),e.prototype.setData=function(t){var e=config.Item.getById(t),n=cc.Color.fromHEX(cc.color(),config.QualityColor.getById(e.quality).color);this.img.spriteFrame=a.default.Ins.getSprite(e.url),this.lbl.string=e.name,this.lbl.node.color=n,this.desc.string=e.desc},i([l(cc.Sprite)],e.prototype,"img",void 0),i([l(cc.Label)],e.prototype,"lbl",void 0),i([l(cc.Label)],e.prototype,"desc",void 0),i([u],e)}(s.default);n.default=f,cc._RF.pop()},{"../../Res":"Res","./BoardcastItemBase":"BoardcastItemBase"}],BoardcastItem:[function(t,e,n){"use strict";cc._RF.push(e,"c6be3vBpPtKgoB5MEAZ68/p","BoardcastItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Res"),s=t("./BoardcastItemBase"),c=cc._decorator,u=c.ccclass,l=c.property,f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setData=function(t,e){var n=config.Item.getById(t),o=n.url,r=n.name+"+"+e,i=cc.Color.fromHEX(cc.color(),config.QualityColor.getById(n.quality).color);this.img.spriteFrame=a.default.Ins.getSprite(o),this.lbl.string=r,this.lbl.node.color=i},i([l(cc.Sprite)],e.prototype,"img",void 0),i([l(cc.Label)],e.prototype,"lbl",void 0),i([u],e)}(s.default);n.default=f,cc._RF.pop()},{"../../Res":"Res","./BoardcastItemBase":"BoardcastItemBase"}],BossRegion:[function(t,e,n){"use strict";cc._RF.push(e,"06112x+QARMO7Dgnj6Qh+P6","BossRegion");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Managers/EventCenter"),s=t("../Monster/Monster"),c=t("./MapCtrl"),u=t("./Region"),l=cc._decorator,f=l.ccclass,p=(l.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isBossClear=!1,e}return r(e,t),e.prototype.playerEnter=function(){t.prototype.playerEnter.call(this);var e=c.default.Ins.createMonster(this.cfg.bossId,c.default.Ins.lp2crd(this.centerPos));if(e.flagArea=this,this.isBossClear)for(var n=0;n<this.cfg.reward2Ids.length;n++)e.addDrops(this.cfg.reward2Ids[n],this.cfg.reward2Nums[n],!0);else for(n=0;n<this.cfg.rewardIds.length;n++)e.addDrops(this.cfg.rewardIds[n],this.cfg.rewardNums[n],!0);e.on(s.EMonsterEvent.Dead,this.onBossDead,this)},e.prototype.onBossDead=function(){this.isBossClear||a.default.send(a.E_ClearBoss,this.cfg.id),this.isBossClear=!0},e.prototype.playerExit=function(){var e=this;t.prototype.playerExit.call(this),this.monsters.forEach(function(t){t.clear(),t.off(s.EMonsterEvent.Dead,e.onBossDead,e)}),this.monsters=[]},e.prototype.getStorageData=function(){return{id:this.id,isClearBoss:this.isBossClear,isUnlock:this.isUnlock,teleport:this.teleport?this.teleport.getData():null}},e.prototype.load=function(e){t.prototype.load.call(this,e),e&&(this.isBossClear=e.isClearBoss)},i([f],e)}(u.default));n.default=p,cc._RF.pop()},{"../../Managers/EventCenter":"EventCenter","../Monster/Monster":"Monster","./MapCtrl":"MapCtrl","./Region":"Region"}],BpItem:[function(t,e,n){"use strict";cc._RF.push(e,"a3c167yibhPcamjexNZyAZN","BpItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../FairyUI/U_ItemDetail"),a=t("../UI"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setData=function(t,e,n){this.getChild("icon").asLoader.url=e,this.resId=t,this.getChild("num").visible=n>1,this.getChild("num").asLabel.text=n.toString();var o=config.Item.getById(t);this.getChild("frame").asCom.getController("cQuality").selectedIndex=o.quality,this.onClick(this.onClickItem,this)},e.prototype.onClickItem=function(t){t.stopPropagation(),a.default.getUI(i.default).setData(this.resId)},e}(fairygui.GComponent);n.default=s,cc._RF.pop()},{"../FairyUI/U_ItemDetail":"U_ItemDetail","../UI":"UI"}],BuildItem:[function(t,e,n){"use strict";cc._RF.push(e,"e9842ksapxMmKUZiQiXeHds","BuildItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../Model/Inventory"),a=t("../UI"),s=t("../U_TaskTips"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onConfirm=null,e.onCancel=null,e.lock=!1,e}return r(e,t),e.prototype.setData=function(t,e,n,o,r){var a=config.Works.getById(t),s=i.default.Ins.buildLockMap.get(t);this.getController("cLock").selectedIndex=s?1:0,this.getChild("icon").asLoader.url=n,this.getChild("name").asLabel.text=a.worksName,this.getController("cSelect").selectedIndex=e?1:0,this.lock=s,this.onConfirm=o,this.onCancel=r,this.onClick(this.onClickItem,this)},e.prototype.onClickItem=function(t){t.stopPropagation(),this.lock?(a.default.getUI(s.default).setTxt("\u9700\u8981\u84dd\u56fe"),this.onCancel&&this.onCancel()):this.onConfirm&&this.onConfirm()},e}(fairygui.GComponent);n.default=c,cc._RF.pop()},{"../../Model/Inventory":"Inventory","../UI":"UI","../U_TaskTips":"U_TaskTips"}],CameraCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"d8df2DwtU5CHL/KdkAHC5wR","CameraCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Managers/EffectManager"),s=t("./Map/MapCtrl"),c=cc._decorator,u=c.ccclass,l=c.property,f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r(e,t),n=e,Object.defineProperty(e.prototype,"cameraZoom",{set:function(t){s.default.Ins.effectZoom=t,s.default.Ins.refreshZoom()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Ins",{get:function(){return n.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this},e.prototype.shake=function(t){void 0===t&&(t=5),a.default.shakeNode(this.node,{amp:t})},e.prototype.scaled=function(t,e){var n=this;this.cameraZoom=t,cc.tween(this).delay(e).call(function(){return n.cameraZoom=1}).start()},e.instance=null,i([l(cc.Camera)],e.prototype,"camera",void 0),n=i([u],e)}(cc.Component);n.default=f,cc._RF.pop()},{"../Managers/EffectManager":"EffectManager","./Map/MapCtrl":"MapCtrl"}],ChestAnim:[function(t,e,n){"use strict";cc._RF.push(e,"47fe35mCnRKIaJVyJ3XoGx2","ChestAnim");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./Managers/AnimationManager"),s=t("./Managers/PoolManager"),c=cc._decorator,u=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.openCall=null,e}return r(e,t),e.prototype.setData=function(t,e){this.openCall=e;var n=this.getComponent(cc.Animation);a.AM.play(n,"chest"+t),n.on(cc.Animation.EventType.FINISHED,this.onEndAnim,this)},e.prototype.onEndAnim=function(){s.PoolManager.PutPrefab(this.node)},e.prototype.A_open=function(){this.openCall&&this.openCall(),this.openCall=null},i([u],e)}(cc.Component));n.default=l,cc._RF.pop()},{"./Managers/AnimationManager":"AnimationManager","./Managers/PoolManager":"PoolManager"}],ChestObj:[function(t,e,n){"use strict";cc._RF.push(e,"7b0e4GYziVA2KitMB3w77hz","ChestObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../MapCtrl"),a=t("../TileDrops"),s=t("../TileTips"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.drops=[],e}return r(e,t),Object.defineProperty(e.prototype,"isBlockMove",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.addDrops=function(t,e){this.drops.push(new a.default(t,e))},e.prototype.init=function(e){t.prototype.init.call(this,e);var n=this.cfg.type.split("_")[1],o=Math.random(),r=function(t,e){return Math.floor(Math.random()*(e-t)+t)};switch(n){case"copper":this.addDrops(3,r(4,14)),this.addDrops(109,r(1,4)),o<.4&&this.addDrops(80,3),o<.1&&this.addDrops(81,1),Math.random()<.1?this.addDrops(69,1):Math.random()<.02?this.addDrops(70,1):Math.random()<.005&&this.addDrops(71,1),Math.random()<.2&&this.addDrops(64,1),Math.random()<.05&&this.addDrops(65,1);break;case"iron":this.addDrops(4,r(4,14)),this.addDrops(109,r(2,5)),o<.4&&this.addDrops(81,3),o<.1&&this.addDrops(82,1),Math.random()<.1?this.addDrops(70,1):Math.random()<.02?this.addDrops(71,1):Math.random()<.005&&this.addDrops(72,1),Math.random()<.2&&this.addDrops(65,1),Math.random()<.05&&this.addDrops(66,1);break;case"silver":this.addDrops(5,r(4,14)),this.addDrops(109,r(3,6)),o<.4&&this.addDrops(82,2),o<.1&&this.addDrops(83,1),Math.random()<.1?this.addDrops(71,1):Math.random()<.02?this.addDrops(72,1):Math.random()<.005&&this.addDrops(73,1),Math.random()<.2&&this.addDrops(66,1),Math.random()<.05&&this.addDrops(67,1);break;case"gold":this.addDrops(6,r(4,14)),this.addDrops(109,r(4,6)),o<.4&&this.addDrops(83,2),Math.random()<.1?this.addDrops(72,1):Math.random()<.02&&this.addDrops(73,1),Math.random()<.2&&this.addDrops(67,1),Math.random()<.05&&this.addDrops(68,1);break;case"iridium":this.addDrops(7,r(4,14)),this.addDrops(109,r(4,6)),o<.4&&this.addDrops(83,r(2,4)),Math.random()<.2&&this.addDrops(68,1);break;case"food":this.addDrops(39,r(3,6)),this.addDrops(40,r(1,3));break;case"food2":this.addDrops(39,r(6,11)),this.addDrops(40,r(3,7));break;case"super":this.addDrops(13,1),this.addDrops(14,1),this.addDrops(15,1),this.addDrops(16,1),this.addDrops(17,1),this.addDrops(18,1),this.addDrops(19,1),this.addDrops(20,1),this.addDrops(21,1),this.addDrops(22,1),this.addDrops(64,30),this.addDrops(65,30),this.addDrops(66,30),this.addDrops(67,30),this.addDrops(68,30)}},e.prototype.getAnimIndex=function(){switch(this.cfg.type.split("_")[1]){case"copper":return 1;case"iron":return 2;case"silver":return 3;case"gold":return 4;case"iridium":return 5;case"food":case"food2":case"super":return-1}},e.prototype.onClick=function(){var t=this,e=this.drops.length,n=this.grid.crd,o=i.default.Ins.findEmptyGrids(n,e);s.default.Ins.fullHighLightTile(this.grid,cc.Color.CYAN,255);var r=this.getAnimIndex();if(r>=0)s.default.Ins.showChestAnim(this.grid,r,function(){for(var r=function(e){s.default.Ins.flyIcon(t.drops[e].resId,i.default.Ins.crd2lp(n),i.default.Ins.crd2lp(o[e].crd),function(){i.default.Ins.createDrops(o[e],t.drops[e].resId,t.drops[e].num)},!1)},a=0;a<e;a++)r(a)});else for(var a=function(e){s.default.Ins.flyIcon(c.drops[e].resId,i.default.Ins.crd2lp(n),i.default.Ins.crd2lp(o[e].crd),function(){i.default.Ins.createDrops(o[e],t.drops[e].resId,t.drops[e].num)},!1)},c=this,u=0;u<e;u++)a(u);this.grid.clearObj()},e}(t("./TileObject").default);n.default=c,cc._RF.pop()},{"../MapCtrl":"MapCtrl","../TileDrops":"TileDrops","../TileTips":"TileTips","./TileObject":"TileObject"}],CocosExtension:[function(t,e,n){"use strict";cc._RF.push(e,"ea6b8LDqilORpoW3ku2Fm8i","CocosExtension");var o,r,i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};function u(t){return a(this,void 0,Promise,function(){return s(this,function(){return[2,new Promise(function(e,n){cc.assetManager.loadBundle(t,{version:""},function(t,o){t?(console.error("loadBundle error",t),n()):e(o)})})]})})}function l(t,e){return a(this,void 0,Promise,function(){var n,o,r,i;return s(this,function(a){switch(a.label){case 0:if(!e)return[2,null];n=["resources","artres"],o=0,a.label=1;case 1:return o<n.length?(r=n[o],[4,f(t,e,r)]):[3,4];case 2:if(null!=(i=a.sent()))return[2,i];a.label=3;case 3:return o++,[3,1];case 4:return console.warn("loadRes err",e),[2,null]}})})}function f(t,e,n){return a(this,void 0,Promise,function(){var o=this;return s(this,function(){return[2,new Promise(function(r){return a(o,void 0,void 0,function(){var o,i;return s(this,function(a){switch(a.label){case 0:return null!=(o=h(t,e,n))?(r(o),[2]):(i=cc.assetManager.getBundle(n))?[3,2]:[4,u(n)];case 1:i=a.sent(),a.label=2;case 2:return i.getInfoWithPath(e)?i.load(e,t,function(t,e){r(t?null:e)}):r(null),[2]}})})})]})})}function p(t,e,n){return a(this,void 0,Promise,function(){var o=this;return s(this,function(){return[2,new Promise(function(r){return a(o,void 0,void 0,function(){var o;return s(this,function(i){switch(i.label){case 0:return null!=h(t,e,n)?(r(!0),[2]):(o=cc.assetManager.getBundle(n))?[3,2]:[4,u(n)];case 1:o=i.sent(),i.label=2;case 2:return o.getInfoWithPath(e)?o.preload(e,t,function(t){r(!t)}):r(null),[2]}})})})]})})}function h(t,e,n){if(!e)return null;var o=d(t,e,n);return o&&cc.assetManager.assets.get(o)||null}function d(t,e,n){var o=cc.assetManager.bundles;if(o.has(n)){var r=o.get(n),i=r.getInfoWithPath(e,t);if(i&&i.redirect){if(!o.has(i.redirect))throw new Error("you need to load bundle "+i.redirect+" first");i=(r=o.get(i.redirect)).getAssetInfo(i.uuid)}return i?i.uuid:null}}function g(t,e){if(void 0===e&&(e=o.BorderScale),t.node&&t.spriteFrame&&e!=o.None){t.sizeMode!=cc.Sprite.SizeMode.CUSTOM&&console.warn("scaleImage sizemode error,node name:"+t.node.name),t.trim=!1;var n=t.spriteFrame.getOriginalSize(),r=t.node.width,i=t.node.height,a=r/n.width,s=i/n.height,c=e==o.BorderScale?Math.min(a,s):Math.max(a,s);t.node.scaleX=c*n.width/r,t.node.scaleY=c*n.height/i}}Object.defineProperty(n,"__esModule",{value:!0}),n.formatTime=n.formateDate=n.zero=n.formatMinute=n.formatMinuteUnit=n.formatHour=n.formatTimeHMS=n.formatTimeHMS_str=n.formatNumberDot=n.formatLongName=n.formatStrEnter=n.getBit=n.getDeltaTime=n.randomByWeight=n.shuffle=n.switchMatt=n.rangeValue=n.randomNumber=n.randomInt=n.invokeCallback=n.updateNow=n.convertPosition=n.toParent=n.seedRandomInt=n.seedRandom=n.scaleImage=n.findConfig=n.loadRemote=n.loadImage=n.loadSpine=n.compareVersion=n.path2uuid=n.loadNode=n.getRes=n.preloadBundleRes=n.loadBundleRes=n.preloadRes=n.loadRes=n.preloadBundles=n.loadBundle=n.isSameDay=n.promiseCancelable=n.throttle=n.hasStr=n.TransPos=n.randomElement=n.delay=n.initResLoader=n.FpsMode=n.ImageFillMode=void 0,n.SystemInfo=n.serializable=n.log=n.getUrlParamMap=n.ShakeType=n.getZeroTimeStamp=n.getTimeStamp=n.setDownloaderRemoteAddress=n.weightRandom=n.enumLength=n.inject=n.deepClone=n.clone=n.showNodeDebug=n.showUiDebug=n.changeSpineSlot=n.isIOS=n.isAndroid=n.isWX_AND=n.isWX_IOS=n.isDevelopment=n.isQQ=n.isTT=n.isApp=n.isMiniGame=n.isWeb=n.isWX=n.isValue=n.byteToInt=n.objToMap=n.mapToObj=n.obj2Urlstr=n.isNullEmptyOrSpace=n.uniqueArr=n.removeFromArr=n.segmentFunc=n.randomInts=n.date2BeijingUnixMilli=void 0,function(t){t[t.None=0]="None",t[t.BorderScale=1]="BorderScale",t[t.FullScale=2]="FullScale"}(o=n.ImageFillMode||(n.ImageFillMode={})),function(t){t[t.Auto=-1]="Auto",t[t.High=60]="High",t[t.Low=45]="Low"}(n.FpsMode||(n.FpsMode={})),n.initResLoader=function(t){r=t},n.delay=function(t){return a(this,void 0,void 0,function(){return s(this,function(){return[2,new Promise(function(e){return setTimeout(function(){return e(null)},t)})]})})},n.randomElement=function(t){return t&&0!=t.length?t[Math.floor(Math.random()*t.length)]:null},n.TransPos=function(t,e,n){return e.convertToNodeSpaceAR(t.convertToWorldSpaceAR(n))},n.hasStr=function(t,e){return-1!=t.indexOf(e)},n.throttle=function(t,e){var n=null;return function(){var o=this,r=arguments;n||(n=setTimeout(function(){t.apply(o,r),n=null},e))}},n.promiseCancelable=function(t){var e=!1;return{promise:new Promise(function(n,o){t.then(function(t){return e?o({isCanceled:!0}):n(t)}),t.catch(function(t){return o(e?{isCanceled:!0}:t)})}),cancel:function(){e=!0}}},n.isSameDay=function(t,e){return new Date(t).toDateString()==new Date(e).toDateString()},n.loadBundle=u,n.preloadBundles=function(){return a(this,void 0,void 0,function(){var t,e,n,o;return s(this,function(r){switch(r.label){case 0:for(console.warn("preloadBundles start"),t=["gameAsset","remoteAsset"],e=[],n=0;n<t.length;n++)o=t[n],e.push(u(o));return[4,Promise.all(e)];case 1:return r.sent(),console.warn("preloadBundles end"),[2]}})})},n.loadRes=l,n.preloadRes=function(t,e){return a(this,void 0,Promise,function(){var n,o,r,i;return s(this,function(a){switch(a.label){case 0:if(!e)return[2,null];n=["resources","artres"],o=0,a.label=1;case 1:return o<n.length?(r=n[o],[4,p(t,e,r)]):[3,4];case 2:if(null!=(i=a.sent()))return[2,i];a.label=3;case 3:return o++,[3,1];case 4:return console.warn("loadRes err",e),[2,null]}})})},n.loadBundleRes=f,n.preloadBundleRes=p,n.getRes=h,n.loadNode=function(t,e){return a(this,void 0,void 0,function(){var n=this;return s(this,function(){return t?[2,new Promise(function(o){return a(n,void 0,void 0,function(){var n,r;return s(this,function(i){switch(i.label){case 0:return[4,l(cc.Prefab,t)];case 1:return(n=i.sent())?(r=cc.instantiate(n),e&&(r.parent=e),r.position=cc.v3(),r.active=!0,o(r)):o(null),[2]}})})})]:[2,null]})})},n.path2uuid=d,n.compareVersion=function(t,e){t=t.split("."),e=e.split(".");for(var n=Math.max(t.length,e.length);t.length<n;)t.push("0");for(;e.length<n;)e.push("0");for(var o=0;o<n;o++){var r=parseInt(t[o]),i=parseInt(e[o]);if(r>i)return 1;if(r<i)return-1}return 0},n.loadSpine=function(t){return a(this,void 0,Promise,function(){return s(this,function(e){switch(e.label){case 0:return t?[4,l(sp.SkeletonData,t)]:[2,null];case 1:return[2,e.sent()]}})})},n.loadImage=function(t,e,n,i){return void 0===n&&(n=o.None),void 0===i&&(i=!0),a(this,void 0,void 0,function(){var o;return s(this,function(a){switch(a.label){case 0:return t&&t.node?(i&&(t.spriteFrame=null),t.url=e,[4,l(cc.SpriteFrame,e)]):[2];case 1:return(o=a.sent())&&e&&-1!=t.url.indexOf(o._name)&&t.url==e?t.spriteFrame=o:o||(t.spriteFrame=r),g(t,n),[2]}})})},n.loadRemote=function(t,e,n){return void 0===e&&(e=null),void 0===n&&(n=!0),a(this,void 0,Promise,function(){return s(this,function(){return[2,new Promise(function(o){if(t){var r=e?{ext:e,cacheEnabled:n}:{cacheEnabled:n};cc.assetManager.loadRemote(t,r,function(t,e){o(t?null:e)})}else o(null)})]})})},n.findConfig=function(t,e){for(var n=0;n<t.length;++n)if(e(t[n]))return t[n];return null},n.scaleImage=g;var y=5;function m(t){return null!=t&&(y=t),(y=(9301*y+49297)%233280)/233280}function _(t,e){var n=cc.v3();return t instanceof cc.Node?t.isValid&&t.parent&&(n=t.parent.convertToWorldSpaceAR(t.position)):n=cc.v3(t.x,t.y),n=e.convertToNodeSpaceAR(n),cc.v2(n.x,n.y)}function v(t,e){return Math.random()*(e-t)+t}function I(t){return{hour:~~(t/3600),min:~~((t%=3600)/60),sec:t%=60}}function b(t){return t>9?t:"0"+t}function C(){return cc.sys.platform===cc.sys.WECHAT_GAME}function M(){return C()||w()||P()}function w(){return!!window.tt}function P(){return!!window.qq}function O(t){var e=new sp.SkeletonTexture;e._image={width:t.width,height:t.height},e.setRealTexture(t);var n=new sp.spine.TextureAtlasRegion;return n.width=t.width,n.height=t.height,n.originalWidth=t.width,n.originalHeight=t.height,n.rotate=!1,n.u=0,n.v=0,n.u2=1,n.v2=1,n.texture=e,n}function T(){var t={},e=0,n={},o=0,r={},i=function(a){if(a&&a.length)for(var s=0;s<a.length;++s){var c=a[s];n[c.name]?n[c.name]++:n[c.name]=1,e++,c.active&&c.isValid&&(c._components&&c._components.forEach(function(e){var n=e.__classname__;t[n]||(t[n]=0),"cc.Label"==n&&(o++,r[c.parent.name]?r[c.parent.name]++:r[c.parent.name]=1),t[n]++}),i(c.children))}};i(cc.director.getScene().children),console.log("\u7c7b\u8be6\u60c5:",t),console.log("\u573a\u666f\u6811\u4e0a\u5171\u6709:"+e+"\u4e2anode"),console.log("\u8282\u70b9\u8be6\u60c5:",n),console.log("\u573a\u666f\u6811\u4e0a\u5171\u6709:"+o+"\u4e2alabel"),console.log("\u6587\u672c\u8be6\u60c5:",r)}function j(t){return JSON.parse(JSON.stringify(t))}n.seedRandom=m,n.seedRandomInt=function(t,e,n){e=e||1,t=t||0;var o=m(n);return Math.floor(t+o*(e-t))},n.toParent=function(t,e){if(e!=t.parent){var n=_(t,e);t.parent=e,t.setPosition(n)}},n.convertPosition=_,n.updateNow=function(t){var e=t.getComponent(cc.Label);if(e)e._forceUpdateRenderData();else{var n=t.getComponent(cc.RichText);if(n)return t._activeInHierarchy=!0,void n._updateRichText();var o=t.getComponent(cc.Layout);o&&o.updateLayout()}},n.invokeCallback=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t&&"function"==typeof t&&t.apply(null,Array.prototype.slice.call(arguments,1))},n.randomInt=function(t,e){return Math.floor(v(t,e))},n.randomNumber=v,n.rangeValue=function(t,e,n){return t=Math.max(e,t),Math.min(n,t)},n.switchMatt=function(t){return t[0].map(function(e,n){return t.map(function(t){return t[n]})})},n.shuffle=function(t,e){void 0===e&&(e=!1);var n=[];n=e?t:function(t){return t.slice(0)}(t);for(var o,r=0;r<n.length;r++){var i=(0,o=r,Math.floor(Math.random()*(o-0+1)+0)),a=n[r];n[r]=n[i],n[i]=a}return n},n.randomByWeight=function(t,e){if(t.length==e.length){var n=0;e.forEach(function(t){return n+=t});for(var o=Math.random()*n,r=e[0],i=1;i<e.length;i++){if(o<r)return i-1;r+=e[i]}return e.length-1}console.error("\u6743\u91cd\u968f\u673a\u8f93\u5165\u53c2\u6570\u957f\u5ea6\u4e0d\u7b49")},n.getDeltaTime=function(t,e){return t-e},n.getBit=function(t,e){return void 0===e&&(e=1),t.toFixed(e)},n.formatStrEnter=function(t,e,n){void 0===e&&(e=10),void 0===n&&(n=!1);for(var o=n?"<br/>":"\n",r=[],i=0,a=0,s=0;s<t.length;s++)t.charCodeAt(s)>255?i+=2:i++,i>=e&&(r.push(t.slice(a,s)),a=s,i=0);r.push(t.slice(a));for(var c="",u=(s=0,r.length);s<u;s++)c+=r[s],s<u-1&&(c+=o);return c},n.formatLongName=function(t,e){void 0===e&&(e=0);for(var n=0,o=0;o<t.length;o++)if(t.charCodeAt(o)>255?n+=2:n++,n>=e){t=t.slice(0,o+1)+"...";break}return t},n.formatNumberDot=function(t){for(var e=(t||0).toString(),n="";e.length>3;)n=","+e.slice(-3)+n,e=e.slice(0,e.length-3);return e&&(n=e+n),n},n.formatTimeHMS_str=function(t,e,n,o){void 0===e&&(e=!0),void 0===n&&(n=!1),void 0===o&&(o=0);var r=I(t=~~t),i="",a=0;if(r.hour>23&&n){var s=~~(r.hour/24);i+=s+(e?"\u5929":"d"),r.hour-=24*s,a++}return r.hour>0&&(!o||a<o)&&(i+=r.hour+(e?"\u5c0f\u65f6":"h"),a++),r.min>0&&(!o||a<o)&&(i+=r.min+(e?"\u5206\u949f":"m"),a++),r.sec>0&&(!o||a<o)&&(i+=r.sec+(e?"\u79d2":"s"),a++),i},n.formatTimeHMS=I,n.formatHour=function(t,e){void 0===e&&(e="second"),"micosecond"==e?t/=36e5:"second"==e?t/=3600:"minute"==e&&(t/=60);var n=(""+t).split(".");return n[0]+"."+(n[1]?n[1].substr(0,2):"0")},n.formatMinuteUnit=function(t,e){void 0===e&&(e=!1);var n=~~((t=~~t)/3600);e&&(t%=3600);var o=~~(t/60),r=t%60,i="";return e&&n>0&&(i+=n+"h"),o>0&&(i+=o+"m"),r>0&&(i+=r+"s"),i},n.formatMinute=function(t,e){void 0===e&&(e=!1);var n=~~((t=~~t)/3600);e&&(t%=3600);var o=~~(t/60),r=t%60,i="";return e&&(n<10&&(i+="0"),i+=n+":"),o<10&&(i+="0"),i+=o+":",r<10&&(i+="0"),i+""+r},n.zero=b,n.formateDate=function(t){var e=t.getFullYear(),n=b(t.getMonth()+1),o=b(t.getDate()),r=b(t.getHours()),i=b(t.getMinutes());return b(t.getSeconds()),e+"/"+n+"/"+o+" "+r+":"+i},n.formatTime=function(t){var e=new Date(t).getTime(),n=(new Date).getTime()-e;if(n<0)return"\u521a\u521a";var o=n/2592e6,r=n/6048e5,i=n/864e5,a=n/36e5,s=n/6e4,c=n/31104e6;return c>=1?Math.floor(c)+"\u5e74\u524d":o>=1?Math.floor(o)+"\u6708\u524d":r>=1?Math.floor(r)+"\u5468\u524d":i>=1?Math.floor(i)+"\u5929\u524d":a>=1?Math.floor(a)+"\u5c0f\u65f6\u524d":s>=1?Math.floor(s)+"\u5206\u949f\u524d":"\u521a\u521a"},n.date2BeijingUnixMilli=function(t){if("number"==typeof t){var e=new Date(t),n=6e4*e.getTimezoneOffset();return e.setTime(e.getTime()+n+288e5),e}return n=6e4*t.getTimezoneOffset(),t.setTime(t.getTime()+n+288e5),t},n.randomInts=function(t,e,n){var o,r=[];return function i(a){for(;a<n;a++){for(var s in o=parseInt(Math.random()*(e-t+1)+t),r)if(r[s]==o){i(a);break}r[a]=o}}(0),r},n.segmentFunc=function(t,e){return t>e?e:t},n.removeFromArr=function(t,e){var n;-1!=(n=t.indexOf(e))&&t.splice(n,1)},n.uniqueArr=function(t){for(var e=[],n={},o=0;o<t.length;o++)n[t[o]]||(n[t[o]]=!0,e.push(t[o]));return e},n.isNullEmptyOrSpace=function(t){return null==t||0==t.replace(/\s/g,"").length},n.obj2Urlstr=function(t){return Object.keys(t).map(function(e){return"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t[e]))}).join("&")},n.mapToObj=function(t){var e=Object.create(null);return t.forEach(function(t,n){e[n]=t}),e},n.objToMap=function(t,e){void 0===e&&(e=!1);var n=new Map;return Object.keys(t).forEach(function(o){e?n.set(parseInt(o),t[o]):n.set(o,t[o])}),n},n.byteToInt=function(t){return(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3]},n.isValue=function(t){return null!=t},n.isWX=C,n.isWeb=function(){return!M()},n.isMiniGame=M,n.isApp=function(){return!1},n.isTT=w,n.isQQ=P,n.isDevelopment=function(){return!1},n.isWX_IOS=function(){return C()&&cc.sys.os===cc.sys.OS_IOS},n.isWX_AND=function(){return C()&&cc.sys.os===cc.sys.OS_ANDROID},n.isAndroid=function(){return cc.sys.os===cc.sys.OS_ANDROID&&!1},n.isIOS=function(){return cc.sys.os===cc.sys.OS_IOS&&!1},n.changeSpineSlot=function(t,e,n){var o=t.findSlot(e),r=n.getTexture(),i=o.getAttachment(),a=O(r);i.region=a,i.setRegion&&i.setRegion(a),i.updateUVs()},n.showUiDebug=T,window.ui_test=T,n.showNodeDebug=function(){var t=cc.director.getScene().getComponentsInChildren(cc.Sprite),e=0,n=[],o={};t.forEach(function(t){return n.push(t.node)}),n.forEach(function(t){o[t.parent.name]?o[t.parent.name]++:o[t.parent.name]=1,e++}),console.log("\u603b\u5171:"+e+"\u4e2a\u8282\u70b9,\u7eb9\u7406\u7236\u8282\u70b9\u8be6\u60c5:",o)},n.clone=j,n.deepClone=function t(e){if(e instanceof Object){var n=Array.isArray(e)?c(e):i({},e);return Reflect.ownKeys(n).forEach(function(o){n[o]=e[o]instanceof Object?t(e[o]):e[o]}),n}},n.inject=function(t,e,n){for(var o in void 0===n&&(n=!0),n&&(e=j(e)),t)e.hasOwnProperty(o)&&(t[o]=e[o])},n.enumLength=function(t){var e=0;for(var n in t)isNaN(Number(n))&&e++;return e},n.weightRandom=function(t){for(var e=[],n=0;n<t.length;n++)for(var o=0;o<t[n];o++)e.push(n);var r=Math.floor(Math.random()*e.length);return e.length?e[r]:-1},n.setDownloaderRemoteAddress=function(t){cc.assetManager.downloader._remoteServerAddress&&(cc.assetManager.downloader._remoteServerAddress=t)},n.getTimeStamp=function(){return(new Date).getTime()},n.getZeroTimeStamp=function(){return new Date((new Date).setHours(0,0,0,0)).getTime()},function(t){t.MEDIUM="medium",t.LIGHT="light",t.HEAVY="heavy"}(n.ShakeType||(n.ShakeType={})),n.getUrlParamMap=function(){if(!location.search&&!location.hash)return null;var t={},e=function(e){for(var n=e.split("&"),o=0;o<n.length;o++){var r=n[o].split("=");t[r[0]]=decodeURIComponent(r[1])}};if(location.hash&&e(location.hash.substr(1)),location.search){var n=location.search.indexOf("?");if(-1!=n){var o=location.search.substr(n+1);e(o=o.split("!")[0])}}return t},n.log=function(t,e){var n=t[e];delete this[e]&&Object.defineProperty(t,e,{get:function(){return console.log("Get "+e+" returned "+n),n},set:function(t){console.log("Set "+e+" to "+t),n=t},enumerable:!0,configurable:!0})},n.serializable=function(t,e){t.constructor.serializeKeys||(t.constructor.serializeKeys=[]),t.constructor.serializeKeys.push(e)};if(n.SystemInfo=function(){},!window.wx){var k=cc._RF.push;cc._RF.push=function(){var t=arguments;setTimeout(function(){try{window[t[2]]=t[0].exports.default||t[0].exports[t[2]]}catch(e){}},0),k.apply(this,t)}}cc._RF.pop()},{}],CocosFixed:[function(t,e){"use strict";cc._RF.push(e,"c95b4+rYJZN64x18o6JhmUf","CocosFixed"),cc._RF.pop()},{}],CollectMgr:[function(t,e,n){"use strict";cc._RF.push(e,"a9e56L9CxVFo5g41Ao5ZVvZ","CollectMgr");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.ECollectEvent=void 0;var r,i=t("./Managers/EventCenter"),a=t("./Mgr/StorageMgr"),s=cc._decorator;s.ccclass,s.property,function(t){t.E_CollectMonster="E_CollectMonster",t.E_CollectRes="E_CollectRes",t.E_CollectBlock="E_CollectBlock"}(r=n.ECollectEvent||(n.ECollectEvent={}));var c=function(){function t(){var t=this;this.monsterCollectList=[],this.monsterCollect=new Map,this.blockCollectList=[],this.itemCollect=new Map,this.itemCollectList=[],this.blockCollect=new Map,i.default.on(i.E_GetItem,this.onGetItem,this),this.blockCollect=new Map,this.blockCollectList=[],config.MapObject.list.forEach(function(e){e.isInCollection&&(t.blockCollect.set(e.id,!1),t.blockCollectList.push(e.id))}),this.itemCollectList=[],this.itemCollect=new Map;var e=a.default.getItem(a.EStorageKey.collect);e?JSON.parse(e).forEach(function(e){t.itemCollectList.push(e.id),t.itemCollect.set(e.id,e.unlock)}):config.Item.list.forEach(function(e){e.isInCollection&&(t.itemCollectList.push(e.id),t.itemCollect.set(e.id,!1))}),this.itemCollectList.sort(function(t,e){return config.Item.getById(t).quality-config.Item.getById(e).quality}),this.monsterCollect=new Map,this.monsterCollectList=[],config.MonsterData.list.forEach(function(e){e.isInCollection&&(t.monsterCollect.set(e.id,!1),t.monsterCollectList.push(e.id))}),this.monsterCollectList.sort(function(t,e){return config.MonsterData.getById(t).quality-config.MonsterData.getById(e).quality})}return Object.defineProperty(t,"Ins",{get:function(){return this.instance||(this.instance=new t),this.instance},enumerable:!1,configurable:!0}),t.prototype.saveData=function(){var t=[];this.itemCollect.forEach(function(e,n){t.push({id:n,unlock:e})}),a.default.setItem(a.EStorageKey.collect,JSON.stringify(t))},t.prototype.clearSave=function(){a.default.removeItem(a.EStorageKey.collect)},t.prototype.onGetItem=function(t){this.collectItem(t)},t.prototype.isCollectedMonster=function(t){return!!this.monsterCollect.get(t)},t.prototype.collectMonster=function(t){this.isCollectedMonster(t)||this.send(r.E_CollectMonster,t),this.monsterCollect.set(t,!0)},t.prototype.isCollectedItem=function(t){return!!this.itemCollect.get(t)},t.prototype.collectItem=function(t){config.Item.getById(t).isInCollection&&(this.isCollectedItem(t)||this.send(r.E_CollectRes,t),this.itemCollect.set(t,!0))},t.prototype.isCollectedBlock=function(t){return!!this.blockCollect.get(t)},t.prototype.collectBlock=function(t){config.MapObject.getById(t).isInCollection&&(this.isCollectedBlock(t)||this.send(r.E_CollectBlock,t),this.blockCollect.set(t,!0))},t.prototype.send=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];i.default.send.apply(i.default,o(["Collect_"+t],e))},t.prototype.on=function(t,e,n){i.default.on("Collect_"+t,e,n)},t.prototype.off=function(t,e,n){i.default.off("Collect_"+t,e,n)},t}();n.default=c,cc._RF.pop()},{"./Managers/EventCenter":"EventCenter","./Mgr/StorageMgr":"StorageMgr"}],CraftTaskMgr:[function(t,e,n){"use strict";cc._RF.push(e,"34172vz4HtKuJru3tnZKB2p","CraftTaskMgr");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.ECraftTaskEvent=n.StatusInfo=n.TaskSlotInfo=void 0;var r=t("./Managers/EventCenter"),i=t("./Mgr/StorageMgr"),a=t("./Model/Inventory"),s=t("./Utils/CocosExtension"),c=function(t){this.craftTaskId=-1,this.slotId=t,this.timer=0};n.TaskSlotInfo=c;var u,l=function(){function t(t){this.moduleId=t,this.level=0}return Object.defineProperty(t.prototype,"cfg",{get:function(){return config.CraftModule.getById(this.moduleId)},enumerable:!1,configurable:!0}),t}();n.StatusInfo=l,function(t){t.E_CraftTaskUpdateRefresh="E_CraftTaskUpdateRefresh",t.E_CraftTaskFinishRefresh="E_CraftTaskFinishRefresh",t.E_CraftTaskChangeTracking="E_CraftTaskChangeTracking",t.E_CraftTaskFinishTracking="E_CraftTaskFinishTracking",t.E_CraftTaskUpdateTracking="E_CraftTaskUpdateTracking",t.E_CraftTaskFinishTask="E_CraftTaskFinishTask"}(u=n.ECraftTaskEvent||(n.ECraftTaskEvent={}));var f=function(){function t(){this.startQueue=[11,1],this.trackingId=-1,this.finishMap=new Map,this.taskMap=new Map,this.moduleMap=new Map,this.finishMap=new Map;for(var t=config.CraftTask.list,e=0;e<t.length;e++)this.finishMap.set(t[e].id,!1);this.moduleMap=new Map,this.unlockCraftModule(1);var n=localStorage.getItem(i.EStorageKey.craftTask);n&&(this.startQueue=JSON.parse(n)),r.default.on(r.E_GetItem,this.onGetItem,this)}return Object.defineProperty(t,"Ins",{get:function(){return this.instance||(this.instance=new t),this.instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"trackingTaskInfo",{get:function(){return this.trackingId<0?null:config.CraftTask.getById(this.trackingId)},enumerable:!1,configurable:!0}),t.prototype.saveData=function(){var t=JSON.stringify(this.startQueue);localStorage.setItem(i.EStorageKey.craftTask,t)},t.prototype.json2map=function(t){var e=JSON.parse(t),n=new Map(Object.entries(e)),o=new Map;return n.forEach(function(t,e){o.set(Number.parseInt(e),t)}),o},t.prototype.clearSave=function(){localStorage.removeItem(i.EStorageKey.craftTask)},t.prototype.getSlotIdByCraftId=function(t,e){var n=this.taskMap.get(t).find(function(t){return t.craftTaskId==e});return n?n.slotId:-1},t.prototype.containTrackingRequire=function(t){if(this.trackingId<0)return!1;for(var e=0;e<this.trackingTaskInfo.matId.length;e++)if(this.trackingTaskInfo.matId[e]==t)return!0;return!1},t.prototype.onGetItem=function(e){this.trackingId<0||this.containTrackingRequire(e)&&(t.send(u.E_CraftTaskUpdateTracking),t.isEnough(this.trackingId)&&t.send(u.E_CraftTaskFinishTracking))},t.isEnough=function(t){var e=config.CraftTask.getById(t);return this.isEnoughByList(e.matId,e.matNum)},t.isEnoughByList=function(t,e){for(var n=0;n<t.length;n++){var o=e[n];if(a.default.Ins.findResNum(t[n])<o)return!1}return!0},t.prototype.unlockCraftModule=function(t){var e=new l(t);this.moduleMap.set(t,e),e.level=1;var n=this.getLevelCfg(t,e.level),o=this.taskMap.get(t);o||(o=[],this.taskMap.set(t,o));for(var r=o.length;r<n.slotNum;r++){var i=new c(r);o.push(i),this.req_finishRefreshTask(t,e.level,r)}},t.send=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];r.default.send.apply(r.default,o([t],e))},t.on=function(t,e,n){r.default.on(t,e,n)},t.once=function(t,e,n){r.default.once(t,e,n)},t.off=function(t,e,n){r.default.off(t,e,n)},t.prototype.getLevelCfg=function(t,e){return config.ModuleLevel.list.find(function(n){return n.moduleId==t&&n.level==e})},t.prototype.getAllCraftTaskWithoutShow=function(t,e){for(var n=config.CraftTask.list,o=[],r=this.taskMap.get(t),i=function(i){!(n[i].moduleId==t&&n[i].levelLimit<=e)||a.isFinishTask(n[i].id)||r&&r.find(function(t){return t.craftTaskId==n[i].id})||o.push(n[i])},a=this,s=0;s<n.length;s++)i(s);return o},t.prototype.getStatusInfo=function(t){return this.moduleMap.get(t)},t.prototype.getSlotsInfo=function(t){return this.taskMap.get(t)},t.prototype.setTracking=function(e){this.trackingId=e,t.send(u.E_CraftTaskChangeTracking)},t.prototype.clearTracking=function(){this.trackingId=-1,t.send(u.E_CraftTaskChangeTracking)},t.prototype.getAllCraftTask=function(t,e){for(var n=config.CraftTask.list,o=[],r=0;r<n.length;r++)n[r].moduleId==t&&n[r].levelLimit<=e&&(n[r].loop||!this.isFinishTask(n[r].id))&&o.push(n[r]);return o},t.prototype.isFinishTask=function(t){return!!this.finishMap.get(t)},t.prototype.update=function(t){var e=this;this.taskMap.forEach(function(n,o){var i=e.moduleMap.get(o);if(e.hasNewCraftTask(i.moduleId,i.level))for(var a=0;a<n.length;a++)if(n[a].craftTaskId<0){n[a].timer+=t,r.default.send(u.E_CraftTaskUpdateRefresh,o,n[a].slotId);var s=e.getLevelCfg(o,i.level);n[a].timer>=s.refreshTime&&(e.req_finishRefreshTask(i.moduleId,i.level,n[a].slotId),r.default.send(u.E_CraftTaskFinishRefresh,o,n[a].slotId))}})},t.prototype.hasNewCraftTask=function(t,e){var n=this.getAllCraftTaskWithoutShow(t,e);return n&&n.length>0},t.prototype.req_upgradeStatus=function(t){var e=this.moduleMap.get(t);a.default.Ins.loseItem(this.getLevelCfg(t,e.level).levelRequireId[0]),e.level++;var n=this.getLevelCfg(t,e.level),o=this.taskMap.get(t);o||(o=[],this.taskMap.set(t,o));for(var r=o.length;r<n.slotNum;r++){var i=new c(r);o.push(i),this.req_finishRefreshTask(t,e.level,r)}},t.prototype.req_finishRefreshTask=function(t,e,n){var o;o=this.startQueue.length>0?config.CraftTask.getById(this.startQueue.shift()):this.getRandomTask(t,e),this.taskMap.get(t).find(function(t){return t.slotId==n}).craftTaskId=o.id},t.prototype.req_finishCraftTask=function(e,n){var o=this.taskMap.get(e);if(o){var r=o.find(function(t){return t.slotId==n}),i=r.craftTaskId;config.CraftTask.getById(i),r.craftTaskId=-1,r.timer=0,this.finishMap.set(i,!0),t.send(u.E_CraftTaskFinishTask,i)}},t.prototype.getRandomTask=function(t,e){var n=this.getAllCraftTaskWithoutShow(t,e);return s.randomElement(n)},t.prototype.getTaskNumByLevel=function(t,e){var n=0;return config.CraftTask.list.forEach(function(o){o.moduleId==t&&o.levelLimit<=e&&n++}),n},t}();n.default=f,window.CraftTaskMgr=f,cc._RF.pop()},{"./Managers/EventCenter":"EventCenter","./Mgr/StorageMgr":"StorageMgr","./Model/Inventory":"Inventory","./Utils/CocosExtension":"CocosExtension"}],DamageTxt:[function(t,e,n){"use strict";cc._RF.push(e,"3da6ePeXM5LypY+zvxkZQJl","DamageTxt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Managers/AnimationManager"),s=t("../Managers/PoolManager"),c=cc._decorator,u=c.ccclass,l=c.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.animation=null,e}return r(e,t),e.prototype.setData=function(t,e){this.label.string=t.toString(),a.AM.play(this.animation,e?"crit":"normal")},e.prototype.A_Clear=function(){s.PoolManager.PutPrefab(this.node)},i([l(cc.Animation)],e.prototype,"animation",void 0),i([l(cc.Label)],e.prototype,"label",void 0),i([u],e)}(cc.Component);n.default=f,cc._RF.pop()},{"../Managers/AnimationManager":"AnimationManager","../Managers/PoolManager":"PoolManager"}],DialogMgr:[function(t,e,n){"use strict";cc._RF.push(e,"16d3aLVlTJF94ZA0x9h+QFn","DialogMgr");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../UI/UI"),u=t("../UI/U_Dialog"),l=cc._decorator,f=l.ccclass,p=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return this.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this},e.prototype.showDialog=function(t,e){return a(this,void 0,void 0,function(){var n;return s(this,function(o){switch(o.label){case 0:return(n=c.default.getUI(u.default)).setData(t,e),[4,n.awaitFinish()];case 1:return o.sent(),[2]}})})},e.prototype.showDialogByTxt=function(t){return a(this,void 0,void 0,function(){var e;return s(this,function(n){switch(n.label){case 0:return(e=c.default.getUI(u.default)).setTxt(t),[4,e.awaitFinish()];case 1:return n.sent(),[2]}})})},e.instance=null,n=i([f],e)}(cc.Component));n.default=p,cc._RF.pop()},{"../UI/UI":"UI","../UI/U_Dialog":"U_Dialog"}],DiggingUIBinder:[function(t,e,n){"use strict";cc._RF.push(e,"783b0ObUexFv5SSY6zmzR/+","DiggingUIBinder"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("./UI_TaskTips"),r=t("./UI_ItemDetail"),i=t("./UI_frame"),a=t("./UI_bpItem"),s=t("./UI_Backpack"),c=t("./UI_matItem"),u=t("./UI_buildItem"),l=t("./UI_itemSelectPanel"),f=t("./UI_HUD"),p=t("./UI_newTips"),h=t("./UI_PopupTips"),d=t("./UI_MapTop"),g=t("./UI_mapLockNode"),y=t("./UI_MapTips"),m=t("./UI_Map"),_=t("./UI_MapWindow"),v=t("./UI_mapUnlockNode"),I=t("./UI_MapGrp"),b=t("./UI_Dialog"),C=t("./UI_Modal"),M=t("./UI_requireTaskReward"),w=t("./UI_Shop"),P=t("./UI_ShopSoldItem"),O=t("./UI_ShopBuyItem"),T=t("./UI_shopCraftMatItem"),j=t("./UI_shopCraftItem"),k=t("./UI_tabBtn"),S=t("./UI_requireTaskSubCom"),U=t("./UI_CollectionWindow"),R=t("./UI_collectionMenuCom"),E=t("./UI_collectionContentCom"),A=t("./UI_collectionContentItem"),x=t("./UI_lockFrame"),D=t("./UI_trackingRequireItem"),F=t("./UI_trackingCraft"),G=t("./UI_requireTaskItem"),B=t("./UI_TaskRequireMenu"),N=t("./UI_topUI"),L=t("./UI_bottomUI"),H=t("./UI_backpackCom"),q=t("./UI_taskRequireMatItem"),K=t("./UI_CollectionTips"),W=t("./UI_taskBoard"),V=t("./UI_mapTipsNode"),Q=t("./UI_MapBottom"),z=t("./UI_MapBtn"),J=t("./UI_slot"),Z=t("./UI_Springboard"),X=t("./UI_TipsBoard"),Y=t("./UI_DialogHead"),$=t("./UI_dialogContinue"),tt=t("./UI_dialogCom"),et=t("./UI_ContTips"),nt=t("./UI_posTips"),ot=t("./UI_craftPage"),rt=function(){function t(){}return t.bindAll=function(){fgui.UIObjectFactory.setExtension(o.default.URL,o.default),fgui.UIObjectFactory.setExtension(r.default.URL,r.default),fgui.UIObjectFactory.setExtension(i.default.URL,i.default),fgui.UIObjectFactory.setExtension(a.default.URL,a.default),fgui.UIObjectFactory.setExtension(s.default.URL,s.default),fgui.UIObjectFactory.setExtension(c.default.URL,c.default),fgui.UIObjectFactory.setExtension(u.default.URL,u.default),fgui.UIObjectFactory.setExtension(l.default.URL,l.default),fgui.UIObjectFactory.setExtension(f.default.URL,f.default),fgui.UIObjectFactory.setExtension(p.default.URL,p.default),fgui.UIObjectFactory.setExtension(h.default.URL,h.default),fgui.UIObjectFactory.setExtension(d.default.URL,d.default),fgui.UIObjectFactory.setExtension(g.default.URL,g.default),fgui.UIObjectFactory.setExtension(y.default.URL,y.default),fgui.UIObjectFactory.setExtension(m.default.URL,m.default),fgui.UIObjectFactory.setExtension(_.default.URL,_.default),fgui.UIObjectFactory.setExtension(v.default.URL,v.default),fgui.UIObjectFactory.setExtension(I.default.URL,I.default),fgui.UIObjectFactory.setExtension(b.default.URL,b.default),fgui.UIObjectFactory.setExtension(C.default.URL,C.default),fgui.UIObjectFactory.setExtension(M.default.URL,M.default),fgui.UIObjectFactory.setExtension(w.default.URL,w.default),fgui.UIObjectFactory.setExtension(P.default.URL,P.default),fgui.UIObjectFactory.setExtension(O.default.URL,O.default),fgui.UIObjectFactory.setExtension(T.default.URL,T.default),fgui.UIObjectFactory.setExtension(j.default.URL,j.default),fgui.UIObjectFactory.setExtension(k.default.URL,k.default),fgui.UIObjectFactory.setExtension(S.default.URL,S.default),fgui.UIObjectFactory.setExtension(U.default.URL,U.default),fgui.UIObjectFactory.setExtension(R.default.URL,R.default),fgui.UIObjectFactory.setExtension(E.default.URL,E.default),fgui.UIObjectFactory.setExtension(A.default.URL,A.default),fgui.UIObjectFactory.setExtension(x.default.URL,x.default),fgui.UIObjectFactory.setExtension(D.default.URL,D.default),fgui.UIObjectFactory.setExtension(F.default.URL,F.default),fgui.UIObjectFactory.setExtension(G.default.URL,G.default),fgui.UIObjectFactory.setExtension(B.default.URL,B.default),fgui.UIObjectFactory.setExtension(N.default.URL,N.default),fgui.UIObjectFactory.setExtension(L.default.URL,L.default),fgui.UIObjectFactory.setExtension(H.default.URL,H.default),fgui.UIObjectFactory.setExtension(q.default.URL,q.default),fgui.UIObjectFactory.setExtension(K.default.URL,K.default),fgui.UIObjectFactory.setExtension(W.default.URL,W.default),fgui.UIObjectFactory.setExtension(V.default.URL,V.default),fgui.UIObjectFactory.setExtension(Q.default.URL,Q.default),fgui.UIObjectFactory.setExtension(z.default.URL,z.default),fgui.UIObjectFactory.setExtension(J.default.URL,J.default),fgui.UIObjectFactory.setExtension(Z.default.URL,Z.default),fgui.UIObjectFactory.setExtension(X.default.URL,X.default),fgui.UIObjectFactory.setExtension(Y.default.URL,Y.default),fgui.UIObjectFactory.setExtension($.default.URL,$.default),fgui.UIObjectFactory.setExtension(tt.default.URL,tt.default),fgui.UIObjectFactory.setExtension(et.default.URL,et.default),fgui.UIObjectFactory.setExtension(nt.default.URL,nt.default),fgui.UIObjectFactory.setExtension(ot.default.URL,ot.default)},t}();n.default=rt,cc._RF.pop()},{"./UI_Backpack":"UI_Backpack","./UI_CollectionTips":"UI_CollectionTips","./UI_CollectionWindow":"UI_CollectionWindow","./UI_ContTips":"UI_ContTips","./UI_Dialog":"UI_Dialog","./UI_DialogHead":"UI_DialogHead","./UI_HUD":"UI_HUD","./UI_ItemDetail":"UI_ItemDetail","./UI_Map":"UI_Map","./UI_MapBottom":"UI_MapBottom","./UI_MapBtn":"UI_MapBtn","./UI_MapGrp":"UI_MapGrp","./UI_MapTips":"UI_MapTips","./UI_MapTop":"UI_MapTop","./UI_MapWindow":"UI_MapWindow","./UI_Modal":"UI_Modal","./UI_PopupTips":"UI_PopupTips","./UI_Shop":"UI_Shop","./UI_ShopBuyItem":"UI_ShopBuyItem","./UI_ShopSoldItem":"UI_ShopSoldItem","./UI_Springboard":"UI_Springboard","./UI_TaskRequireMenu":"UI_TaskRequireMenu","./UI_TaskTips":"UI_TaskTips","./UI_TipsBoard":"UI_TipsBoard","./UI_backpackCom":"UI_backpackCom","./UI_bottomUI":"UI_bottomUI","./UI_bpItem":"UI_bpItem","./UI_buildItem":"UI_buildItem","./UI_collectionContentCom":"UI_collectionContentCom","./UI_collectionContentItem":"UI_collectionContentItem","./UI_collectionMenuCom":"UI_collectionMenuCom","./UI_craftPage":"UI_craftPage","./UI_dialogCom":"UI_dialogCom","./UI_dialogContinue":"UI_dialogContinue","./UI_frame":"UI_frame","./UI_itemSelectPanel":"UI_itemSelectPanel","./UI_lockFrame":"UI_lockFrame","./UI_mapLockNode":"UI_mapLockNode","./UI_mapTipsNode":"UI_mapTipsNode","./UI_mapUnlockNode":"UI_mapUnlockNode","./UI_matItem":"UI_matItem","./UI_newTips":"UI_newTips","./UI_posTips":"UI_posTips","./UI_requireTaskItem":"UI_requireTaskItem","./UI_requireTaskReward":"UI_requireTaskReward","./UI_requireTaskSubCom":"UI_requireTaskSubCom","./UI_shopCraftItem":"UI_shopCraftItem","./UI_shopCraftMatItem":"UI_shopCraftMatItem","./UI_slot":"UI_slot","./UI_tabBtn":"UI_tabBtn","./UI_taskBoard":"UI_taskBoard","./UI_taskRequireMatItem":"UI_taskRequireMatItem","./UI_topUI":"UI_topUI","./UI_trackingCraft":"UI_trackingCraft","./UI_trackingRequireItem":"UI_trackingRequireItem"}],DoorObj:[function(t,e,n){"use strict";cc._RF.push(e,"e4acaElkOFJYJ7S9+INiCE8","DoorObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../../../Mgr/DialogMgr"),c=t("../../../Model/Inventory"),u=t("../../../Operator"),l=t("../../Player/PlayerCtrl"),f=t("../../StartGameCtrl"),p=t("../MapCtrl"),h=t("../TileGrid"),d=t("../TileTips"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.enterGrids=new Set,e.refreshFlag=!1,e.openTips=!1,e}return r(e,t),Object.defineProperty(e.prototype,"isBlockMove",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doorCfg",{get:function(){var t=this;return config.Door.list.find(function(e){return e.objId==t.objId})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nearGrids",{get:function(){for(var t=[],e=-2;e<=2;e++)for(var n=-2;n<=2;n++)if(0!=e||0!=n){var o=p.default.Ins.getGrid(this.grid.crd.add(cc.v2(e,n)));o&&t.push(o)}return t},enumerable:!1,configurable:!0}),e.prototype.init=function(e){var n=this;t.prototype.init.call(this,e),this.grid.on(h.EGridEvent.Explored,this.refresh,this),this.nearGrids.forEach(function(t){t.on(h.EGridEvent.PlayerMove,n.onEnterNearGrid,n),t.on(h.EGridEvent.PlayerExit,n.onExitNearGrid,n)})},e.prototype.clear=function(){var e=this;this.nearGrids.forEach(function(t){t.off(h.EGridEvent.PlayerMove,e.onEnterNearGrid,e),t.off(h.EGridEvent.PlayerExit,e.onExitNearGrid,e)}),this.grid.off(h.EGridEvent.Explored,this.refresh,this),d.default.Ins.hideDoorTips(this.grid),t.prototype.clear.call(this)},e.prototype.onEnterNearGrid=function(t){this.enterGrids.add(t),this.refreshFlag=!0},e.prototype.onExitNearGrid=function(t){this.enterGrids.delete(t),this.refreshFlag=!0},e.prototype.onUpdate=function(){this.refreshFlag&&(this.refresh(),this.refreshFlag=!1)},e.prototype.refresh=function(){this.grid?!this.openTips&&this.enterGrids.size>0&&this.grid.isExplored?(d.default.Ins.showDoorTips(this.grid,this.doorCfg.keyId),this.openTips=!0):!this.openTips||0!=this.enterGrids.size&&this.grid.isExplored||(d.default.Ins.hideDoorTips(this.grid),this.openTips=!1):(d.default.Ins.hideDoorTips(this.grid),this.openTips=!1)},e.prototype.onClick=function(){var t=this,e=p.default.Ins.findCrdSideofObj(this.grid);l.default.Ins.moveToGrid(e,function(){return i(t,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:return t=this.doorCfg.keyId,c.default.Ins.findResNum(t)>0?f.default.Ins.tutorialState<=2?[4,s.default.Ins.showDialog(30)]:[3,2]:[3,3];case 1:return e.sent(),[2];case 2:return u.default.applyOpenDoor(this),[3,5];case 3:return[4,s.default.Ins.showDialog(31)];case 4:e.sent(),e.label=5;case 5:return[2]}})})})},e}(t("./TileObject").default);n.default=g,cc._RF.pop()},{"../../../Mgr/DialogMgr":"DialogMgr","../../../Model/Inventory":"Inventory","../../../Operator":"Operator","../../Player/PlayerCtrl":"PlayerCtrl","../../StartGameCtrl":"StartGameCtrl","../MapCtrl":"MapCtrl","../TileGrid":"TileGrid","../TileTips":"TileTips","./TileObject":"TileObject"}],Drops:[function(t,e,n){"use strict";cc._RF.push(e,"856c3pV0/FP1b+HaC+efagv","Drops");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.EDropsEvent=void 0;var u,l=t("../Managers/PoolManager"),f=t("../Managers/SoundManager"),p=t("../Res"),h=t("../Utils/CocosExtension"),d=t("./GameManager"),g=t("./Map/MapCtrl"),y=t("./Map/TileGrid"),m=t("./Player/PlayerCtrl"),_=cc._decorator,v=_.ccclass,I=_.property;(function(t){t.ClearDrops="clearDrops",t.Pickup="pickupDrops"})(u=n.EDropsEvent||(n.EDropsEvent={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isFollowPlayer=!1,e.label=null,e.timer=0,e}return r(e,t),Object.defineProperty(e.prototype,"neighGrids",{get:function(){return g.default.Ins.nearGrids(this.grid)},enumerable:!1,configurable:!0}),e.prototype.on=function(t,e,n,o){this.node.on(t,e,n,o)},e.prototype.once=function(t,e,n,o){this.node.once(t,e,n,o)},e.prototype.off=function(t,e,n,o){this.node.off(t,e,n,o)},e.prototype.emit=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(e=this.node).emit.apply(e,c([t],n))},Object.defineProperty(e.prototype,"animation",{get:function(){return this.getComponent(cc.Animation)},enumerable:!1,configurable:!0}),e.prototype.setData=function(t,e,n){var o=this,r=config.Item.getById(e).url;this.grid=t,this.resId=e,this.num=n,this.renderer.spriteFrame=p.default.Ins.getSprite(r),this.label.string="x"+n,this.animation.play("enter"),this.isFollowPlayer=!1,this.animation.once(cc.Animation.EventType.FINISHED,function(){return o.onEndEnter()},this),this.awaitToChase()},e.prototype.awaitToChase=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,h.delay(700)];case 1:return t.sent(),this.chasePlayer(),[2]}})})},e.prototype.onEndEnter=function(){var t=this;this.animation.play("idle"),this.neighGrids.forEach(function(e){return e.on(y.EGridEvent.PlayerMove,t.chasePlayer,t)})},e.prototype.chasePlayer=function(){var t=m.default.Ins.curCrd;Math.abs(this.grid.crd.x-t.x)<=1&&Math.abs(this.grid.crd.y-t.y)<=1&&(this.isFollowPlayer=!0,this.animation.play("back"),this.timer=0)},e.prototype.update=function(t){if(t*=d.default.Ins.timeScale,this.isFollowPlayer){var e=cc.v2(m.default.Ins.Hero.node.position),n=cc.v2(this.node.position),o=cc.Vec2.lerp(cc.v2(),n,e,.2);this.node.position=cc.v3(o),this.timer+=t,cc.Vec2.distance(e,o)<3&&this.playerGetDrops()}},e.prototype.clear=function(){var t=this;this.neighGrids.forEach(function(e){return e.off(y.EGridEvent.PlayerMove,t.chasePlayer,t)}),l.PoolManager.PutPrefab(this.node),this.emit(u.ClearDrops)},e.prototype.playerGetDrops=function(){f.SoundManager.playEffect(f.SoundType.Pickup),m.default.Ins.gainDrops(this.resId,this.num),this.emit(u.Pickup),this.clear()},i([I(cc.Sprite)],e.prototype,"renderer",void 0),i([I(cc.Label)],e.prototype,"label",void 0),i([v],e)}(cc.Component);n.default=b,cc._RF.pop()},{"../Managers/PoolManager":"PoolManager","../Managers/SoundManager":"SoundManager","../Res":"Res","../Utils/CocosExtension":"CocosExtension","./GameManager":"GameManager","./Map/MapCtrl":"MapCtrl","./Map/TileGrid":"TileGrid","./Player/PlayerCtrl":"PlayerCtrl"}],EffectManager:[function(t,e,n){"use strict";cc._RF.push(e,"ed45dn2gGNF0rhTig0ORnha","EffectManager");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r(e,t),n=e,Object.defineProperty(e,"Instance",{get:function(){return this.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this},e.shakeNode=function(t,e){this.shakeNodeMap.has(t)&&(t.stopAction(this.shakeNodeMap.get(t)),t.setPosition(this.nodePos.get(t)),this.shakeNodeMap.delete(t)),e||(e={times:6,duration:.2,amp:10});var n=e.times||6,o=e.duration||.2,r=e.amp||10,i=e.srcPos||t.getPosition();this.nodePos.set(t,i);for(var a=new cc.Vec2,s=[],c=0;c<n;++c)c==n-1?a.x=a.y=0:cc.Vec2.random(a,r),s.push(cc.moveTo(o/n,i.add(a)));var u=t.runAction(cc.sequence(s));this.shakeNodeMap.set(t,u)},e.instance=null,e.shakeNodeMap=new Map,e.nodePos=new Map,n=i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],EventCenter:[function(t,e,n){"use strict";cc._RF.push(e,"44e19m0cXpJG7E+LLMxofUj","EventCenter");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.E_ClearBoss=n.E_ContHide=n.E_FinishAllTeleport=n.E_FinishTeleport=n.E_ClickTeleport=n.E_OpenDoor=n.E_WeaponBroken=n.E_PickaxeBroken=n.E_LoseItem=n.E_GetItem=n.E_NewBuild=n.E_NewCraft=n.E_InfoChange=n.E_ResLoaded=void 0;var s=cc._decorator,c=s.ccclass;s.property,n.E_ResLoaded="ResLoaded",n.E_InfoChange="InfoChange",n.E_NewCraft="NewCraft",n.E_NewBuild="NewBuild",n.E_GetItem="GetItem",n.E_LoseItem="LoseItem",n.E_PickaxeBroken="PickaxeBroken",n.E_WeaponBroken="WeaponBroken",n.E_OpenDoor="OpenDoor",n.E_ClickTeleport="ClickTeleport",n.E_FinishTeleport="FinishTeleport",n.E_FinishAllTeleport="FinishAllTeleport",n.E_ContHide="ContHide",n.E_ClearBoss="ClearBoss";var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r(e,t),n=e,e.prototype.onLoad=function(){n.instance=this},e.send=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(e=this.instance.node).emit.apply(e,a([t],n))},e.on=function(t,e,n){this.instance.node.on(t,e,n)},e.off=function(t,e,n){this.instance.node.off(t,e,n)},e.once=function(t,e,n){this.instance.node.once(t,e,n)},e.instance=null,n=i([c],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],Factory:[function(t,e,n){"use strict";cc._RF.push(e,"4cdfauv4jtLzaGzMUZwxvVp","Factory");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("./Managers/PoolManager"),a=t("./Controller/Map/TileGround"),s=t("./Controller/Map/TileObjects/BlockObj"),c=t("./Controller/Map/TileObjects/ChestObj"),u=t("./Controller/Map/TileObjects/HomeObj"),l=t("./Controller/Map/TileObjects/TileObject"),f=t("./Res"),p=t("./Controller/Map/TileObjects/WorksObj"),h=t("./Controller/Map/TileDrops"),d=t("./Controller/Monster/Monster"),g=t("./Controller/Drops"),y=t("./Controller/Map/TileObjects/TriggerObj"),m=t("./Controller/Map/TileObjects/PlantObj"),_=t("./Controller/Map/TileObjects/DoorObj"),v=t("./Controller/Map/StructObjects/MineObj"),I=t("./Controller/Map/MapCtrl"),b=t("./Model/ItemInfo"),C=t("./Controller/Map/BossRegion"),M=t("./Controller/Map/Region"),w=t("./Controller/Map/TileObjects/SpawnObj"),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.getDropInfoByBlock=function(t){var e=config.MapOre.list.find(function(e){return e.gid==t});return e?new h.default(e.dropsId,e.dropsNum):null},e.getMonster=function(t){return i.PoolManager.GetPrefab(f.default.Ins.monsterPrefabs[t-1]).getComponent(d.default)},e.getItemInfo=function(t){switch(config.Item.getById(t).type){case config.ItemType.Consume:return new b.ConsumeInfo(t);case config.ItemType.Pickaxe:return new b.PickaxeInfo(t);case config.ItemType.Weapon:return new b.WeaponInfo(t);default:return new b.default(t)}},e.getDrops=function(t,e,n){var o=i.PoolManager.GetPrefab(f.default.Ins.drops).getComponent(g.default);return o.setData(t,e,n),o},e.getBigOre=function(t){var e=f.default.Ins.bigOres.find(function(e){return e.name==t});if(e){var n=i.PoolManager.GetPrefab(e).getComponent(v.default);return n.node.parent=I.default.Ins.sortingNode,n}},e.getRegion=function(t,e){var n=config.Region.getById(t);return n.bossId&&n.bossId>0?new C.default(t,e):new M.default(t,e)},e.getTileObjectById=function(t){var e=config.MapObject.getById(t);if(!e)return null;switch(e.type.split("_")[0]){case"block":return new s.default(e.id);case"chest":return new c.default(e.id);case"home":return new u.default(e.id);case"works":return new p.default(e.id);case"trigger":return new y.default(e.id);case"plant":return new m.default(e.id);case"door":return new _.default(e.id);case"monsterSpawn":return new w.default(e.id);default:return new l.default(e.id)}},e.getTileObjectByGid=function(t){var e;return(e=config.MapObject.list.find(function(e){return e.gid==t}))?this.getTileObjectById(e.id):(t>0&&console.log("null gid:",t),null)},e.getTileGround=function(t){return new a.default(t)},e}(cc.Component);n.default=P,cc._RF.pop()},{"./Controller/Drops":"Drops","./Controller/Map/BossRegion":"BossRegion","./Controller/Map/MapCtrl":"MapCtrl","./Controller/Map/Region":"Region","./Controller/Map/StructObjects/MineObj":"MineObj","./Controller/Map/TileDrops":"TileDrops","./Controller/Map/TileGround":"TileGround","./Controller/Map/TileObjects/BlockObj":"BlockObj","./Controller/Map/TileObjects/ChestObj":"ChestObj","./Controller/Map/TileObjects/DoorObj":"DoorObj","./Controller/Map/TileObjects/HomeObj":"HomeObj","./Controller/Map/TileObjects/PlantObj":"PlantObj","./Controller/Map/TileObjects/SpawnObj":"SpawnObj","./Controller/Map/TileObjects/TileObject":"TileObject","./Controller/Map/TileObjects/TriggerObj":"TriggerObj","./Controller/Map/TileObjects/WorksObj":"WorksObj","./Controller/Monster/Monster":"Monster","./Managers/PoolManager":"PoolManager","./Model/ItemInfo":"ItemInfo","./Res":"Res"}],FlyIcon:[function(t,e,n){"use strict";cc._RF.push(e,"2e8ccyf9FpB0LRppD+yzlvw","FlyIcon");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Managers/PoolManager"),s=t("../../Res"),c=cc._decorator,u=c.ccclass,l=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.setData=function(t,e,n,o,r){var i=this;this.getComponent(cc.Sprite).spriteFrame=s.default.Ins.getSprite(t),this.node.position=cc.v3(e);var c=r?cc.v3(e.add(cc.v2(70*Math.random()-35,70*Math.random()-35))):cc.v3(e.add(cc.v2(0,35*Math.random()))),u=cc.v3(n);this.node.scale=1,cc.tween(this.node).to(.7,{position:c,scale:1.2},{easing:cc.easing.quadOut}).to(.6,{position:u,scale:.4},{easing:cc.easing.quadIn}).call(function(){o&&o(),i.node.scale=1,a.PoolManager.PutPrefab(i.node)}).start()},e.prototype.setData2=function(t,e,n,o){var r=this;this.getComponent(cc.Sprite).spriteFrame=s.default.Ins.getSprite(t),this.node.position=cc.v3(e);var i=cc.v3(n);this.node.scale=1,cc.tween(this.node).to(.4,{position:i,scale:.3}).call(function(){o&&o(),r.node.scale=1,a.PoolManager.PutPrefab(r.node)}).start()},i([u],e)}(cc.Component));n.default=l,cc._RF.pop()},{"../../Managers/PoolManager":"PoolManager","../../Res":"Res"}],FuiCom:[function(t,e,n){"use strict";cc._RF.push(e,"50f80Lh4/dGS5oG+aQ8CINN","FuiCom");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../UI/UINode"),s=t("../ui_gen/DiggingUI/DiggingUIBinder"),c=cc._decorator,u=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isFuiLoaded=!1,e.isShow=!1,e}var n;return r(e,t),n=e,Object.defineProperty(e.prototype,"pkgPath",{get:function(){return"fui/"+this.pkg.pkgName},enumerable:!1,configurable:!0}),e.prototype.getResUrl=function(t){return fairygui.UIPackage.getItemURL(this.pkg.pkgName,t)},e.prototype.getChild=function(t){var e=this._view.getChild(t);return e||console.error("can't find child "+t+" in "+this.pkg.comName),e},e.prototype.getList=function(t){var e=this._view.getChild(t).asList;return e||console.error("can't find list child "+t+" in "+this.pkg.comName),e},e.prototype.start=function(){this.isShow=this.active,this.refreshShow()},e.prototype.show=function(){this.isShow=!0,this.refreshShow()},e.prototype.hide=function(){this.isShow=!1,this.refreshShow()},e.prototype.refreshShow=function(){this._isFuiLoaded&&(this._view.visible=this.isShow)},e.prototype.onLoad=function(){n.initGroot||(n.initGroot=!0,fgui.GRoot.create(),s.default.bindAll()),this._isFuiLoaded=!1,fgui.UIPackage.loadPackage(this.pkgPath,this.onUILoaded.bind(this)),t.prototype.onLoad.call(this)},e.prototype.onUILoaded=function(){this._isFuiLoaded=!0,this._view=fgui.UIPackage.createObject(this.pkg.pkgName,this.pkg.comName),this._view.width=fgui.GRoot.inst.width,this._view.height=fgui.GRoot.inst.height,this._view.addRelation(fgui.GRoot.inst,fgui.RelationType.Width),this._view.addRelation(fgui.GRoot.inst,fgui.RelationType.Height),this.isShow?this.show():this.hide(),fgui.GRoot.inst.addChild(this._view),console.log("load:",this.pkg.comName),this.onFuiInit()},e.prototype.onFuiInit=function(){},e.prototype.update=function(t){this._isFuiLoaded&&this.onUpdate(t)},e.prototype.onUpdate=function(){},e.prototype.onDestroy=function(){this._view.dispose()},e.initGroot=!1,n=i([u],e)}(a.default));n.default=l,cc._RF.pop()},{"../UI/UINode":"UINode","../ui_gen/DiggingUI/DiggingUIBinder":"DiggingUIBinder"}],GameManager:[function(t,e,n){"use strict";cc._RF.push(e,"ec7fdtoraFFrZqsWMoVNntf","GameManager");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../CollectMgr"),s=t("../CraftTaskMgr"),c=t("../Managers/AnimationManager"),u=t("../Managers/SoundManager"),l=t("../Mgr/StorageMgr"),f=t("../Operator"),p=t("../Res"),h=t("../UI/FairyUI/U_ContTips"),d=t("../UI/UI"),g=t("./Map/MapCtrl"),y=t("./Player/PlayerCtrl"),m=t("./ScreenEffectMask"),_=cc._decorator,v=_.ccclass,I=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInited=!1,e._timeScale=1,e._money=0,e.saveTimer=0,e.pauseFrameTween=null,e.cacheCmd=[],e.nextCmd=[],e}var n;return r(e,t),n=e,e.prototype.onLoad=function(){n.instance=this,console.log("====================================GameManager onload=============")},Object.defineProperty(e,"Ins",{get:function(){return this.instance},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.money=0},Object.defineProperty(e.prototype,"timeScale",{get:function(){return this._timeScale},set:function(t){this._timeScale=t,c.AM.updateScale()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"money",{get:function(){return this._money},set:function(t){this._money=t},enumerable:!1,configurable:!0}),e.prototype.pauseFrame=function(t){var e=this,n={frame:0,time:0};this.pauseFrameTween&&this.pauseFrameTween.stop(),this.timeScale=0,this.pauseFrameTween=cc.tween(n).to(1,{time:1},{progress:function(){n.frame++,n.frame>=t&&(e.pauseFrameTween.stop(),e.pauseFrameTween=null,e.timeScale=1)}}).start()},e.prototype.initGame=function(){g.default.Ins.init(),u.SoundManager.playMusic(u.SoundType.BGM),this.isInited=!0,a.default.Ins.on(a.ECollectEvent.E_CollectRes,this.onCollectRes,this)},e.prototype.onCollectRes=function(t){var e=config.Item.getById(t);e.isValuable&&d.default.getUI(h.default).setData("\u91cd\u8981\u7269\u54c1\uff01",p.default.getIconUrl(e.url),e.quality,e.name,e.desc)},e.prototype.cache=function(t){this.nextCmd.push(t)},e.prototype.executeCacheCmd=function(){this.cacheCmd.forEach(function(t){return t()}),this.cacheCmd=this.nextCmd,this.nextCmd=[]},e.prototype.update=function(t){t*=this.timeScale,g.default.Ins.heartCtrl.isFinishedStartGuide&&(this.saveTimer+=t,this.saveTimer>=config.GameCfg.config.saveTime&&(console.log("========Storage:",l.default),l.default.save(),this.saveTimer=0)),this.executeCacheCmd(),y.default.Ins.consumeFood(.1*t),s.default.Ins.update(t)},e.prototype.gameOver=function(){var t=this;m.default.Ins.fadeOut(3,cc.Color.BLACK,function(){t.reset(),m.default.Ins.fadeIn(3)})},e.prototype.reset=function(){g.default.Ins.reset(),y.default.Ins.reset(g.default.Ins.spawnCrd),f.default.exitStory()},e.instance=null,n=i([v],e)}(cc.Component));n.default=I,window.giveMoney=function(t){I.Ins.money=t},cc._RF.pop()},{"../CollectMgr":"CollectMgr","../CraftTaskMgr":"CraftTaskMgr","../Managers/AnimationManager":"AnimationManager","../Managers/SoundManager":"SoundManager","../Mgr/StorageMgr":"StorageMgr","../Operator":"Operator","../Res":"Res","../UI/FairyUI/U_ContTips":"U_ContTips","../UI/UI":"UI","./Map/MapCtrl":"MapCtrl","./Player/PlayerCtrl":"PlayerCtrl","./ScreenEffectMask":"ScreenEffectMask"}],GetItemTips:[function(t,e,n){"use strict";cc._RF.push(e,"4ee75WEb5ZENLDzBmh9MgT2","GetItemTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Managers/AnimationManager"),s=t("../../Managers/PoolManager"),c=cc._decorator,u=c.ccclass,l=c.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e}return r(e,t),e.prototype.setData=function(t,e){var n=this;a.AM.play(this.getComponent(cc.Animation),"getItemText"),this.node.opacity=255,this.label.node.color=e,cc.tween(this.node).to(2,{opacity:0}).call(function(){return s.PoolManager.PutPrefab(n.node)}).start()},i([l(cc.Label)],e.prototype,"label",void 0),i([u],e)}(cc.Component);n.default=f,cc._RF.pop()},{"../../Managers/AnimationManager":"AnimationManager","../../Managers/PoolManager":"PoolManager"}],GuideMgr:[function(t,e,n){"use strict";cc._RF.push(e,"177d0RVt4ZF17479RSv/Ha1","GuideMgr");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.GuideGetItemInfo=void 0;var c=t("./Controller/GuideView"),u=t("./Controller/Map/MapCtrl"),l=t("./Controller/Map/TileGrid"),f=t("./Controller/Player/PlayerCtrl"),p=t("./CraftTaskMgr"),h=t("./Managers/EventCenter"),d=t("./Model/Inventory"),g=function(){function t(){this.targetId=-1,this.targetNum=0,this.awaitGetresolveFunc=null,this.rejectFunc=null}return t.prototype.init=function(t,e,n,o){this.targetId=t,this.targetNum=e,this.awaitGetresolveFunc=n,this.rejectFunc=o},t.prototype.detect=function(){d.default.Ins.findResNum(this.targetId)>=this.targetNum&&(this.awaitGetresolveFunc&&this.awaitGetresolveFunc(),this.awaitGetresolveFunc=null,this.targetId=-1,this.targetNum=0)},t.prototype.finish=function(){this.awaitGetresolveFunc&&this.awaitGetresolveFunc()},t.prototype.cancel=function(){this.rejectFunc&&this.rejectFunc()},t}();n.GuideGetItemInfo=g;var y=cc._decorator,m=y.ccclass,_=y.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.finishFunc=null,e.targetDist=0,e.allMoveDist=0,e.awaitMoveResolveFunc=null,e.getItemAwaitMap=new Map,e.targetId=-1,e.awaitClearBossResolveFunc=null,e.targetDoor=null,e.finishTeleportTargetRegionId=-1,e}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return n.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this},e.prototype.guideToClick=function(t,e,n,o,r,i){return a(this,void 0,void 0,function(){return s(this,function(a){switch(a.label){case 0:return[4,this.guide.guideTo(t,e,n,o,r,i)];case 1:return a.sent(),[2]}})})},e.prototype.guideToCircle=function(t,e,n){return a(this,void 0,void 0,function(){return s(this,function(o){switch(o.label){case 0:return[4,this.guide.guideToCircle(t,e,n)];case 1:return o.sent(),[2]}})})},e.prototype.awaitFinishTask=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){p.default.once(p.ECraftTaskEvent.E_CraftTaskFinishTask,function(){return e()},t)})]})})},e.prototype.guideMoveMap=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){e.moveGuide.active=!0,f.default.Ins.banInput=!0,e.allMoveDist=0,e.targetDist=t,u.default.Ins.off(u.EMapEvent.MoveDelta,e.onMoveDelta,e),u.default.Ins.on(u.EMapEvent.MoveDelta,e.onMoveDelta,e),e.finishFunc=n})]})})},e.prototype.onMoveDelta=function(t){this.allMoveDist+=t.mag(),this.allMoveDist>this.targetDist&&this.finishMoveGuide()},e.prototype.finishMoveGuide=function(){u.default.Ins.off(u.EMapEvent.MoveDelta,this.onMoveDelta,this),this.moveGuide.active=!1,f.default.Ins.banInput=!1,this.finishFunc&&this.finishFunc()},e.prototype.awaitMoveToGrid=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return!t||t.isBlockMove?[2]:[2,new Promise(function(n){e.targetGrid=t,t.off(l.EGridEvent.PlayerMove,e.onGetGrid,e),t.on(l.EGridEvent.PlayerMove,e.onGetGrid,e),e.awaitMoveResolveFunc=n})]})})},e.prototype.onGetGrid=function(){this.targetGrid.off(l.EGridEvent.PlayerMove,this.onGetGrid,this),this.awaitMoveResolveFunc&&this.awaitMoveResolveFunc()},e.prototype.guideGetItem=function(t,e){return a(this,void 0,void 0,function(){var n=this;return s(this,function(){return[2,new Promise(function(o,r){if(d.default.Ins.findResNum(t)>=e)o();else{var i=new g;i.init(t,e,o,r),n.getItemAwaitMap.set(t,i),h.default.on(h.E_GetItem,n.onGetItem,n)}})]})})},e.prototype.cancelGuideGetItem=function(t){var e;null===(e=this.getItemAwaitMap.get(t))||void 0===e||e.cancel(),this.getItemAwaitMap.delete(t)},e.prototype.onGetItem=function(){var t=this;this.getItemAwaitMap.forEach(function(e,n){d.default.Ins.findResNum(n)>=e.targetNum&&(e.finish(),t.getItemAwaitMap.delete(n))})},e.prototype.awaitClearBoss=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){h.default.on(h.E_ClearBoss,e.onClearBoss,e),e.targetId=t,e.awaitClearBossResolveFunc=n})]})})},e.prototype.onClearBoss=function(t){this.targetId==t&&(this.awaitClearBossResolveFunc&&this.awaitClearBossResolveFunc(),this.targetId=-1,this.awaitClearBossResolveFunc=null)},e.prototype.awaitOpenDoor=function(t){var e=this;return new Promise(function(n){e.targetDoor=t,e.openDoorResolve=n,h.default.on(h.E_OpenDoor,e.onOpenDoor,e)})},e.prototype.onOpenDoor=function(t){t==this.targetDoor&&(this.openDoorResolve&&this.openDoorResolve(),this.openDoorResolve=null,this.targetDoor=null)},e.prototype.awaitHideCont=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.awaitEvent(h.E_ContHide)];case 1:return t.sent(),[2]}})})},e.prototype.awaitClickTeleport=function(){var t=this;return new Promise(function(e){h.default.once(h.E_ClickTeleport,function(){e()},t)})},e.prototype.awaitFinishTeleport=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){e.finishTeleportResolve=n,e.finishTeleportTargetRegionId=t,h.default.on(h.E_FinishTeleport,e.onFinishTeleport,e)})]})})},e.prototype.onFinishTeleport=function(t){t.region.id==this.finishTeleportTargetRegionId&&(this.finishTeleportResolve&&this.finishTeleportResolve(),this.finishTeleportResolve=null,this.finishTeleportTargetRegionId=-1)},e.prototype.awaitFinishAllTeleport=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.awaitEvent(h.E_FinishAllTeleport)];case 1:return t.sent(),[2]}})})},e.prototype.awaitEvent=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){h.default.once(t,function(){n()},e)})]})})},e.prototype.awaitOpenDoorByKeyId=function(t){var e=this;return new Promise(function(n){h.default.once(h.E_OpenDoor,function(e){e.doorCfg.keyId==t&&n()},e)})},e.instance=null,i([_(c.default)],e.prototype,"guide",void 0),i([_(cc.Node)],e.prototype,"moveGuide",void 0),n=i([m],e)}(cc.Component);n.default=v,cc._RF.pop()},{"./Controller/GuideView":"GuideView","./Controller/Map/MapCtrl":"MapCtrl","./Controller/Map/TileGrid":"TileGrid","./Controller/Player/PlayerCtrl":"PlayerCtrl","./CraftTaskMgr":"CraftTaskMgr","./Managers/EventCenter":"EventCenter","./Model/Inventory":"Inventory"}],GuideView:[function(t,e,n){"use strict";cc._RF.push(e,"b5396CEtHJPM6qo94sY9pID","GuideView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../AutoScripts/Guide_Auto"),u=t("../Managers/AnimationManager"),l=t("../Utils/CocosExtension"),f=t("./Map/MapCtrl"),p=t("./Map/TileGrid"),h=t("./TouchCtrl/MainTouchCtrl"),d=cc._decorator,g=d.ccclass,y=d.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cancelFunc=null,e}return r(e,t),e.prototype.onLoad=function(){this.view.modal.on(cc.Node.EventType.TOUCH_START,function(){})},e.prototype.wp2sp=function(t){return f.default.Ins.mapCamera.getWorldToScreenPoint(t)},e.prototype.guideTo=function(t,e,n,o,r,i){return void 0===o&&(o=!0),void 0===r&&(r=!0),void 0===i&&(i="\u70b9\u51fb\u6b64\u5904"),a(this,void 0,void 0,function(){var c=this;return s(this,function(){return[2,new Promise(function(u){return a(c,void 0,void 0,function(){var a,c,h,d,g;return s(this,function(s){switch(s.label){case 0:return this.hideGuide(),this.cancelFunc=function(){n&&n(),u()},this.view.modal.off(cc.Node.EventType.TOUCH_START,this.onCancelGuide,this),r||this.view.modal.once(cc.Node.EventType.TOUCH_START,this.onCancelGuide,this),t instanceof p.default?[4,f.default.Ins.focusToCrdAsync(t.crd)]:[3,2];case 1:return s.sent(),g=cc.v3(this.node.parent.convertToNodeSpaceAR(f.default.Ins.crd2sp(t.crd))),a=f.default.Ins.rootNodes.scale,this.view.tipsLabel.string=i,this.setGuideTrans(g,f.default.Ins.tileSize.width*a,f.default.Ins.tileSize.height*a,r,function(){e&&e(),u()}),[3,3];case 2:if(t instanceof fgui.GComponent){if(!t.visible)return console.warn("\u5f15\u5bfc\u5931\u8d25\uff0c\u7ec4\u4ef6\u88ab\u9690\u85cf\uff1a",t),[2];c=cc.v3(t.node.x+(.5-t.pivotX)*t.width,t.node.y+(t.pivotY-.5)*t.height),g=l.TransPos(t.node.parent,this.node.parent,c),this.view.tipsLabel.string=i,this.setGuideTrans(g,t.width,t.height,r,function(){o&&fgui.GRoot.inst.inputProcessor.simulateClick(t),e&&e(),u()})}else if(t instanceof cc.Node){if(!t.activeInHierarchy)return console.warn("\u5f15\u5bfc\u5931\u8d25\uff0c\u8282\u70b9\u88ab\u9690\u85cf\uff1a",t),[2];h=cc.v2(t.parent.convertToWorldSpaceAR(t.position)),d=this.wp2sp(h),g=this.node.parent.convertToNodeSpaceAR(d),this.view.tipsLabel.string=i,this.setGuideTrans(g,t.width,t.height,r,function(){e&&e(),u()})}s.label=3;case 3:return[2]}})})})]})})},e.prototype.guideToCircle=function(t,e,n){return void 0===n&&(n="\u70b9\u51fb\u6b64\u5904"),a(this,void 0,void 0,function(){var o=this;return s(this,function(){return[2,new Promise(function(r){return a(o,void 0,void 0,function(){var o,i,a,c,u;return s(this,function(s){switch(s.label){case 0:return this.hideGuide(),this.cancelFunc=function(){e&&e(),r()},this.view.modal.off(cc.Node.EventType.TOUCH_START,this.onCancelGuide,this),this.view.modal.once(cc.Node.EventType.TOUCH_START,this.onCancelGuide,this),t instanceof p.default?[4,f.default.Ins.focusToCrdAsync(t.crd)]:[3,2];case 1:return s.sent(),u=cc.v3(this.node.parent.convertToNodeSpaceAR(f.default.Ins.crd2sp(t.crd))),o=f.default.Ins.rootNodes.scale,this.view.tipsLabel.string=n,this.setGuideTrans(u,f.default.Ins.tileSize.width*o,f.default.Ins.tileSize.height*o,!0,function(){r()},!1),[3,3];case 2:if(t instanceof fgui.GComponent){if(!t.visible)return console.warn("\u5f15\u5bfc\u5931\u8d25\uff0c\u7ec4\u4ef6\u88ab\u9690\u85cf\uff1a",t),[2];i=cc.v3(t.node.x+(.5-t.pivotX)*t.width,t.node.y+(t.pivotY-.5)*t.height),u=l.TransPos(t.node.parent,this.node.parent,i),this.view.tipsLabel.string=n,this.setGuideTrans(u,t.width,t.height,!0,function(){r()})}else if(t instanceof cc.Node){if(!t.activeInHierarchy)return console.warn("\u5f15\u5bfc\u5931\u8d25\uff0c\u8282\u70b9\u88ab\u9690\u85cf\uff1a",t),[2];a=cc.v2(t.parent.convertToWorldSpaceAR(t.position)),c=this.wp2sp(a),u=this.node.parent.convertToNodeSpaceAR(c),this.view.tipsLabel.string=n,this.setGuideTrans(u,t.width,t.height,!0,function(){r()})}s.label=3;case 3:return[2]}})})})]})})},e.prototype.onCancelGuide=function(){this.hideGuide(),this.cancelFunc&&this.cancelFunc(),this.cancelFunc=null},e.prototype.setGuideTrans=function(t,e,n,o,r,i){var a=this;void 0===i&&(i=!0),this.node.setSiblingIndex(-1),this.node.active=!0,this.node.position=t,this.view.mask.scale=10,this.view.mask.width=e+60,this.view.mask.height=n+60,this.view.tips.y=-n/2-50,this.view.clickArea.node.width=e+60,this.view.click.active=!1,this.view.tips.active=!1,this.view.clickArea.node.width=n+60,o&&h.default.Ins.blockTouch(),this.view.clickArea.node.once(cc.Node.EventType.TOUCH_END,function(){a.hideGuide(),h.default.Ins.unblockTouch(),r&&r()}),this.guideTween&&this.guideTween.stop(),this.guideTween=cc.tween(this.view.mask).to(.7,{scale:1}).call(function(){i&&(a.view.click.active=!0,u.AM.play(a.view.click.getComponent(cc.Animation),"guideClick")),a.view.tips.active=!0,u.AM.play(a.view.tips.getComponent(cc.Animation),"guideTips"),a.guideTween=null}).start()},e.prototype.hideGuide=function(){this.node.active=!1,this.guideTween&&(this.guideTween.stop(),this.guideTween=null)},i([y(c.default)],e.prototype,"view",void 0),i([g],e)}(cc.Component);n.default=m,cc._RF.pop()},{"../AutoScripts/Guide_Auto":"Guide_Auto","../Managers/AnimationManager":"AnimationManager","../Utils/CocosExtension":"CocosExtension","./Map/MapCtrl":"MapCtrl","./Map/TileGrid":"TileGrid","./TouchCtrl/MainTouchCtrl":"MainTouchCtrl"}],Guide_Auto:[function(t,e,n){"use strict";cc._RF.push(e,"24934R62LdNnLMxLlTvOlmE","Guide_Auto");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mask=null,e.modal=null,e.click=null,e.tips=null,e.tipsLabel=null,e.clickArea=null,e}return r(e,t),i([c(cc.Node)],e.prototype,"mask",void 0),i([c(cc.Node)],e.prototype,"modal",void 0),i([c(cc.Node)],e.prototype,"click",void 0),i([c(cc.Node)],e.prototype,"tips",void 0),i([c(cc.Label)],e.prototype,"tipsLabel",void 0),i([c(cc.Button)],e.prototype,"clickArea",void 0),i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],HeartCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"4672d1D82BFWbG5QfF5TFAf","HeartCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.RequireInfo=void 0;var c=t("../AutoScripts/Tips_Auto"),u=t("../CraftTaskMgr"),l=t("../Managers/EventCenter"),f=t("../Mgr/UnlockMgr"),p=t("../Model/Inventory"),h=t("../Operator"),d=t("../Res"),g=t("../UI/FairyUI/U_HUD"),y=t("../UI/FairyUI/U_TaskRequire"),m=t("../UI/UI"),_=t("../UI/U_Shop"),v=t("../UI/U_TaskTips"),I=t("../Utils/CocosExtension"),b=t("./Map/MapCtrl"),C=t("./Map/TileTips"),M=t("./Player/PlayerCtrl"),w=t("./TouchCtrl/MainTouchCtrl"),P=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.reset(),this.id=t,this.need=e}return Object.defineProperty(t.prototype,"isFinish",{get:function(){return this.has>=this.need},enumerable:!1,configurable:!0}),t.prototype.gain=function(t){this.has+=t,this.numChangeFunc&&this.numChangeFunc(this.has,this.need),this.has>=this.need&&this.finishFunc&&this.finishFunc()},t.prototype.reset=function(){this.has=this.need=0},t}();n.RequireInfo=P;var O=cc._decorator,T=O.ccclass,j=O.property,k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fixSpriteFrames=[],e.startTipsNodes=[],e.selectNode=null,e.taskId=1,e.isFinishedStartGuide=!1,e.gainTween=null,e.gainTween2=null,e.gainTween3=null,e.startRequireInfo=null,e}return r(e,t),Object.defineProperty(e.prototype,"isBlockMove",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlockVisual",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grids",{get:function(){var t=this.areaObj.crds,e=[];return t.forEach(function(t){return e.push(b.default.Ins.getGrid(t))}),e},enumerable:!1,configurable:!0}),e.prototype.isCrdInArea=function(t){return this.areaObj.isCrdInArea(t)},Object.defineProperty(e.prototype,"itemEnterPos",{get:function(){var t=this.enterPos.position;return b.default.Ins.getLayer().node.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"itemExitPos",{get:function(){var t=this.exitPos.position;return b.default.Ins.getLayer().node.convertToNodeSpaceAR(this.node.convertToWorldSpaceAR(t))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"areaObj",{get:function(){return b.default.Ins.getFlagArea("heart")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animation",{get:function(){return this.getComponent(cc.Animation)},enumerable:!1,configurable:!0}),e.prototype.setState=function(t){this.animation.play("heart"+t),t>=this.fixSpriteFrames.length||!this.fixSpriteFrames[t]?this.fixOutline.node.active=!1:(this.fixOutline.node.active=!0,this.fixOutline.spriteFrame=this.fixSpriteFrames[t]),t>=this.startTipsNodes.length||!this.startTipsNodes[t]||(this.tips.node.position=this.startTipsNodes[t].position)},Object.defineProperty(e.prototype,"taskCfg",{get:function(){return config.HeartTask.getById(this.taskId)},enumerable:!1,configurable:!0}),e.prototype.init=function(){this.centerCrd=b.default.Ins.lp2crd(this.areaObj.centerPos),this.node.position=cc.v3(b.default.Ins.crd2lp(this.centerCrd)),l.default.on(w.E_PreTouchBegin,this.cancelSelect,this),f.default.on(f.EUnlockEvent.unlockBuy,this.refreshNewBuy,this),f.default.on(f.EUnlockEvent.unlockCraft,this.refreshNewCraft,this),f.default.on(f.EUnlockEvent.clearNewUnlock,this.refreshClearNew,this)},e.prototype.setSelect=function(){this.selectNode.active=!0},e.prototype.cancelSelect=function(){this.selectNode.active=!1},e.prototype.onClick=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r=this;return s(this,function(){if(this.setSelect(),t=b.default.getNearestCrd(this.areaObj.crds,M.default.Ins.curCrd),!(t=b.default.Ins.findCrdSideofObj(b.default.Ins.getGrid(t))))for(e=0;e<this.areaObj.crds.length&&(n=this.areaObj.crds[e],o=b.default.Ins.getGrid(n),!(t=b.default.Ins.findCrdSideofObj(o)));e++);return t?(M.default.Ins.moveToGrid(t,function(){return a(r,void 0,void 0,function(){var t,e,n,o,r,i=this;return s(this,function(a){switch(a.label){case 0:return this.isFinishedStartGuide?[4,b.default.Ins.focusToCrdAsync(this.centerCrd)]:[3,2];case 1:return a.sent(),m.default.getUI(_.default).show(),[3,7];case 2:if(t=this.startRequireInfo.id,(e=Math.min(p.default.Ins.findResNum(t),this.startRequireInfo.need-this.startRequireInfo.has))<=0)return m.default.getUI(v.default).setTxt("\u9700\u8981"+config.Item.getById(t).name+" "),[2];for(n=0;n<e;n++)p.default.Ins.loseItem(t);return w.default.Ins.blockTouch(),[4,b.default.Ins.focusToCrdAsync(this.centerCrd)];case 3:return a.sent(),o=b.default.Ins.crd2lp(this.centerCrd),r=b.default.Ins.crd2lp(M.default.Ins.curCrd),[4,this.flyItems(t,e,r,o,function(){i.tweenGet(),i.startRequireInfo.gain(1)})];case 4:return a.sent(),this.startRequireInfo.isFinish?[3,7]:[4,I.delay(500)];case 5:return a.sent(),[4,b.default.Ins.returnToPlayer()];case 6:a.sent(),w.default.Ins.unblockTouch(),this.startRequireInfo.giveFunc(),a.label=7;case 7:return[2]}})})}),[2]):(m.default.getUI(v.default).setTxt("\u4e0d\u53ef\u8fbe"),[2])})})},e.prototype.flyItems=function(t,e,n,o,r){return a(this,void 0,void 0,function(){var i=this;return s(this,function(){return[2,new Promise(function(c){return a(i,void 0,void 0,function(){var i,a;return s(this,function(s){switch(s.label){case 0:i=e,a=0,s.label=1;case 1:return a<e?[4,I.delay(50)]:[3,4];case 2:s.sent(),this.flyItemSingle(t,n,o,function(){i--,r&&r(),i<=0&&c()}),s.label=3;case 3:return a++,[3,1];case 4:return[2]}})})})]})})},e.prototype.flyCoins=function(t,e,n,o){return a(this,void 0,void 0,function(){var r=this;return s(this,function(){return[2,new Promise(function(i){return a(r,void 0,void 0,function(){var r,a;return s(this,function(s){switch(s.label){case 0:r=t,a=0,s.label=1;case 1:return a<t?[4,I.delay(50)]:[3,4];case 2:s.sent(),C.default.Ins.flyCoin(e,n,function(){r--,o&&o(),r<=0&&i()}),s.label=3;case 3:return a++,[3,1];case 4:return[2]}})})})]})})},e.prototype.tweenGet=function(){var t=this;this.gainTween&&this.gainTween.stop(),this.gainTween2&&this.gainTween2.stop(),this.gainTween3&&this.gainTween3.stop(),this.tips.icon.node.scale=1.3,this.gainTween=cc.tween(this.tips.icon.node).to(.2,{scale:1}).to(.2,{scale:1}).call(function(){return t.gainTween=null}).start(),this.spriteNode.scale=.8,this.gainTween2=cc.tween(this.spriteNode).to(.2,{scale:1}).to(.2,{scale:1}).call(function(){return t.gainTween2=null}).start(),this.effectNode.opacity=255,this.effectNode.scale=.8,this.gainTween3=cc.tween(this.effectNode).to(.2,{scale:1}).call(function(){t.gainTween3=null,t.effectNode.opacity=0}).start()},e.prototype.tweenEffect=function(){var t=this;this.gainTween3&&this.gainTween3.stop(),this.effectNode.opacity=255,this.gainTween3=cc.tween(this.effectNode).to(.7,{opacity:0}).call(function(){t.gainTween3=null,t.effectNode.opacity=0}).start()},e.prototype.flyItemSingle=function(t,e,n,o){return a(this,void 0,void 0,function(){return s(this,function(){return C.default.Ins.flyIcon(t,e,n,function(){o&&o()}),[2]})})},e.prototype.awaitFinishRequire=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){if(!e.startRequireInfo||e.startRequireInfo.isFinish||e.startRequireInfo.id!=t)n();else{var o=e.startRequireInfo.finishFunc;e.startRequireInfo.finishFunc=function(){o&&o(),n()}}})]})})},e.prototype.exitTeleport=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return b.default.Ins.returnToPlayer(),t=b.default.Ins.spawnCrd,M.default.Ins.teleportTo(t),M.default.Ins.Hero.show(),[4,C.default.Ins.showTeleportTips(t)];case 1:return e.sent(),b.default.Ins.normalNodeLayer(M.default.Ins.Hero.node),[4,h.default.exitStory()];case 2:return e.sent(),w.default.Ins.unblockTouch(),[2]}})})},e.prototype.setRequire=function(t,e,n,o){var r=this;this.startRequireInfo=new P(t,e);var i=null;47==t?i=this.snowSprite:43==t?i=this.iceSprite:3==t?i=this.copperSprite:4==t?i=this.ironSprite:8==t&&(i=this.rubySprite),this.tips.icon.spriteFrame=i;var a=this.tips.requireRoot.getComponent(cc.Animation);this.tips.progress.fillRange=0,this.tips.num.string=""+e,this.startRequireInfo.numChangeFunc=function(t,e){r.tips.progress.fillRange=t/e,r.tips.num.string=t+"/"+e},this.startRequireInfo.finishFunc=function(){n&&n()},this.startRequireInfo.giveFunc=function(){o&&o()},a.play("enter"),a.once(cc.Animation.EventType.FINISHED,function(){return a.play("idle")})},e.prototype.refreshNewBuy=function(t){this.tip2.active=!0;var e=config.ShopGoods.getById(t),n=config.Item.getById(e.resId);this.tip2.getChildByName("targetIcon").getComponent(cc.Sprite).spriteFrame=d.default.Ins.getSprite(n.url),this.tip2.getChildByName("label").getComponent(cc.Label).string="\u6709\u65b0\u5546\u54c1\u53ef\u8d2d\u4e70"},e.prototype.refreshNewCraft=function(t){this.tip2.active=!0;var e=config.ShopGoods.getById(t),n=config.Item.getById(e.resId);this.tip2.getChildByName("targetIcon").getComponent(cc.Sprite).spriteFrame=d.default.Ins.getSprite(n.url),this.tip2.getChildByName("label").getComponent(cc.Label).string="\u6709\u65b0\u7269\u54c1\u53ef\u5236\u4f5c"},e.prototype.refreshClearNew=function(){this.tip2.active=!1},e.prototype.finishCraftTask=function(t,e){return a(this,void 0,void 0,function(){var n,o,r,i,a,c,l=this;return s(this,function(s){switch(s.label){case 0:return this.tip2.active=!1,n=config.CraftTask.getById(t),e<0?(console.error("\u63d0\u4ea4\u8ba2\u5355\u65f6\u627e\u4e0d\u5230\u8ba2\u5355\u69fd\u4f4d"),[2]):(m.default.getUI(y.default).hide(),u.default.Ins.req_finishCraftTask(n.moduleId,e),[4,b.default.Ins.focusToCrdAsync(this.centerCrd)]);case 1:s.sent(),o=0,s.label=2;case 2:return o<n.matId.length?(p.default.Ins.loseItem(n.matId[o],n.matNum[o]),r=b.default.Ins.crd2lp(M.default.Ins.curCrd),[4,this.flyItems(n.matId[o],n.matNum[o],r,cc.v2(this.itemEnterPos),function(){l.tweenGet()})]):[3,5];case 3:s.sent(),s.label=4;case 4:return o++,[3,2];case 5:return n.resId>=0?(i=b.default.Ins.getFlagPoint("craftDrop").crd,a=b.default.Ins.crd2lp(i),[4,this.flyItems(n.resId,1,cc.v2(this.itemExitPos),a,function(){b.default.Ins.createDrops(b.default.Ins.getGrid(i),n.resId,1)})]):[3,7];case 6:s.sent(),s.label=7;case 7:return n.rewardCoin>0?(c=I.TransPos(m.default.getUI(g.default).view.m_coinNum.node.parent,C.default.Ins.mapUI,m.default.getUI(g.default).view.m_coinNum.node.position),[4,this.flyCoins(n.rewardCoin/10,cc.v2(this.itemExitPos),cc.v2(c),function(){h.default.addMoney(10)})]):[3,9];case 8:s.sent(),s.label=9;case 9:return[4,b.default.Ins.returnToPlayer()];case 10:return s.sent(),[2]}})})},e.prototype.finishRequire=function(){this.isFinishedStartGuide=!0,this.tips.node.active=!1},i([j(c.default)],e.prototype,"tips",void 0),i([j(cc.Node)],e.prototype,"spriteNode",void 0),i([j(cc.Node)],e.prototype,"effectNode",void 0),i([j(cc.Node)],e.prototype,"enterPos",void 0),i([j(cc.Node)],e.prototype,"tip2",void 0),i([j(cc.Sprite)],e.prototype,"fixOutline",void 0),i([j(cc.SpriteFrame)],e.prototype,"fixSpriteFrames",void 0),i([j(cc.Node)],e.prototype,"startTipsNodes",void 0),i([j(cc.Node)],e.prototype,"exitPos",void 0),i([j(cc.SpriteFrame)],e.prototype,"iceSprite",void 0),i([j(cc.SpriteFrame)],e.prototype,"snowSprite",void 0),i([j(cc.SpriteFrame)],e.prototype,"ironSprite",void 0),i([j(cc.SpriteFrame)],e.prototype,"copperSprite",void 0),i([j(cc.SpriteFrame)],e.prototype,"rubySprite",void 0),i([j(cc.Node)],e.prototype,"selectNode",void 0),i([T],e)}(cc.Component);n.default=k,cc._RF.pop()},{"../AutoScripts/Tips_Auto":"Tips_Auto","../CraftTaskMgr":"CraftTaskMgr","../Managers/EventCenter":"EventCenter","../Mgr/UnlockMgr":"UnlockMgr","../Model/Inventory":"Inventory","../Operator":"Operator","../Res":"Res","../UI/FairyUI/U_HUD":"U_HUD","../UI/FairyUI/U_TaskRequire":"U_TaskRequire","../UI/UI":"UI","../UI/U_Shop":"U_Shop","../UI/U_TaskTips":"U_TaskTips","../Utils/CocosExtension":"CocosExtension","./Map/MapCtrl":"MapCtrl","./Map/TileTips":"TileTips","./Player/PlayerCtrl":"PlayerCtrl","./TouchCtrl/MainTouchCtrl":"MainTouchCtrl"}],HeroView:[function(t,e,n){"use strict";cc._RF.push(e,"c8877dxMaVApojNFA9c0beW","HeroView");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.EAnimState=void 0;var a,s=t("../Managers/AnimationManager"),c=t("../Managers/SoundManager"),u=t("../Model/Inventory"),l=t("./GameManager"),f=t("./Player/PlayerCtrl"),p=cc._decorator,h=p.ccclass,d=p.property;(function(t){t.Move="move",t.Idle="idle",t.Dig="dig",t.Hurt="hurt",t.Attack="attack",t.Dead="dead"})(a=n.EAnimState||(n.EAnimState={}));var g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.renderer=null,e.getDropsAnim=null,e._leftDir=!1,e.animState=a.Idle,e.nextAnimState=a.Idle,e.animFuncs=[],e.nextAnimFuncs=[],e.startFunc=null,e.nextStartFunc=null,e.finishAnimFunc=null,e.nextFinishAnimFunc=null,e.isResetAnim=!1,e}return r(e,t),e.prototype.setLayerPos=function(t){this.node.position=cc.v3(t)},e.prototype.getLayerPos=function(){return this.curPos},Object.defineProperty(e.prototype,"leftDir",{get:function(){return this._leftDir},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curPos",{get:function(){return cc.v2(this.node.position)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curCrd",{get:function(){return f.default.Ins.curCrd},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wp",{get:function(){return this.node.parent.convertToWorldSpaceAR(this.curPos)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animation",{get:function(){return this.getComponent(cc.Animation)},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.animation.on(cc.Animation.EventType.FINISHED,this.onEndAnim,this)},e.prototype.getDrops=function(){s.AM.play(this.getDropsAnim,"getResEffect")},e.prototype.update=function(){l.default.Ins.timeScale,this.updateAnim(),this.renderer.node.scaleX=this._leftDir?1:-1},e.prototype.setAnimState=function(t,e,n,o,r){void 0===e&&(e=!1),void 0===n&&(n=[]),void 0===o&&(o=function(){}),void 0===r&&(r=function(){}),e&&this.animState!=a.Idle?(this.nextAnimState=t,this.nextAnimFuncs=n,this.nextStartFunc=o,this.nextFinishAnimFunc=r):(this.animFuncs=n,this.nextAnimFuncs=[],this.nextAnimState=null,this.animState=t,this.nextStartFunc=null,this.startFunc=o,this.finishAnimFunc=r,this.nextFinishAnimFunc=null)},e.prototype.hide=function(){this.renderer.enabled=!1},e.prototype.show=function(){this.renderer.enabled=!0},e.prototype.clearAnimState=function(){this.isResetAnim=!0},e.prototype.updateAnim=function(){var t=this.getAnimNameByState(this.animState),e=s.AM.getAnimState(this.animation);f.default.Ins.isDie&&e.name==this.getAnimNameByState(a.Dead)||!this.isResetAnim&&e&&e.name==t&&e.isPlaying||(this.startFunc&&this.startFunc(),this.startFunc=null,s.AM.play(this.animation,t),this.isResetAnim=!1)},e.prototype.changeDir=function(t){this._leftDir=t},e.prototype.A_Event=function(t){t=t||0,this.animFuncs&&this.animFuncs.length>t&&this.animFuncs[t]()},e.prototype.A_StepSound=function(){c.SoundManager.playEffect(Math.random()<.5?c.SoundType.Step1:c.SoundType.Step2)},e.prototype.onEndAnim=function(){this.finishAnimFunc&&this.finishAnimFunc(),this.nextAnimState?(this.animState=this.nextAnimState,this.animFuncs=this.nextAnimFuncs,this.startFunc=this.nextStartFunc,this.finishAnimFunc=this.nextFinishAnimFunc,this.nextStartFunc=null,this.nextAnimState=null,this.nextFinishAnimFunc=null):this.animation.currentClip.wrapMode==cc.WrapMode.Normal&&(this.animState=a.Idle)},e.prototype.getAnimNameByState=function(t){return t==a.Attack?u.default.Ins.weapon.weaponCfg.animName:t==a.Dig?u.default.Ins.pickaxe.pickaxeCfg.animName:t.toString()},e.prototype.getRuntimeAnimState=function(t){var e=this.getAnimNameByState(t),n=s.AM.getAnimState(this.animation);return n.name==e?n:null},i([d(cc.Sprite)],e.prototype,"renderer",void 0),i([d(cc.Animation)],e.prototype,"getDropsAnim",void 0),i([d(cc.Node)],e.prototype,"getResTxtPos",void 0),i([h],e)}(cc.Component);n.default=g,cc._RF.pop()},{"../Managers/AnimationManager":"AnimationManager","../Managers/SoundManager":"SoundManager","../Model/Inventory":"Inventory","./GameManager":"GameManager","./Player/PlayerCtrl":"PlayerCtrl"}],HomeObj:[function(t,e,n){"use strict";cc._RF.push(e,"a440e7OiOlD4Iiz2oH7LLNF","HomeObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"isBlockMove",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.onClick=function(){},e}(t("./TileObject").default);n.default=i,cc._RF.pop()},{"./TileObject":"TileObject"}],Inventory:[function(t,e,n){"use strict";cc._RF.push(e,"98390lpe8ZDEZ5Eg4a4NuqE","Inventory");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Controller/Player/PlayerCtrl"),s=t("../Factory"),c=t("../Managers/EventCenter"),u=t("../Mgr/StorageMgr"),l=t("../Mgr/UnlockMgr"),f=t("../Res"),p=t("../UI/FairyUI/U_ContTips"),h=t("../UI/UI"),d=t("./ItemInfo"),g=cc._decorator,y=g.ccclass,m=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.resList=[],e._pickaxe=null,e.defaultPickaxe=new d.PickaxeInfo(12),e.defaultWeapon=new d.WeaponInfo(38),e._weapon=null,e._food=null,e._coin=0,e}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return n.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this},Object.defineProperty(e.prototype,"coin",{get:function(){return this._coin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pickaxe",{get:function(){return this._pickaxe?this._pickaxe:this.defaultPickaxe},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"weapon",{get:function(){return this._weapon?this._weapon:this.defaultWeapon},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"food",{get:function(){return this._food},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"slotInfos",{get:function(){return[this.pickaxe,this.weapon,this.food]},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.init()},e.prototype.addMoney=function(t){this._coin+=t,c.default.send(c.E_InfoChange)},e.prototype.saveData=function(){var t=JSON.stringify(this.resList)+"|"+JSON.stringify(this._pickaxe)+"|"+JSON.stringify(this._weapon)+"|"+JSON.stringify(this._food)+"|"+JSON.stringify(this._coin);localStorage.setItem(u.EStorageKey.inventory,t)},e.prototype.loadJson=function(){var t=u.default.newVer()?null:localStorage.getItem(u.EStorageKey.inventory);if(t){var e=t.split("|"),n=JSON.parse(e[0]),o=(JSON.parse(e[1]),JSON.parse(e[2]),JSON.parse(e[3]),JSON.parse(e[4]));this.resList=[];for(var r=0;r<n.length;r++){var i=s.default.getItemInfo(n[r].cfgId);Object.assign(i,n[r]),this.resList.push(i)}this._coin=o}},e.prototype.clearSave=function(){localStorage.removeItem(u.EStorageKey.inventory)},e.prototype.init=function(){!u.default.newVer()&&localStorage.getItem(u.EStorageKey.inventory)&&this.loadJson()},e.prototype.setPickaxe=function(t){this._pickaxe=t||null,a.default.Ins.switchPickaxe(t.pickaxeCfg.id),c.default.send(c.E_InfoChange)},e.prototype.consumePickaxe=function(t){void 0===t&&(t=1);var e=this._pickaxe;if(e&&!(e.pickaxeCfg.duration<0)){e.duration-=t;var n=!1;return e.duration<=0&&(this.loseItem(e.cfgId),a.default.Ins.switchPickaxe(this.defaultPickaxe.pickaxeCfg.id),this._pickaxe=null,n=!0),c.default.send(c.E_InfoChange),n}},e.prototype.consumeWeapon=function(t){void 0===t&&(t=1);var e=this._weapon;if(e&&!(e.weaponCfg.duration<0)){e.duration-=t;var n=!1;return e.duration<=0&&(this.loseItem(e.cfgId),a.default.Ins.switchWeapon(this.defaultWeapon.weaponCfg.id),this._weapon=null,n=!0),c.default.send(c.E_InfoChange),n}},e.prototype.setWeapon=function(t){this._weapon=t||null,a.default.Ins.switchWeapon(t.weaponCfg.id),c.default.send(c.E_InfoChange)},e.prototype.setFood=function(t){this._food=t||null,c.default.send(c.E_InfoChange)},e.prototype.getItem=function(t,e){void 0===e&&(e=1);var n=config.Item.getById(t);if(n.type!=config.ItemType.Blueprint){if(d.default.canStack(t)){var o=this.resList.find(function(e){return e.cfgId==t});null==o&&((o=s.default.getItemInfo(t)).init(0),this.resList.push(o)),o.count+=e}else{var r=s.default.getItemInfo(t);r.init(1),this.resList.push(r),n.type!=config.ItemType.Pickaxe&&n.type!=config.ItemType.Weapon||h.default.getUI(p.default).setData("\u83b7\u5f97\u7269\u54c1",f.default.getIconUrl(n.url),n.quality,n.name,n.desc)}c.default.send(c.E_GetItem,t),c.default.send(c.E_InfoChange)}else{var i=config.Blueprint.list.find(function(e){return e.resId==t});i.craftId&&i.craftId>0?(l.default.Ins.unlockCraft(i.craftId),h.default.getUI(p.default).setData("\u89e3\u9501\u65b0\u914d\u65b9\uff01",f.default.getIconUrl(n.url),n.quality,n.name,n.desc)):i.goodsId&&i.goodsId>0&&(l.default.Ins.unlockBuy(i.goodsId),h.default.getUI(p.default).setData("\u89e3\u9501\u65b0\u5546\u54c1\uff01",f.default.getIconUrl(n.url),n.quality,n.name,n.desc))}},e.prototype.loseItem=function(t,e){void 0===e&&(e=1);var n=this.resList.find(function(e){return e.cfgId==t});null!=n&&(n.count-=e,n.count<=0&&(this.resList.splice(this.resList.indexOf(n),1),this.food==n&&this.setFood(null))),c.default.send(c.E_LoseItem),c.default.send(c.E_InfoChange)},e.prototype.findRes=function(t){return this.resList.find(function(e){return e.cfgId==t})},e.prototype.findResNum=function(t){var e=this.resList.find(function(e){return e.cfgId==t});return e?e.count:0},e.instance=null,n=i([y],e)}(cc.Component));n.default=m,window.Inv=m,cc._RF.pop()},{"../Controller/Player/PlayerCtrl":"PlayerCtrl","../Factory":"Factory","../Managers/EventCenter":"EventCenter","../Mgr/StorageMgr":"StorageMgr","../Mgr/UnlockMgr":"UnlockMgr","../Res":"Res","../UI/FairyUI/U_ContTips":"U_ContTips","../UI/UI":"UI","./ItemInfo":"ItemInfo"}],ItemInfo:[function(t,e,n){"use strict";cc._RF.push(e,"8bcddZ8ilZCJpuHuJS8OOYC","ItemInfo");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.ConsumeInfo=n.WeaponInfo=n.PickaxeInfo=void 0;var i=function(){function t(t){this.cfgId=t,this.count=0}return Object.defineProperty(t.prototype,"cfg",{get:function(){return config.Item.getById(this.cfgId)},enumerable:!1,configurable:!0}),t.canStack=function(t){var e=config.Item.getById(t);return e.type==config.ItemType.Res||e.type==config.ItemType.Consume},t.prototype.init=function(t){return void 0===t&&(t=1),this.count=t,this},t}();n.default=i;var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"pickaxeCfg",{get:function(){var t=this;return config.Pickaxe.list.find(function(e){return e.resId==t.cfgId})},enumerable:!1,configurable:!0}),e.prototype.init=function(e){return t.prototype.init.call(this,e),this.duration=this.pickaxeCfg.duration,this},e}(i);n.PickaxeInfo=a;var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"weaponCfg",{get:function(){var t=this;return config.Weapon.list.find(function(e){return e.resId==t.cfgId})},enumerable:!1,configurable:!0}),e.prototype.init=function(e){return t.prototype.init.call(this,e),this.duration=this.weaponCfg.duration,this},e}(i);n.WeaponInfo=s;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"consumeCfg",{get:function(){var t=this;return config.Consume.list.find(function(e){return e.resId==t.cfgId})},enumerable:!1,configurable:!0}),e}(i);n.ConsumeInfo=c,cc._RF.pop()},{}],MainTouchCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"abf0cB+OMJI2aB8bawgeVxG","MainTouchCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.E_PreTouchBegin=n.ETouchState=void 0;var s=t("../Map/MapCtrl"),c=t("../../UI/UICtrl"),u=t("../GameManager"),l=t("../../Managers/EventCenter"),f=cc._decorator,p=f.ccclass,h=f.property;(function(t){t[t.Await=0]="Await",t[t.NoInput=1]="NoInput",t[t.Drag=2]="Drag",t[t.Hold=3]="Hold"})(n.ETouchState||(n.ETouchState={})),n.E_PreTouchBegin="E_PreTouchBegin";var d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchableObj=[],e.canTouch=!0,e.touchGrid=null,e.timer=0,e.buildTime=.5,e.lastTouchDist=-1,e.allDelta=cc.v2(0,0),e}var o;return r(e,t),o=e,Object.defineProperty(e,"Ins",{get:function(){return o.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){o.instance=this},e.prototype.blockTouch=function(){this.canTouch=!1},e.prototype.unblockTouch=function(){this.canTouch=!0},e.prototype.update=function(t){t*=u.default.Ins.timeScale,this.touchGrid&&(this.timer+=t),this.timer>this.buildTime&&(this.touchGrid.onBuildWork(),this.touchGrid=null,this.timer=0)},e.prototype.addTouchableObj=function(t){null==this.touchableObj.find(function(e){return e===t})&&this.touchableObj.push(t)},e.prototype.removeTouchableObj=function(t){this.touchableObj.splice(this.touchableObj.indexOf(t),1)},e.prototype.onTouch=function(t){var e=!1,n=s.default.Ins.getGrid(s.default.Ins.sp2crd(t));a(this.touchableObj).forEach(function(n){n.isInTouchArea(t)&&(n.onTouch(),e=!0)}),e||this.onTouchGrid(n)},e.prototype.onTouchDoubleMove=function(t,e){var n=cc.Vec2.distance(t,e)/1500;if(this.lastTouchDist<0)this.lastTouchDist=n;else{var o=n-this.lastTouchDist;this.lastTouchDist=n,s.default.Ins.scaleZoom(o)}},e.prototype.onTouchGrid=function(t){l.default.send(n.E_PreTouchBegin),this.timer=0,c.default.Ins.hideTips(),this.canTouch?(t?(window.targetGrid=t,console.log("%c\u3010grid\u3011"+t.toStr(),"color:blue")):console.log("%c\u3010invalid grid\u3011","color:blue"),this.touchGrid=t,this.lastTouchDist=-1):console.log("%cblock touch","color:red")},e.prototype.onCancelGrid=function(){console.log("%ccancel touch","color:green"),this.lastTouchDist=-1},e.prototype.onMoveGrid=function(t){this.canTouch&&(this.allDelta.mag()>20?(this.touchGrid=null,s.default.Ins.move(t)):this.allDelta.addSelf(t))},e.prototype.onEndGrid=function(){console.log("%cend touch","color:green"),this.allDelta=cc.v2(0,0),this.touchGrid&&(this.touchGrid.onTouchGrid(),this.touchGrid=null)},e.instance=null,i([h],e.prototype,"buildTime",void 0),o=i([p],e)}(cc.Component);n.default=d,window.MainTouchCtrl=d,cc._RF.pop()},{"../../Managers/EventCenter":"EventCenter","../../UI/UICtrl":"UICtrl","../GameManager":"GameManager","../Map/MapCtrl":"MapCtrl"}],Main:[function(t,e,n){"use strict";cc._RF.push(e,"b337eFk2g5F/YF1/8hzhcIz","Main");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([s],e)}(cc.Component));n.default=c;var u=!1;if(cc.sys.os===cc.sys.OS_IOS||cc.sys.os===cc.sys.OS_OSX){var l=cc.sys.platform===cc.sys.WECHAT_GAME;if(l?null===GameGlobal||void 0===GameGlobal?void 0:GameGlobal.isIOSHighPerformanceMode:cc.sys.isBrowser){var f=window.navigator.userAgent.match(/((OS )|(Version\/))(\d+)(\.(\d+))?/);if(f){var p=+f[4]||0,h=+f[6]||0;cc.macro.ENABLE_WEBGL_ANTIALIAS=14===p,u=l?14===p||15===p&&h<4:14===p}}}cc.game.on(cc.game.EVENT_ENGINE_INITED,function(){u?(cc.MeshBuffer.prototype.checkAndSwitchBuffer=function(t){this.vertexOffset+t>65535&&(this.uploadData(),this._batcher._flush())},cc.MeshBuffer.prototype.forwardIndiceStartToOffset=function(){this.uploadData(),this.switchBuffer()}):(cc.MeshBuffer.prototype.checkAndSwitchBuffer=function(t){this.vertexOffset+t>65535&&(this.uploadData(),this._batcher._flush(),this.switchBuffer())},cc.MeshBuffer.prototype.forwardIndiceStartToOffset=function(){this.indiceStart=this.indiceOffset})}),cc._RF.pop()},{}],MapCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"1d36dkxJdBId73FkTQUN1E2","MapCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},c=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.PathInfo=n.EMapEvent=n.EFollowState=n.mask_invisiable=n.dir4=n.dir8=n.FlagRegion=n.FlagArea=n.FlagPoint=n.FlagObject=n.EOffsetType=n.ETileLayer=void 0;var u,l,f=t("../../Factory"),p=t("./TileGrid"),h=t("../GameManager"),d=t("../../UI/UI"),g=t("../../Operator"),y=t("../Player/PlayerCtrl"),m=t("../../UI/U_TaskTips"),_=t("../Monster/Monster"),v=t("../../Managers/PoolManager"),I=t("../Drops"),b=t("../HeartCtrl"),C=t("../../Utils/StateCtrl"),M=t("../../UI/FairyUI/U_HUD"),w=t("../../Res"),P=t("../StartGameCtrl"),O=t("../../Utils/CocosExtension"),T=t("./TileTips"),j=t("../../Mgr/StorageMgr"),k=t("./StructObjects/TeleportObj"),S=cc._decorator,U=S.ccclass,R=S.property;(function(t){t.Ground="layer_ground",t.Object="layer_object",t.Ore="layer_ore",t.Mask="layer_mask",t.Flag="flags",t.Region="region"})(u=n.ETileLayer||(n.ETileLayer={})),function(t){t[t.LeftCenter=0]="LeftCenter",t[t.MiddleCenter=1]="MiddleCenter",t[t.RightCenter=2]="RightCenter",t[t.LeftTop=3]="LeftTop",t[t.MiddleTop=4]="MiddleTop",t[t.RightTop=5]="RightTop",t[t.LeftBottom=6]="LeftBottom",t[t.MiddleBottom=7]="MiddleBottom",t[t.RightBottom=8]="RightBottom"}(l=n.EOffsetType||(n.EOffsetType={}));var E=function(){function t(t,e){this.obj=t,this.name=e;var n=B.Ins.crd2lp(cc.v2()),o=B.Ins.tileSize;this.lp=cc.v2(t.x+n.x-o.width/2,t.y-n.y-o.height/2)}return t.prototype.getProp=function(t){return this.obj[t]?this.obj[t]:null},t}();n.FlagObject=E;var A=function(t){function e(e,n){return t.call(this,e,n)||this}return r(e,t),Object.defineProperty(e.prototype,"crd",{get:function(){return B.Ins.lp2crd(this.lp)},enumerable:!1,configurable:!0}),e}(E);n.FlagPoint=A;var x=function(t){function e(e,n){var o=t.call(this,e,n)||this,r=o.lp;return o.minX=r.x,o.minY=r.y-e.height,o.maxX=r.x+e.width,o.maxY=r.y,o}return r(e,t),Object.defineProperty(e.prototype,"crds",{get:function(){for(var t=B.Ins.lp2crd(cc.v2(this.minX,this.maxY)),e=B.Ins.lp2crd(cc.v2(this.maxX,this.minY)),n=[],o=t.x;o<=e.x;o++)for(var r=t.y;r<=e.y;r++)n.push(cc.v2(o,r));return n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerCrd",{get:function(){return B.Ins.lp2crd(this.centerPos)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerPos",{get:function(){return cc.v2((this.minX+this.maxX)/2,(this.minY+this.maxY)/2)},enumerable:!1,configurable:!0}),e.prototype.isLpInArea=function(t){return t.x>=this.minX&&t.x<=this.maxX&&t.y>=this.minY&&t.y<=this.maxY},e.prototype.isCrdInArea=function(t){var e=B.Ins.crd2lp(t);return e.x>=this.minX&&e.x<=this.maxX&&e.y>=this.minY&&e.y<=this.maxY},e}(E);n.FlagArea=x;var D,F,G=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.title=e.title,o}return r(e,t),e}(x);n.FlagRegion=G,n.dir8=[cc.v2(-1,-1),cc.v2(-1,1),cc.v2(1,1),cc.v2(1,-1),cc.v2(-1,0),cc.v2(1,0),cc.v2(0,-1),cc.v2(0,1)],n.dir4=[cc.v2(-1,0),cc.v2(1,0),cc.v2(0,-1),cc.v2(0,1)],n.mask_invisiable=1,function(t){t[t.Free=0]="Free",t[t.Fixed=1]="Fixed",t[t.Follow=2]="Follow"}(D=n.EFollowState||(n.EFollowState={})),function(t){t.MoveDelta="moveDelta"}(F=n.EMapEvent||(n.EMapEvent={}));var B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.groundAreas=[],e.iceAreas=[],e.oreAreas=[],e.regionMask=null,e.regionHighlight=null,e.structObjs=[],e.tileNodes=null,e.rootNodes=null,e.regionSize=cc.v2(8,8),e.flagObjs=[],e.worksGrids=[],e.monsters=[],e.grids=[],e.regions=new Map,e.crdhashRegionIdMap=new Map,e.drops=[],e.isInitExplored=!1,e.activeRegions=[],e.cameraZoom=1,e.effectZoom=1,e.highlightRegionMaskTween=null,e}var o;return r(e,t),o=e,Object.defineProperty(e,"Ins",{get:function(){return o.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){var t=this;o.instance=this,this.followState=new C.default(D.Follow),this.followState.bindState(D.Follow,function(){return d.default.getUI(M.default).hideFollow()}).bindState(D.Fixed,function(){return d.default.getUI(M.default).showFollow()}).bindState(D.Free,function(){return d.default.getUI(M.default).showFollow()}).bindTrans(D.Free,D.Follow,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.focusToDynaPosAsync(function(){return y.default.Ins.Hero.curPos})];case 1:return[2,t.sent()]}})})}).bindTrans(D.Fixed,D.Follow,function(){return a(t,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.focusToDynaPosAsync(function(){return y.default.Ins.Hero.curPos})];case 1:return[2,t.sent()]}})})}),this.map.enableCulling(!0),this.parseMap()},e.prototype.on=function(t,e,n,o){this.node.on("Map_"+t,e,n,o)},e.prototype.off=function(t,e,n,o){this.node.off("Map_"+t,e,n,o)},e.prototype.emit=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(e=this.node).emit.apply(e,c(["Map_"+t],n))},Object.defineProperty(e.prototype,"centerCrd",{get:function(){var t=this.map.getMapSize();return cc.v2(Math.floor(t.width/2),Math.floor(t.height/2))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileSize",{get:function(){return this.map.getTileSize()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hero",{get:function(){return y.default.Ins.Hero},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.monsters.forEach(function(t){return t.clear()}),this.monsters=[]},e.prototype.saveData=function(){this.map.getMapSize();for(var t=[],e=0;e<this.grids.length;e++){t.push([]);for(var n=0;n<this.grids[e].length;n++){var o=this.grids[e][n].getGridData;t[e].push(o)}}j.default.setItem(j.EStorageKey.mapData,JSON.stringify(t));var r=[];this.regions.forEach(function(t){r.push(t.getStorageData())}),j.default.setItem(j.EStorageKey.regionsInfo,JSON.stringify(r)),j.default.setItem(j.EStorageKey.playerCrd,JSON.stringify(y.default.Ins.curCrd))},e.prototype.clearSave=function(){j.default.removeItem(j.EStorageKey.mapData),j.default.removeItem(j.EStorageKey.regionsInfo),j.default.removeItem(j.EStorageKey.playerCrd)},e.prototype.loadFlags=function(){var t=this;this.flagObjs=[],this.map.getObjectGroup(u.Flag).getObjects().forEach(function(e){var n=t.createFlagObject(e);t.flagObjs.push(n)}),this.spawnCrd=this.getFlagPoint("spawn").crd},e.prototype.loadGrids=function(){var t=j.default.newVer()?null:localStorage.getItem(j.EStorageKey.mapData),e=t?JSON.parse(t):null;e||(this.isInitExplored=!0),this.grids=[],this.worksGrids=[];for(var n=this.map.getMapSize(),o=0;o<n.width;o++){this.grids.push([]);for(var r=0;r<n.height;r++){var i=cc.v2(o,r),a=new p.default;if(e)this.getRegionByCrd(i),a.load(this,i,e[o][r]),this.setTile(i,e[o][r].ground_gid,u.Ground),this.setTile(i,e[o][r].object_gid,u.Object),this.setTile(i,e[o][r].ore_gid,u.Ore);else{var s=this.getTileGID(i,u.Object),c=this.getTileGID(i,u.Ore),l=this.getTileGID(i,u.Ground);a.load(this,i,{ground_gid:l,object_gid:s,ore_gid:c,isExplored:!1})}this.grids[o].push(a)}}},e.prototype.loadRegion=function(){var t=this;this.regions=new Map,this.map.getObjectGroup(u.Region).getObjects().forEach(function(e){var n=new G(e,e.name),o=Number.parseInt(n.name),r=f.default.getRegion(o,n);t.regions.set(o,r)});var e=j.default.getItem(j.EStorageKey.regionsInfo);e?JSON.parse(e).forEach(function(e){t.getRegionById(e.id).load(e)}):this.regions.forEach(function(t){return t.load(null)}),this.regions.forEach(function(e,n){var o=n;e.grids.forEach(function(e){return t.crdhashRegionIdMap.set(t.crd2hash(e.crd),o)})})},e.prototype.parseMap=function(){this.loadFlags(),this.loadGrids(),this.loadRegion()},e.prototype.topNodeLayer=function(t){t.setParent(this.topSortingNode)},e.prototype.normalNodeLayer=function(t){t.setParent(this.sortingNode)},e.prototype.initBigOre=function(){var t=this;this.getFlagObjs("bigOre").forEach(function(e){var n=e.name.split("#")[1],o=f.default.getBigOre(n);o.init(e.crd),o.grids.forEach(function(e){return t.clearObj(e)}),t.structObjs.push(o)})},e.prototype.initGrids=function(){for(var t=this.map.getMapSize(),e=0;e<t.width;e++)for(var n=0;n<t.height;n++){var o=cc.v2(e,n);this.getGrid(o).init()}},e.prototype.initRegion=function(){this.regions.forEach(function(t){return t.init()})},e.prototype.initPlayer=function(){y.default.Ins.on(y.EPlayerEvent.PlayerMoveCrd,this.onPlayerMoveCrd,this);var t=j.default.getItem(j.EStorageKey.playerCrd),e=t?Object.assign(cc.v2(),JSON.parse(t)):this.spawnCrd;y.default.Ins.init(e)},e.prototype.initHeart=function(){this.heartCtrl.init(),this.structObjs.push(this.heartCtrl)},e.prototype.init=function(){var t=this;this.initGrids(),this.initBigOre(),this.initRegion(),this.initHeart(),this.structObjs.forEach(function(e){return t.initStructObj(e)}),this.initPlayer(),this.isInitExplored&&this.exploreGrid(this.getGrid(y.default.Ins.curCrd)),this.followState.refresh(),P.default.Ins.startGame()},e.prototype.findFromGrid=function(t,e){void 0===e&&(e=function(t){return t.isVisible});for(var n=this.activeRegions,o=[],r=0;r<n.length;r++)for(var i=n[r],a=0;a<i.grids.length;a++)e(i.grids[a])&&i.grids[a].isItemFrom(t)&&o.push(i.grids[a]);return 0==o.length?null:(o.sort(function(t,e){return cc.Vec2.distance(t.crd,y.default.Ins.curCrd)-cc.Vec2.distance(e.crd,y.default.Ins.curCrd)}),o[0])},e.prototype.onPlayerMoveCrd=function(){var t=[],e=y.default.Ins.curCrd,n=this.getRegionById(this.crd2RegionId(e));n&&(t.push(n),this.regionMask.position=cc.v3(n.centerPos),this.regionMask.width=n.width,this.regionMask.height=n.height);for(var o=function(e){var n=r.activeRegions[e];t.find(function(t){return t.id==n.id})||n.onExitActive()},r=this,i=0;i<this.activeRegions.length;i++)o(i);var a=function(e){s.activeRegions.find(function(n){return n.id==t[e].id})||t[e].onEnterActive()},s=this;for(i=0;i<t.length;i++)a(i);this.activeRegions=t},e.prototype.crd2RegionId=function(t){return this.crdhashRegionIdMap.get(this.crd2hash(t))},e.prototype.getRegionByCrd=function(t){var e=this.crd2RegionId(t);return this.getRegionById(e)},e.prototype.getRegionById=function(t){return t?this.regions.get(t):null},e.prototype.update=function(t){t*=h.default.Ins.timeScale,this.followState.curState==D.Follow&&this.resetToHeroSight(),this.grids.forEach(function(e){return e.forEach(function(e){return e.update(t)})}),this.regions.forEach(function(e){e.onUpdate(t)})},e.prototype.getLayer=function(t){return void 0===t&&(t=u.Ground),this.map.getLayer(t)},e.prototype.getFlagObject=function(t){return this.flagObjs.find(function(e){return e.name==t})},e.prototype.getFlagObjs=function(t){for(var e=[],n=0;n<this.flagObjs.length;n++)O.hasStr(this.flagObjs[n].name,t)&&e.push(this.flagObjs[n]);return e},e.prototype.getFlagArea=function(t){return this.flagObjs.find(function(e){return e.name==t&&e instanceof x})||(console.error("\u627e\u4e0d\u5230area\uff1a",t),null)},e.prototype.getFlagPoint=function(t){return this.flagObjs.find(function(e){return e.name==t&&e instanceof A})||(console.error("\u627e\u4e0d\u5230point\uff1a",t),null)},e.prototype.createFlagObject=function(t){var e=t.name;if(e)return"A"==e.split("_")[0]?new x(t,e.split("_")[1]):"P"==e.split("_")[0]?new A(t,e.split("_")[1]):new E(t,e.split("_")[1])},e.prototype.setTile=function(t,e,n){if(!this.validCrd(t))return null;this.getLayer(n).setTileGIDAt(e,t.x,t.y)},e.prototype.getTile=function(t,e){return this.validCrd(t)?this.getLayer(e).getTiledTileAt(t.x,t.y,!0):null},e.prototype.setTiledTile=function(t,e,n,o){if(void 0===o&&(o=255),!this.validCrd(t))return null;var r=this.getLayer(n).getTiledTileAt(t.x,t.y,!0);r.gid=e,r.node.opacity=o},e.prototype.getTiledTile=function(t,e){return this.validCrd(t)?this.getLayer(e).getTiledTileAt(t.x,t.y,!0):null},e.prototype.getTileGID=function(t,e){return this.validCrd(t)?this.getLayer(e).getTileGIDAt(t.x,t.y):-1},e.prototype.sp2crd=function(t,e){void 0===e&&(e=u.Ground);var n=this.mapCamera.getScreenToWorldPoint(t),o=this.getLayer(e).node.convertToNodeSpaceAR(n),r=this.map.getTileSize(),i=this.map.getMapSize();return cc.v2(Math.floor(o.x/r.width+i.width/2),Math.floor(i.height/2-o.y/r.height))},e.prototype.lp2crd=function(t){var e=this.map.getTileSize(),n=this.map.getMapSize();return cc.v2(Math.floor(t.x/e.width+n.width/2),Math.floor(n.height/2-t.y/e.height))},e.prototype.crd2wp=function(t,e,n){return void 0===e&&(e=l.MiddleCenter),void 0===n&&(n=u.Ground),this.getLayer(n).node.convertToWorldSpaceAR(this.crd2lp(t,e,n))},e.prototype.crd2sp=function(t,e,n){void 0===e&&(e=l.MiddleCenter),void 0===n&&(n=u.Ground);var o=this.crd2wp(t,e,n);return this.mapCamera.getWorldToScreenPoint(o)},e.prototype.crd2lp=function(t,e,n){void 0===e&&(e=l.MiddleCenter),void 0===n&&(n=u.Ground);var o=this.map.getTileSize(),r=this.map.getMapSize(),i=cc.v2((t.x-r.width/2)*o.width,(r.height/2-t.y)*o.height),a=this.getOffset(e);return i.addSelf(a)},e.prototype.crd2hash=function(t){return t.x+1e4*t.y},e.prototype.validCrd=function(t){var e=this.map.getMapSize();return t.x>=0&&t.x<e.width&&t.y>=0&&t.y<e.height},e.prototype.nearGrids=function(t,e,n){if(void 0===e&&(e=1),void 0===n&&(n=function(){return!0}),t){for(var o=t.crd,r=[],i=-e;i<=e;i++)for(var a=-e;a<=e;a++){var s=o.add(cc.v2(i,a));this.validCrd(s)&&n(this.getGrid(s))&&r.push(this.getGrid(s))}return r}},e.prototype.extNearGrids=function(t,e,n,o){if(void 0===e&&(e=1),void 0===o&&(o=function(){return!0}),t){var r=[],i=[];i.push(t);for(var a=[],s=function(){var s=i.shift();if(r.find(function(t){return t.equals(s.crd)}))return"continue";r.push(s.crd),o(s)&&a.push(s);for(var u=c.neighborGrids(s),l=function(o){var a=u[o];if(Math.abs(t.crd.x-a.crd.x)>e||Math.abs(t.crd.y-a.crd.y)>e)return"continue";!r.find(function(t){return t.equals(a.crd)})&&n(a)&&i.push(a)},f=0;f<u.length;f++)l(f)},c=this;i.length>0;)s();return a}},e.prototype.neighborGrids=function(t,e,n){var o;if(void 0===e&&(e=1),void 0===n&&(n=function(){return!0}),o=t instanceof cc.Vec2?this.getGrid(t):t){for(var r=o.crd,i=[],a=-e;a<=e;a++)for(var s=-e;s<=e;s++){var c=cc.v2(a,s);if(!(Math.abs(c.x)+Math.abs(c.y)>e||c.equals(cc.v2(0,0)))){var u=r.add(cc.v2(a,s));this.validCrd(u)&&n(this.getGrid(u))&&i.push(this.getGrid(u))}}return i}},e.prototype.extNeighborGrids=function(t,e,n,r){if(void 0===e&&(e=1),void 0===r&&(r=function(){return!0}),t){for(var i=t.crd,a=[],s=[],c=[],u=-e;u<=e;u++)for(var l=-e;l<=e;l++)if(!(Math.abs(u)+Math.abs(l)>e)){var f=i.add(cc.v2(u,l));n(this.getGrid(f))&&a.push(this.getGrid(f)),this.validCrd(f)&&r(this.getGrid(f))&&c.push(this.getGrid(f))}for(var p=function(e){var n=c[e],r=t.crd.sub(n.crd);r=cc.v2(Math.sign(r.x),Math.sign(r.y));var i=cc.v2(0,r.y).add(n.crd),u=cc.v2(r.x,0).add(n.crd),l=o.Ins.getGrid(i),f=o.Ins.getGrid(u);l&&!a.find(function(t){return t.crd.equals(l.crd)})&&l!=n||f&&!a.find(function(t){return t.crd.equals(f.crd)})&&f!=n||s.push(n)},h=0;h<c.length;h++)p(h);return s}},e.prototype.getGrid=function(t){return this.validCrd(t)&&this.grids[t.x]&&this.grids[t.x][t.y]?this.grids[t.x][t.y]:null},e.prototype.exploreGrid=function(t){if(t){var e=[],n=[];n.push(t);for(var o=function(){var t=n.shift();if(e.find(function(e){return e.equals(t.crd)}))return"continue";if(e.push(t.crd),t.setExplored(!0),!t.isBlockVisual)for(var o=r.neighborGrids(t),i=function(t){var r=o[t];e.find(function(t){return t.equals(r.crd)})||r.isVisible||n.push(r)},a=0;a<o.length;a++)i(a)},r=this;n.length>0;)o()}},e.prototype.tranverseCrd=function(t){for(var e=this.map.getMapSize(),n=0;n<e.width;n++)for(var o=0;o<e.height;o++)t(cc.v2(n,o))},e.prototype.getOffset=function(t){var e=cc.v2(),n=this.map.getTileSize();switch(t){case l.LeftBottom:case l.MiddleBottom:case l.RightBottom:e.y=-n.height;break;case l.LeftCenter:case l.MiddleCenter:case l.RightCenter:e.y=-n.height/2;break;case l.LeftTop:case l.MiddleTop:case l.RightTop:e.y=0}switch(t){case l.LeftBottom:case l.LeftCenter:case l.LeftTop:e.x=0;case l.MiddleBottom:case l.MiddleCenter:case l.MiddleTop:e.x=n.width/2;break;case l.RightBottom:case l.RightCenter:case l.RightTop:e.x=n.width}return e},e.prototype.resetToHeroSight=function(){var t=O.TransPos(this.hero.node.parent,this.mapCamera.node.parent,this.hero.node.position);this.mapCamera.node.position=cc.v3(t)},e.prototype.returnToPlayer=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,this.followState.switchTo(D.Follow)];case 1:return t.sent(),[2]}})})},e.prototype.move=function(t){this.tween&&(this.tween.stop(),this.tween=null),this.followState.switchTo(D.Free);var e=cc.v3(t),n=this.crd2wp(y.default.Ins.curCrd);this.mapCamera.node.parent.convertToNodeSpaceAR(n),this.emit(F.MoveDelta,t),this.mapCamera.node.position=this.mapCamera.node.position.sub(e)},e.prototype.scaleZoom=function(t){this.cameraZoom=cc.misc.clampf(this.cameraZoom+t,.6,1.1),this.refreshZoom()},e.prototype.refreshZoom=function(){var t=this.cameraZoom*this.effectZoom;this.mapCamera.zoomRatio=t},e.prototype.focusToCrdAsync=function(t){return a(this,void 0,Promise,function(){return s(this,function(e){switch(e.label){case 0:return this.followState.switchTo(D.Fixed),[4,this.focusTo(t)];case 1:return e.sent(),[2]}})})},e.prototype.focusToLpAsync=function(t){return a(this,void 0,Promise,function(){return s(this,function(e){switch(e.label){case 0:return this.followState.switchTo(D.Fixed),[4,this.focusToByPos(t)];case 1:return e.sent(),[2]}})})},e.prototype.setFocus=function(t){this.followState.switchTo(D.Fixed);var e=this.mapCamera.node.parent.convertToNodeSpaceAR(this.crd2wp(t));this.mapCamera.node.position=cc.v3(e)},e.prototype.setFocusByPos=function(t){this.followState.switchTo(D.Fixed);var e=this.mapCamera.node.parent.convertToNodeSpaceAR(this.getLayer().node.convertToWorldSpaceAR(t));this.mapCamera.node.position=cc.v3(e)},e.prototype.focusToDynaPosAsync=function(t){return a(this,void 0,void 0,function(){var e,n,o,r,i=this;return s(this,function(){return t?(e=function(){return i.mapCamera.node.parent.convertToNodeSpaceAR(i.getLayer().node.convertToWorldSpaceAR(t()))},this.tween&&this.tween.stop(),n=config.MapCfg.config.focusTime,o={t:0},r=this.mapCamera.node.position,[2,new Promise(function(t){i.tween=cc.tween(o).to(n,{t:1},{onUpdate:function(){var t=e(),n=cc.Vec3.lerp(cc.v3(),r,cc.v3(t),o.t);i.mapCamera.node.position=n},easing:"sineOut"}).call(function(){i.tween=null,t()}).start()})]):[2]})})},e.prototype.focusTo=function(t){return a(this,void 0,Promise,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){e.tween&&e.tween.stop();var o=e.mapCamera.node.parent.convertToNodeSpaceAR(e.crd2wp(t));e.tween=cc.tween(e.mapCamera.node).to(config.MapCfg.config.focusTime,{position:cc.v3(o)},{easing:"sineOut"}).call(function(){e.tween=null,n()}).start()})]})})},e.prototype.focusToByPos=function(t){return a(this,void 0,Promise,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){e.tween&&e.tween.stop();var o=e.mapCamera.node.parent.convertToNodeSpaceAR(e.getLayer().node.convertToWorldSpaceAR(t));e.tween=cc.tween(e.mapCamera.node).to(config.MapCfg.config.focusTime,{position:cc.v3(o)},{easing:"sineOut"}).call(function(){e.tween=null,n()}).start()})]})})},e.prototype.findAllAreaGrid=function(t,e,o,r){if(void 0===r&&(r=function(t){return!t.isBlockMove}),!this.validCrd(t))return null;var i=[],a=[],s=[];for(s.push({grid:this.getGrid(t),dist:0});s.length>0;){var c=s.shift();i.push(c.grid.crd),c.dist>=e&&c.dist<=o&&a.push(c);for(var u=function(e){var a=c.grid.crd.add(n.dir4[e]),u=Math.abs(a.x-t.x)+Math.abs(a.y-t.y);if(u>o)return"continue";var f=l.getGrid(a);l.validCrd(a)&&!i.find(function(t){return t.equals(a)})&&r(f)&&s.push({grid:f,dist:u})},l=this,f=0;f<n.dir4.length;f++)u(f)}return a},e.prototype.findEmptyGrids=function(t,e){var o=[],r=[],i=[];for(i.push(this.getGrid(t));i.length>0;){var a=i.shift();if(o.push(a.crd),null==a.object&&null==a._structObj&&a.isExplored&&(r.push(a),r.length>=e))return r;for(var s=c(n.dir4).sort(function(){return Math.random()-.5}),u=function(t){var e=a.crd.add(s[t]),n=l.getGrid(e);l.validCrd(e)&&!o.find(function(t){return t.equals(e)})&&i.push(n)},l=this,f=0;f<s.length;f++)u(f)}return[]},e.prototype.findAllLightingGrid=function(t,e,o){if(void 0===o&&(o=function(t){return!t.isBlockVisual}),!this.validCrd(t))return null;var r=[],i=[],a=[];for(a.push({grid:this.getGrid(t),dist:0});a.length>0;){var s=a.shift();if(r.push(s.grid.crd),s.dist<=e&&i.push(s),o(s.grid))for(var c=function(o){var i=s.grid.crd.add(n.dir4[o]),c=cc.Vec2.distance(i,t);if(c>e)return"continue";var l=u.getGrid(i);u.validCrd(i)&&!r.find(function(t){return t.equals(i)})&&a.push({grid:l,dist:c})},u=this,l=0;l<n.dir4.length;l++)c(l)}return i},e.prototype.isDirectPath=function(t,e,n){void 0===n&&(n=function(t){return!t.isBlockMove});for(var o=this.getTouchedPosBetweenTwoPoints(t,e),r=0;r<o.length;r++)if(!n(this.getGrid(o[r])))return!1;return!0},e.prototype.getTouchedPosBetweenTwoPoints=function(t,e){var n=this.getTouchedPosBetweenOrigin2Target(e.sub(t));return n.forEach(function(e){e.addSelf(t)}),n},e.prototype.getTouchedPosBetweenOrigin2Target=function(t){for(var e=function(t,e){if(null!=e)for(var n=function(n){t.find(function(t){return t.equals(e[n])})||t.push(e[n])},o=0;o<e.length;o++)n(o)},n=[],o=Math.abs(t.y)>Math.abs(t.x),r=o?t.y:t.x,i=(o?t.x:t.y)/r,a=r>0?.5:-.5,s=1;s<2*Math.abs(r);s++){var c=s*a,u=i*c,l=.5==Math.abs(u-Math.floor(u));if(0==(1&s))l?(e(n,[cc.v2(Math.round(c),Math.ceil(u))]),e(n,[cc.v2(Math.round(c),Math.floor(u))])):e(n,[cc.v2(Math.round(c),Math.round(u))]);else{if(l)continue;e(n,[cc.v2(Math.ceil(c),Math.round(u))]),e(n,[cc.v2(Math.floor(c),Math.round(u))])}}if(o)for(s=0;s<n.length;s++){var f=n[s];f.x=f.x^f.y,f.y=f.x^f.y,f.x=f.x^f.y,n[s]=f}return function(t,e){if(null!=e)for(var n=function(n){t.find(function(t){return t.equals(e[n])})&&t.splice(t.findIndex(function(t){return t.equals(e[n])}),1)},o=0;o<e.length;o++)n(o)}(n,[cc.v2(),t]),n},e.prototype.searchAreaCrds=function(t,e,n){void 0===e&&(e=function(){return!1});var o=[],r=[],i=[],a=[];i.push(t);for(var s=function(t){return t&&!a.find(function(e){return e.equals(t.crd)})&&!e(t)};i.length>0;){var c=i.shift(),u=this.getGrid(c);if(s(u)&&(u.isBlockVisual?o.push(u):r.push(u),a.push(c),!u.isBlockVisual))for(var l=this.neighborGrids(u),f=0;f<l.length;f++){var p=l[f];s(p)&&i.push(p.crd)}}return n&&n.push.apply(n,a),{edges:o,areas:r}},e.prototype.findCrdSideofObj=function(t,e){e||(e=function(e){return!e.isBlockMove||e.crd.equals(t.crd)});var n=this.findPathByDir4(y.default.Ins.curCrd,t.crd,e);return n.isEmpty?null:n.pathCrds.length>1?n.pathCrds[n.pathCrds.length-2]:n.pathCrds[0]},e.prototype.findCrdSideOfStructObj=function(t){var e=o.getNearestCrd(t.grids.map(function(t){return t.crd}),y.default.Ins.curCrd);if(!(e=o.Ins.findCrdSideofObj(o.Ins.getGrid(e))))for(var n=0;n<t.grids.length;n++){var r=t.grids[n];if(e=o.Ins.findCrdSideofObj(r))break}return e},e.getNearestCrd=function(t,e){return t.sort(function(t,n){return cc.Vec2.distance(t,e)-cc.Vec2.distance(n,e)}),t[0]},e.prototype.findPathByDir4=function(t,e,n,o){var r=this;void 0===n&&(n=function(t){return!t.isBlockVisual&&!t.isBlockMove}),void 0===o&&(o=50);var i=[],a=[],s=[],u=t,l=0,f=function(t){var n,r,f,p,d,g,y=(n=t,r=e,f=Math.abs(n.x-r.x),p=Math.abs(n.y-r.y),d=Math.min(f,p),g=Math.max(f,p),Math.sqrt(2)*d+(g-d));if(!(y>o)){var m=cc.Vec2.distance(u,t);m>1&&(m*=.999);var _=l+m,v=i.find(function(e){return e.crd.equals(t)}),I=a.find(function(e){return e.crd.equals(t)});I&&I.cost+I.dist>y+_?(I.cost=_,I.dist=y,I.crd=t,h.set(t,c(s,[t]))):I||v&&!(v.cost+v.dist>y+_)||(a.unshift({crd:t,cost:_,dist:y}),h.set(t,c(s,[t])))}},p=function(t){var e=r.getGrid(t);return r.validCrd(t)&&n(e)},h=new Map;for(f(t);a.length>0;){var d=a.shift();if(u=d.crd,l=d.cost,s=c(h.get(u)),i.push(d),u.equals(e)){var g=h.get(u);return new N(this,g)}for(var y=this.neighborGrids(this.getGrid(u)),m=0;m<y.length;m++){var _=y[m].crd;p(_)&&f(_)}a.sort(function(t,e){return t.dist+t.cost-(e.dist+e.cost)})}return new N(this,[])},e.prototype.findPathByDir8=function(t,e,n,o){var r=this;void 0===n&&(n=function(t){return!t.isBlockVisual&&!t.isBlockMove}),void 0===o&&(o=50);var i=[],a=[],s=[],u=t,l=0,f=function(t){var n,r,f,p,d,g,y=(n=t,r=e,f=Math.abs(n.x-r.x),p=Math.abs(n.y-r.y),d=Math.min(f,p),g=Math.max(f,p),Math.sqrt(2)*d+(g-d));if(!(y>o)){var m=cc.Vec2.distance(u,t);m>1&&(m*=.999);var _=l+m,v=i.find(function(e){return e.crd.equals(t)}),I=a.find(function(e){return e.crd.equals(t)});I&&I.cost+I.dist>y+_?(I.cost=_,I.dist=y,I.crd=t,h.set(t,c(s,[t]))):I||v&&!(v.cost+v.dist>y+_)||(a.unshift({crd:t,cost:_,dist:y}),h.set(t,c(s,[t])))}},p=function(t){var e=r.getGrid(t);return r.validCrd(t)&&n(e)},h=new Map;for(f(t);a.length>0;){var d=a.shift();if(u=d.crd,l=d.cost,s=c(h.get(u)),i.push(d),u.equals(e)){var g=h.get(u);return new N(this,g)}for(var y=this.nearGrids(this.getGrid(u)),m=[],_=0;_<y.length;_++)this.isAccessDiagonal(u,y[_].crd,n)&&m.push(y[_]);for(_=0;_<m.length;_++){var v=m[_].crd;p(v)&&f(v)}a.sort(function(t,e){return t.dist+t.cost-(e.dist+e.cost)})}return new N(this,[])},e.prototype.isAccessDiagonal=function(t,e,n){if(1!=Math.abs(t.x-e.x)||1!=Math.abs(t.y-e.y))return!0;var o=this.getGrid(cc.v2(t.x,e.y)),r=this.getGrid(cc.v2(e.x,t.y));return n(o)&&n(r)},e.prototype.highlightRegionMask=function(t){var e=this;this.highlightRegionMaskTween&&this.highlightRegionMaskTween.stop(),this.regionHighlight.position=cc.v3(t.centerPos),this.regionHighlight.width=t.width,this.regionHighlight.height=t.height,this.regionHighlight.opacity=150,this.highlightRegionMaskTween=cc.tween(this.regionHighlight).to(.4,{opacity:0}).call(function(){e.highlightRegionMaskTween=null}).start()},e.prototype.createDrops=function(t,e,n){var o=this,r=f.default.getDrops(t,e,n);return r.node.setParent(this.tileNodes),r.node.position=cc.v3(t.pos),this.drops.push(r),r.on(I.EDropsEvent.ClearDrops,function(){return o.drops.splice(o.drops.findIndex(function(t){return t==r}),1)}),r},e.prototype.testWp=function(t){var e=v.PoolManager.GetPrefab(w.default.Ins.tag);e.setParent(T.default.Ins.mapUI),e.position=cc.v3(e.parent.convertToNodeSpaceAR(t))},e.prototype.createMonster=function(t,e){var n=this,o=f.default.getMonster(t,e);return o.node.setParent(this.sortingNode),o.init(t,e),this.monsters.push(o),o.on(_.EMonsterEvent.Dead,function(){return n.monsters.splice(n.monsters.findIndex(function(t){return t==o}),1)}),o},e.prototype.createTeleport=function(t){var e=v.PoolManager.GetPrefab(w.default.Ins.teleport);e.setParent(this.sortingNode),e.position=cc.v3(t.centerPos);var n=this.lp2crd(t.centerPos.sub(cc.v2(this.tileSize.width/2,this.tileSize.height/2)));return e.getComponent(k.default).load(t,n),e.getComponent(k.default)},e.prototype.createChest=function(t){var e=f.default.getTileObjectById(105);return e.init(t),t.setObj(e),e},e.prototype.initStructObj=function(t){for(var e=t.grids,n=0;n<e.length;n++)e[n]._structObj=t},e.prototype.setObj=function(t,e){if(null!=e){var n=f.default.getTileObjectById(t);e.setObj(n)}else console.error("\u65e0\u6cd5\u8bbe\u7f6e\u7269\u4f53\uff0c\u5730\u683c\u4e3a\u7a7a")},e.prototype.setObjByGid=function(t,e){if(null!=e){var n=f.default.getTileObjectByGid(t);e.setObj(n)}else console.error("\u65e0\u6cd5\u8bbe\u7f6e\u7269\u4f53\uff0c\u5730\u683c\u4e3a\u7a7a")},e.prototype.buildWorks=function(t,e){var n=this,r=config.Works.getById(t),i=config.MapObject.getById(r.objId).gid,a=o.Ins.findCrdSideofObj(e,function(t){return!t.isBlockMove||t.crd.equals(e.crd)});a?y.default.Ins.moveToGrid(a,function(){g.default.consumeBuildMat(t);var o=f.default.getTileObjectByGid(i);o.init(e),n.worksGrids.push(e),e.setObj(o)}):d.default.getUI(m.default).setTxt("\u4e0d\u53ef\u5230\u8fbe")},e.prototype.clearObj=function(t){t.clearObj()},e.instance=null,i([R(cc.Camera)],e.prototype,"mapCamera",void 0),i([R(cc.TextAsset)],e.prototype,"groundAreas",void 0),i([R(cc.TextAsset)],e.prototype,"iceAreas",void 0),i([R(cc.TextAsset)],e.prototype,"oreAreas",void 0),i([R(cc.Node)],e.prototype,"regionMask",void 0),i([R(cc.Node)],e.prototype,"regionHighlight",void 0),i([R(cc.Node)],e.prototype,"tileNodes",void 0),i([R(cc.Node)],e.prototype,"rootNodes",void 0),i([R(cc.TiledMap)],e.prototype,"map",void 0),i([R(b.default)],e.prototype,"heartCtrl",void 0),i([R],e.prototype,"regionSize",void 0),i([R(cc.Node)],e.prototype,"sortingNode",void 0),i([R(cc.Node)],e.prototype,"topSortingNode",void 0),o=i([U],e)}(cc.Component);n.default=B;var N=function(){function t(t,e){void 0===e&&(e=[]),this.pathCrds=[],this.mapCtrl=t,this.pathCrds=e}return Object.defineProperty(t.prototype,"isEmpty",{get:function(){return 0==this.pathCrds.length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startCrd",{get:function(){return this.isEmpty?null:this.pathCrds[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"endCrd",{get:function(){return this.isEmpty?null:this.pathCrds[this.pathCrds.length-1]},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this.pathCrds.map(function(t){return"("+t.x+","+t.y+")"}).join("->")},t}();n.PathInfo=N,window.MapCtrl=B,window.getGrid=function(t,e){return B.Ins.getGrid(cc.v2(t,e))},cc._RF.pop()},{"../../Factory":"Factory","../../Managers/PoolManager":"PoolManager","../../Mgr/StorageMgr":"StorageMgr","../../Operator":"Operator","../../Res":"Res","../../UI/FairyUI/U_HUD":"U_HUD","../../UI/UI":"UI","../../UI/U_TaskTips":"U_TaskTips","../../Utils/CocosExtension":"CocosExtension","../../Utils/StateCtrl":"StateCtrl","../Drops":"Drops","../GameManager":"GameManager","../HeartCtrl":"HeartCtrl","../Monster/Monster":"Monster","../Player/PlayerCtrl":"PlayerCtrl","../StartGameCtrl":"StartGameCtrl","./StructObjects/TeleportObj":"TeleportObj","./TileGrid":"TileGrid","./TileTips":"TileTips"}],MapScroll:[function(t,e,n){"use strict";cc._RF.push(e,"99419RvfElFtL1gwcbhQDxF","MapScroll");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapNode=null,e.touchStartPos1=null,e.touchStartPos2=null,e.touchMovePos1=null,e.touchMovePos2=null,e.mapStartPos=null,e}return r(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.onTouchStart=function(t){2===t.getTouches().length&&(this.touchStartPos1=t.getTouches()[0].getLocation(),this.touchStartPos2=t.getTouches()[1].getLocation(),this.mapStartPos=cc.v2(this.mapNode.position))},e.prototype.onTouchMove=function(t){if(2===t.getTouches().length){this.touchMovePos1=t.getTouches()[0].getLocation(),this.touchMovePos2=t.getTouches()[1].getLocation();var e=this.touchStartPos1.sub(this.touchStartPos2).mag(),n=this.touchMovePos1.sub(this.touchMovePos2).mag()-e,o=this.touchStartPos1.add(this.touchStartPos2).mul(.5),r=this.touchMovePos1.add(this.touchMovePos2).mul(.5).sub(o),i=1+.01*n,a=this.mapStartPos.add(r);this.mapNode.scale*=i,this.mapNode.position=cc.v3(a)}},e.prototype.onTouchEnd=function(t){2!==t.getTouches().length&&(this.touchStartPos1=null,this.touchStartPos2=null,this.touchMovePos1=null,this.touchMovePos2=null,this.mapStartPos=null)},i([c(cc.Node)],e.prototype,"mapNode",void 0),i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],MapTest:[function(t,e,n){"use strict";cc._RF.push(e,"2277bvcKcZJ5JO3mk3sMw9H","MapTest");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"map",{get:function(){return this.getComponent(cc.TiledMap)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"layer",{get:function(){return this.map.getLayer("set")},enumerable:!1,configurable:!0}),e.prototype.setTile=function(t,e){this.map.getLayer("set").setTileGIDAt(e,t.x,t.y)},e.prototype.wp2crd=function(t){var e=this.layer.node.convertToNodeSpaceAR(t),n=this.map.getTileSize(),o=this.map.getMapSize();return cc.v2(Math.floor(e.x/n.width+o.width/2),Math.floor(o.height/2-e.y/n.height))},i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],MatItem:[function(t,e,n){"use strict";cc._RF.push(e,"7b7c2w+1BdFJo1arAt8/wj2","MatItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../Model/Inventory"),a=t("../../Res"),s=t("../FairyUI/U_ItemDetail"),c=t("../UI"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onClickCall=null,e}return r(e,t),Object.defineProperty(e.prototype,"frame",{get:function(){return this.getChild("frame").asCom},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"iconCom",{get:function(){return this.getChild("icon").asLoader},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this.getChild("label").asLabel},enumerable:!1,configurable:!0}),e.prototype.setData=function(t,e){this.resId=t;var n=config.Item.getById(t),o=i.default.Ins.findRes(t),r=a.default.getIconUrl(n.url),s=o?o.count:0;this.iconCom.url=r,this.label.text=s+"/"+e,this.label.asTextField.color=e>s?cc.Color.RED:cc.Color.WHITE,this.frame.getController("cQuality").selectedIndex=n.quality,this.onClick(this.onClickItem,this)},e.prototype.onClickItem=function(t){t.stopPropagation(),this.onClickCall&&this.onClickCall();var e=config.Item.getById(this.resId);c.default.getUI(s.default).setData(e.id)},e.isEnough=function(t,e){for(var n=0;n<t.length;n++){var o=t[n],r=e[n],a=i.default.Ins.findRes(o);if((a?a.count:0)<r)return!1}return!0},e}(fairygui.GComponent);n.default=u,cc._RF.pop()},{"../../Model/Inventory":"Inventory","../../Res":"Res","../FairyUI/U_ItemDetail":"U_ItemDetail","../UI":"UI"}],MineObj:[function(t,e,n){"use strict";cc._RF.push(e,"aca25F2cP1MVKnee9Yey2jr","MineObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../Managers/EffectManager"),s=t("../../../Managers/SoundManager"),c=t("../../../UI/UI"),u=t("../../../UI/U_TaskTips"),l=t("../../CameraCtrl"),f=t("../../GameManager"),p=t("../../Player/PlayerCtrl"),h=t("../MapCtrl"),d=t("../TileGrid"),g=t("../TileTips"),y=cc._decorator,m=y.ccclass,_=y.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.sprite=[],e.state=3,e.id=1,e.remainCnt=0,e.timer=0,e}return r(e,t),Object.defineProperty(e.prototype,"grid",{get:function(){return h.default.Ins.getGrid(p.default.Ins.nearestCrdTo(this.grids.map(function(t){return t.crd})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grids",{get:function(){var t=[];return t.push(h.default.Ins.getGrid(this.centerCrd)),t.push(h.default.Ins.getGrid(this.centerCrd.add(cc.v2(1,0)))),t.push(h.default.Ins.getGrid(this.centerCrd.add(cc.v2(1,1)))),t.push(h.default.Ins.getGrid(this.centerCrd.add(cc.v2(0,1)))),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerPos",{get:function(){var t=cc.v2(),e=this.grids;return e.forEach(function(e){t.addSelf(h.default.Ins.crd2lp(e.crd))}),t.div(e.length)},enumerable:!1,configurable:!0}),e.prototype.isCrdInArea=function(t){return!!this.grids.find(function(e){return e.crd.equals(t)})},Object.defineProperty(e.prototype,"isBlockMove",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlockVisual",{get:function(){return!1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cfg",{get:function(){return config.BigOre.getById(this.id)},enumerable:!1,configurable:!0}),e.prototype.init=function(t){this.centerCrd=t,this.node.position=cc.v3(this.centerPos),this.remainCnt=this.cfg.digCnt,h.default.Ins.getGrid(this.centerCrd).on(d.EGridEvent.Explored,this.refresh,this),this.refresh()},e.prototype.clear=function(){h.default.Ins.getGrid(this.centerCrd).off(d.EGridEvent.Explored,this.refresh,this)},e.prototype.refresh=function(){var t=h.default.Ins.getGrid(this.centerCrd),e=Math.ceil(this.remainCnt/this.cfg.digCnt*3);e=Math.min(this.sprite.length-1,e),this.state!=e&&a.default.shakeNode(this.node,{amp:1.5}),this.state=e,this.img.spriteFrame=this.sprite[this.state],this.img.enabled=t.isExplored},e.prototype.onClick=function(){p.default.Ins.moveToDig(this)},e.prototype.digged=function(t){var e=this;if(t<this.cfg.threshold)return c.default.getUI(u.default).setTxt("\u9700\u8981"+this.cfg.threshold+"\u9550\u529b"),p.EDigRet.Fail;if(this.remainCnt<=0){var n=h.default.Ins.getGrid(this.centerCrd);return g.default.Ins.setTips(n,cc.v2(15,15),"\u9700\u8981"+this.cfg.refreshTime+"s\u5b8c\u5168\u6062\u590d",3),p.EDigRet.Fail}this.timer=0,this.remainCnt--,s.SoundManager.playEffect(Math.random()<.5?s.SoundType.Dig:s.SoundType.Dig2),a.default.shakeNode(this.node,{amp:2}),l.default.Ins.shake(2);for(var o=this.cfg.dropsNum,r=h.default.Ins.findEmptyGrids(this.centerCrd,o),i=function(t){g.default.Ins.flyIcon2(f.cfg.dropsId,f.centerPos,h.default.Ins.crd2lp(r[t].crd),function(){h.default.Ins.createDrops(r[t],e.cfg.dropsId,1)},!1)},f=this,d=0;d<o;d++)i(d);return this.refresh(),this.remainCnt<=0?p.EDigRet.Finish:p.EDigRet.Common},e.prototype.update=function(t){if(t*=f.default.Ins.timeScale,this.remainCnt<this.cfg.digCnt){var e=this.cfg.refreshTime/this.cfg.digCnt;this.timer+=t,this.timer>=e&&(this.timer-=e,this.remainCnt++,this.refresh())}},i([_(cc.SpriteFrame)],e.prototype,"sprite",void 0),i([_(cc.Sprite)],e.prototype,"img",void 0),i([_],e.prototype,"id",void 0),i([m],e)}(cc.Component);n.default=v,cc._RF.pop()},{"../../../Managers/EffectManager":"EffectManager","../../../Managers/SoundManager":"SoundManager","../../../UI/UI":"UI","../../../UI/U_TaskTips":"U_TaskTips","../../CameraCtrl":"CameraCtrl","../../GameManager":"GameManager","../../Player/PlayerCtrl":"PlayerCtrl","../MapCtrl":"MapCtrl","../TileGrid":"TileGrid","../TileTips":"TileTips"}],MiniMapMgr:[function(t,e,n){"use strict";cc._RF.push(e,"b8ba52MHGxLoKAmSG+Njt/9","MiniMapMgr");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.EMiniMapMsgType=n.EMiniMapEvent=void 0;var s,c,u=t("../Controller/Map/MapCtrl"),l=t("../Managers/EventCenter"),f=cc._decorator,p=f.ccclass;f.property,function(t){t.newMsg="newMsg",t.signChange="signChange",t.unlockRegion="unlockRegion"}(s=n.EMiniMapEvent||(n.EMiniMapEvent={})),function(t){t[t.none=0]="none",t[t.newSign=1]="newSign"}(c=n.EMiniMapMsgType||(n.EMiniMapMsgType={}));var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.newMsgType=c.none,e.signMap=new Set,e}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return this.instance||(this.instance=new n),this.instance},enumerable:!1,configurable:!0}),e.prototype.isCanTeleport=function(t){var e=u.default.Ins.getRegionById(t);return!!e.isHeartRegion||!!(e.isUnlock&&e.teleport&&e.teleport.isFinish)||void 0},e.prototype.signToRegion=function(t){this.signMap.add(t),this.newMsgType=c.newSign,n.send(s.newMsg)},e.prototype.clearSign=function(t){this.signMap.delete(t),n.send(s.signChange)},e.prototype.clearMsg=function(){this.newMsgType=c.none},e.send=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];l.default.send.apply(l.default,a([t],e))},e.on=function(t,e,n){l.default.on(t,e,n)},e.once=function(t,e,n){l.default.once(t,e,n)},e.off=function(t,e,n){l.default.off(t,e,n)},n=i([p],e)}(cc.Component);n.default=h,cc._RF.pop()},{"../Controller/Map/MapCtrl":"MapCtrl","../Managers/EventCenter":"EventCenter"}],MonsterAttack:[function(t,e,n){"use strict";cc._RF.push(e,"4c0cbVJGshPCLQTW9rdRDgn","MonsterAttack");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../Player/PlayerCtrl"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onEnter=function(){var t=i.default.Ins.curCrd.sub(this.monster.curCrd);this.monster.changeDir(t),this.monster.attack_targetGrids=this.monster.getAttackGrids(),this.monster.playAnimation("attack")},e}(t("./MonsterStateBase").default);n.default=a,cc._RF.pop()},{"../../Player/PlayerCtrl":"PlayerCtrl","./MonsterStateBase":"MonsterStateBase"}],MonsterChase:[function(t,e,n){"use strict";cc._RF.push(e,"7c5956uDehDW5+OtVVWQb+H","MonsterChase");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../Player/PlayerCtrl"),a=t("../Monster"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onEnter=function(){var t=this;this.monster.isReadyToAttack()?this.monster.switchState(a.EMonsterState.Attack):(i.default.Ins.on(i.EPlayerEvent.PlayerMoveCrd,this.onPlayerMove,this),this.monster.moveTo(i.default.Ins.curCrd,function(){return t.monster.switchState(a.EMonsterState.Idle)},this.onGetCrd.bind(this)))},e.prototype.onExit=function(){i.default.Ins.off(i.EPlayerEvent.PlayerMoveCrd,this.onPlayerMove,this),this.monster.stopMove()},e.prototype.onUpdate=function(){},e.prototype.onGetCrd=function(){this.monster.isReadyToAttack()&&this.monster.switchState(a.EMonsterState.Attack)},e.prototype.onPlayerMove=function(){var t=this;this.monster.isReadyToAttack()?this.monster.switchState(a.EMonsterState.Attack):this.monster.moveTo(i.default.Ins.curCrd,function(){return t.monster.switchState(a.EMonsterState.Idle)},this.onGetCrd.bind(this))},e}(t("./MonsterStateBase").default);n.default=s,cc._RF.pop()},{"../../Player/PlayerCtrl":"PlayerCtrl","../Monster":"Monster","./MonsterStateBase":"MonsterStateBase"}],MonsterDead:[function(t,e,n){"use strict";cc._RF.push(e,"39531lTzelKxKXFxhhZD+GZ","MonsterDead");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onEnter=function(){this.monster.playAnimation("dead")},e}(t("./MonsterStateBase").default);n.default=i,cc._RF.pop()},{"./MonsterStateBase":"MonsterStateBase"}],MonsterIdle:[function(t,e,n){"use strict";cc._RF.push(e,"52e28JkOkZBO5LBdMULqU9E","MonsterIdle");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../Monster"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timer=0,e.idleTime=0,e.randomStaticTime=0,e}return r(e,t),e.prototype.onEnter=function(){this.monster.playAnimation("idle"),this.timer=0;var t=config.MonsterCfg.config.idleTime[1],e=config.MonsterCfg.config.idleTime[0];this.idleTime=Math.random()*(t-e)+e,this.randomStaticTime=1*Math.random()},e.prototype.onUpdate=function(t){this.timer+=t,this.timer>this.randomStaticTime&&(this.timer>=this.idleTime?this.monster.switchState(i.EMonsterState.Patrol):this.monster.isFindPlayer()&&this.monster.switchState(i.EMonsterState.Chase))},e}(t("./MonsterStateBase").default);n.default=a,cc._RF.pop()},{"../Monster":"Monster","./MonsterStateBase":"MonsterStateBase"}],MonsterPatrol:[function(t,e,n){"use strict";cc._RF.push(e,"508ca4D4FlK/ILH23IXaxlw","MonsterPatrol");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../../Managers/MoveManager"),a=t("../../Map/MapCtrl"),s=t("../Monster"),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onEnter=function(){var t=this,e=a.default.Ins.findAllAreaGrid(this.monster.curCrd,config.MonsterCfg.config.patrolDist[0],config.MonsterCfg.config.patrolDist[1]);if(e&&0!=e.length){var n=e[Math.floor(Math.random()*e.length)];n||this.monster.switchState(s.EMonsterState.Idle),this.targetCrd=n.grid.crd,this.monster.moveTo(this.targetCrd,function(){return t.endMove()})}else this.monster.switchState(s.EMonsterState.Idle)},e.prototype.onUpdate=function(){this.monster.isFindPlayer()&&this.monster.switchState(s.EMonsterState.Chase)},e.prototype.endMove=function(){this.monster.switchState(s.EMonsterState.Idle)},e.prototype.onExit=function(){i.default.stopMove(this.monster)},e}(t("./MonsterStateBase").default);n.default=c,cc._RF.pop()},{"../../../Managers/MoveManager":"MoveManager","../../Map/MapCtrl":"MapCtrl","../Monster":"Monster","./MonsterStateBase":"MonsterStateBase"}],MonsterStateBase:[function(t,e,n){"use strict";cc._RF.push(e,"493d7f9jbRMDL4YT0DWKuRZ","MonsterStateBase");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,i=r.ccclass,a=(r.property,function(){function t(t){this.monster=null,this.monster=t}return t.prototype.onEnter=function(){},t.prototype.onUpdate=function(){},t.prototype.onExit=function(){},o([i],t)}());n.default=a,cc._RF.pop()},{}],Monster:[function(t,e,n){"use strict";cc._RF.push(e,"43e1fiapgdLp4WVWytSyKAv","Monster");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.MonsterInfo=n.EMonsterEvent=n.EMonsterState=void 0;var s,c,u=t("../../Managers/AnimationManager"),l=t("../../Managers/MoveManager"),f=t("../../Managers/PoolManager"),p=t("../../Managers/SoundManager"),h=t("../CameraCtrl"),d=t("../GameManager"),g=t("../Map/MapCtrl"),y=t("../Map/TileDrops"),m=t("../Map/TileGrid"),_=t("../Map/TileTips"),v=t("../Player/PlayerCtrl"),I=t("./MonsterState/MonsterAttack"),b=t("./MonsterState/MonsterChase"),C=t("./MonsterState/MonsterDead"),M=t("./MonsterState/MonsterIdle"),w=t("./MonsterState/MonsterPatrol"),P=cc._decorator,O=P.ccclass,T=P.property;(function(t){t[t.Idle=0]="Idle",t[t.Patrol=1]="Patrol",t[t.Chase=2]="Chase",t[t.Attack=3]="Attack",t[t.Dead=4]="Dead"})(s=n.EMonsterState||(n.EMonsterState={})),function(t){t.MoveCrd="moveCrd",t.Dead="dead"}(c=n.EMonsterEvent||(n.EMonsterEvent={}));var j=function(){function t(){this.hp=100,this.damage=20,this.speed=40}return t.prototype.reset=function(t){this.hp=t.hp,this.damage=t.damage,this.speed=t.speed},t}();n.MonsterInfo=j;var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchArea=null,e.whiteGhost=null,e.selectFrame=null,e.renderer=null,e.hurtEffect=null,e.hurtEffectRoot=null,e.appearEffect=null,e.info=new j,e.curStateEnum=s.Idle,e.drops=[],e.isInChest=!1,e.leftDir=!1,e.visibleTween=null,e.visible=!1,e.hurtTween=null,e.animFuncs=[],e.attack_targetGrids=[],e}return r(e,t),e.prototype.getNearestCrd=function(){return this.curCrd},Object.defineProperty(e.prototype,"cfg",{get:function(){return config.MonsterData.getById(this.monsterId)},enumerable:!1,configurable:!0}),e.prototype.setLayerPos=function(t){this.node.position=cc.v3(t)},e.prototype.getLayerPos=function(){return cc.v2(this.node.position)},Object.defineProperty(e.prototype,"region",{get:function(){return g.default.Ins.getRegionById(this.regionId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"animator",{get:function(){return this.getComponent(cc.Animation)},enumerable:!1,configurable:!0}),e.prototype.changeDir=function(t){t.x>0?this.leftDir=!1:t.x<0&&(this.leftDir=!0)},e.prototype.on=function(t,e,n,o){this.node.on(t,e,n,o)},e.prototype.once=function(t,e,n,o){this.node.once(t,e,n,o)},e.prototype.off=function(t,e,n,o){this.node.off(t,e,n,o)},e.prototype.emit=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(e=this.node).emit.apply(e,a([t],n))},e.prototype.onRegistState=function(){this.stateMap=new Map([[s.Idle,new M.default(this)],[s.Patrol,new w.default(this)],[s.Chase,new b.default(this)],[s.Attack,new I.default(this)],[s.Dead,new C.default(this)]])},e.prototype.init=function(t,e){this.onRegistState(),this.curCrd=e,this.setLayerPos(g.default.Ins.crd2lp(e)),this.switchState(s.Idle,!0),this.regionId=g.default.Ins.crd2RegionId(e),this.enterGrid(g.default.Ins.getGrid(e)),this.monsterId=t,this.info.reset(this.cfg)},e.prototype.addDrops=function(t,e,n){void 0===n&&(n=!1);var o=new y.default(t,e);this.drops.push(o),this.isInChest=n},e.prototype.updateCrd=function(t){var e=g.default.Ins.getGrid(this.curCrd);this.curCrd=t;var n=g.default.Ins.getGrid(this.curCrd);this.emit(c.MoveCrd,t),this.exitGrid(e),this.enterGrid(n),n.emit(m.EGridEvent.MonsterMove)},e.prototype.enterGrid=function(t){t.on(m.EGridEvent.PlayerAtk,this.hurt,this),t.on(m.EGridEvent.Visible,this.onVisible,this),t.on(m.EGridEvent.Invisible,this.onInvisible,this),t.addTouchable(this),t.state==m.EGridState.Visible?this.onVisible():this.onInvisible()},e.prototype.exitGrid=function(t){t.off(m.EGridEvent.PlayerAtk,this.hurt,this),t.off(m.EGridEvent.Visible,this.onVisible,this),t.off(m.EGridEvent.Invisible,this.onInvisible,this),t.removeTouchable(this)},e.prototype.onVisible=function(){this.renderer.enabled=!0,this.visible||(this.appearEffect.opacity=255,this.visibleTween&&this.visibleTween.stop(),this.visibleTween=cc.tween(this.appearEffect).to(.5,{opacity:0}).start()),this.visible=!0},e.prototype.onInvisible=function(){this.renderer.enabled=!1,this.visible&&this.visibleTween&&this.visibleTween.stop(),this.visible=!1},e.prototype.hurt=function(t,e,n){var o=this;p.SoundManager.playEffect(p.SoundType.Hit),t*=n?2:1,this.info.hp-=t,this.whiteGhost.node.opacity=255,this.hurtTween&&this.hurtTween.stop(),this.hurtEffect.play("monsterHurt"),_.default.Ins.setDamageText(cc.v2(this.node.position.add(this.damagePos.position)),t,n),this.hurtTween=cc.tween(this.whiteGhost.node).delay(.2).call(function(){o.whiteGhost.node.opacity=0,o.hurtTween=null}).start(),d.default.Ins.pauseFrame(8),h.default.Ins.scaled(1.01,.07);for(var r=[cc.v2(1,1),cc.v2(0,1),cc.v2(-1,1),cc.v2(-1,0),cc.v2(-1,-1),cc.v2(0,-1),cc.v2(1,-1),cc.v2(1,0)],i=0;i<r.length;i++)if(e.equals(r[i])){this.hurtEffectRoot.angle=45*-i;break}this.info.hp<=0&&this.die()},e.prototype.clear=function(){l.default.stopMove(this),this.exitGrid(g.default.Ins.getGrid(this.curCrd)),this.drops=[],f.PoolManager.PutPrefab(this.node)},e.prototype.die=function(){l.default.stopMove(this),this.exitGrid(g.default.Ins.getGrid(this.curCrd)),this.switchState(s.Dead),this.emit(c.Dead,this)},e.prototype.switchState=function(t,e){var n,o;void 0===e&&(e=!1),(this.curStateEnum!=t||e)&&(null===(n=this.curState)||void 0===n||n.onExit(),this.curState=this.stateMap.get(t),this.curStateEnum=t,null===(o=this.curState)||void 0===o||o.onEnter())},e.prototype.playAnimation=function(t,e){void 0===e&&(e=[]),u.AM.play(this.animator,t),this.animFuncs=e},e.prototype.A_Event=function(t){t=t||0,this.animFuncs&&this.animFuncs.length>t&&this.animFuncs[t]()},e.prototype.A_EndDead=function(){var t=this;if(this.isInChest){var e=g.default.Ins.createChest(g.default.Ins.getGrid(this.curCrd));this.drops.forEach(function(t){e.addDrops(t.resId,t.num)})}else this.drops.forEach(function(e){return g.default.Ins.createDrops(g.default.Ins.getGrid(t.curCrd),e.resId,e.num)});this.drops=[],f.PoolManager.PutPrefab(this.node)},e.prototype.update=function(t){t*=d.default.Ins.timeScale,this.curState.onUpdate(t),this.whiteGhost.spriteFrame=this.renderer.spriteFrame,this.whiteGhost.node.scaleX=this.renderer.node.scaleX=this.leftDir?1:-1},e.prototype.isInTouchArea=function(t){var e=this.touchArea.x-this.touchArea.width/2,n=this.touchArea.x+this.touchArea.width/2,o=this.touchArea.y-this.touchArea.height/2,r=this.touchArea.y+this.touchArea.height/2,i=this.node.convertToNodeSpaceAR(t);return i.x>=e&&i.x<=n&&i.y>=o&&i.y<=r},e.prototype.onTouch=function(){v.default.Ins.fightWith(this)},e.prototype.select=function(){this.selectFrame.active=!0},e.prototype.cancelSelect=function(){this.selectFrame.active=!1},e.prototype.getCrdDistFromPlayer=function(){var t=v.default.Ins.curCrd;return Math.abs(t.x-this.curCrd.x)+Math.abs(t.y-this.curCrd.y)},Object.defineProperty(e.prototype,"isTooFar",{get:function(){return!g.default.Ins.getRegionByCrd(this.curCrd).Active},enumerable:!1,configurable:!0}),e.prototype.moveTo=function(t,e,n){var o=this;l.default.moveTo(this,this.info.speed,this.curCrd,t,function(t){return o.changeDir(t)},function(){return e&&e()},null,function(t){o.updateCrd(t),n&&n()})},e.prototype.stopMove=function(){l.default.stopMove(this)},e.prototype.A_Attack=function(){var t=this;this.attack_targetGrids.forEach(function(e){return e.emit(m.EGridEvent.MonsterAtk,t,t.info.damage)})},e.prototype.A_EndAttack=function(){this.switchState(s.Idle)},e.prototype.A_WarnAttack=function(){this.attack_targetGrids.forEach(function(t){return _.default.Ins.warnGrid(t,1)})},i([T(cc.Node)],e.prototype,"damagePos",void 0),i([T(cc.Node)],e.prototype,"touchArea",void 0),i([T(cc.Sprite)],e.prototype,"whiteGhost",void 0),i([T(cc.Node)],e.prototype,"selectFrame",void 0),i([T(cc.Sprite)],e.prototype,"renderer",void 0),i([T(cc.Animation)],e.prototype,"hurtEffect",void 0),i([T(cc.Node)],e.prototype,"hurtEffectRoot",void 0),i([T(cc.Node)],e.prototype,"appearEffect",void 0),i([O],e)}(cc.Component);n.default=k,cc._RF.pop()},{"../../Managers/AnimationManager":"AnimationManager","../../Managers/MoveManager":"MoveManager","../../Managers/PoolManager":"PoolManager","../../Managers/SoundManager":"SoundManager","../CameraCtrl":"CameraCtrl","../GameManager":"GameManager","../Map/MapCtrl":"MapCtrl","../Map/TileDrops":"TileDrops","../Map/TileGrid":"TileGrid","../Map/TileTips":"TileTips","../Player/PlayerCtrl":"PlayerCtrl","./MonsterState/MonsterAttack":"MonsterAttack","./MonsterState/MonsterChase":"MonsterChase","./MonsterState/MonsterDead":"MonsterDead","./MonsterState/MonsterIdle":"MonsterIdle","./MonsterState/MonsterPatrol":"MonsterPatrol"}],MoveManager:[function(t,e,n){"use strict";cc._RF.push(e,"2de0bAU96lEr59BsJfFgAap","MoveManager");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Controller/GameManager"),s=t("../Controller/Map/MapCtrl"),c=t("../UI/UI"),u=t("../UI/U_TaskTips"),l=cc._decorator,f=l.ccclass,p=(l.property,function(){function t(t){this.node=null,this.node=t}return t.prototype.tick=function(){return!0},t.prototype.end=function(){},t.prototype.stop=function(){},t.prototype.start=function(){},t}()),h=function(t){function e(e,n,o,r,i,a){var s=t.call(this,e)||this;return s.startPos=null,s.endPos=null,s.time=0,s.timer=0,s.startPos=r,s.endPos=i,s.time=n,s.easing=o,s.endCall=a,s}return r(e,t),e.prototype.start=function(){this.timer=0},e.prototype.tick=function(t){if(this.timer+=t,this.timer>=this.time)return this.node.setLayerPos(this.endPos),!0;var e=cc.Vec2.lerp(cc.v2(),this.startPos,this.endPos,this.easing(this.timer/this.time));return this.node.setLayerPos(e),!1},e.prototype.end=function(){this.node.setLayerPos(this.endPos),this.endCall&&this.endCall(this.endPos)},e}(p),d=function(t){function e(e,n,o,r,i,a,c,u){var l=t.call(this,e)||this;return l.path=null,l.speed=0,l._pathIdx=0,l.path=s.default.Ins.findPathByDir8(o,r),l.tickCall=i,l.endCall=a,l.cancelCall=c,l.getCrdCall=u,l.speed=n,l._pathIdx=-1,l}return r(e,t),e.prototype.tick=function(t){var e=function(t){return s.default.Ins.crd2lp(t)};if(-1==this._pathIdx){if(this._targetPos=e(this.path.startCrd),this.path.pathCrds.length>1){var n=this._curPos,o=e(this.path.pathCrds[1]);cc.Vec2.dot(this._targetPos.sub(n),o.sub(n))<=0&&(this._targetPos=o,this._pathIdx=0)}}else{if(this._pathIdx>=this.path.pathCrds.length-1)return!0;this._targetPos=e(this.path.pathCrds[this._pathIdx+1])}var r=this._targetPos.sub(this._startPos).normalize();this.tickCall&&this.tickCall(r);var i=this.node.getLayerPos().add(r.mul(t*this.speed));return cc.Vec2.dot(r,this._targetPos.sub(i))<=0?(this._pathIdx++,this._startPos=this._targetPos,this.node.setLayerPos(this._targetPos),this.getCrdCall&&this.getCrdCall(this.path.pathCrds[this._pathIdx])):this.node.setLayerPos(i),!1},e.prototype.start=function(){this._pathIdx=-1,this._startPos=this.node.getLayerPos(),this._curPos=this.node.getLayerPos(),this._nextPos=cc.v2(),this._targetPos=cc.v2()},e.prototype.end=function(){this.node.setLayerPos(s.default.Ins.crd2lp(this.path.endCrd)),this.endCall&&this.endCall(this.path.endCrd)},e.prototype.stop=function(){this.cancelCall&&this.cancelCall(this.node.getLayerPos())},e}(p),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r(e,t),n=e,e.moveTo=function(t,e,o,r,i,a,s,l){n.map.has(t)&&n.map.delete(t);var f=new d(t,e,o,r,i,a,s,l);if(f.path.isEmpty)return c.default.getUI(u.default).setTxt("\u65e0\u6cd5\u5230\u8fbe"),void(f.cancelCall&&f.cancelCall(t.getLayerPos()));this.map.set(t,f),f.start()},e.directTo=function(t,e,o,r,i,a){n.map.has(t)&&n.map.delete(t);var s=new h(t,e,o,r,i,a);this.map.set(t,s),s.start()},e.stopMove=function(t){var e=n.map.get(t);e&&(e.stop(),n.map.delete(t))},e.prototype.update=function(t){t*=a.default.Ins.timeScale;var e=n.map,o=[];e.forEach(function(e){e.tick(t)&&o.push(e)}),o.forEach(function(t){t.end(),n.map.delete(t.node)})},e.map=new Map,n=i([f],e)}(cc.Component);n.default=g,cc._RF.pop()},{"../Controller/GameManager":"GameManager","../Controller/Map/MapCtrl":"MapCtrl","../UI/UI":"UI","../UI/U_TaskTips":"U_TaskTips"}],MyListCom:[function(t,e,n){"use strict";cc._RF.push(e,"8a7c7pokIlMYq0Dx9MBaS4p","MyListCom");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Managers/PoolManager"),s=cc._decorator,c=s.ccclass,u=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemPrefab=null,e._numItems=0,e}return r(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this.getComponent(cc.Layout)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numItems",{get:function(){return this._numItems},set:function(t){var e=this;this._numItems=t;for(var n=[],o=0,r=function(t,n){e.itemRenderer&&e.itemRenderer(t,n)},i=0;i<this.content.node.childrenCount;i++){var s=this.content.node.children[i];o<this._numItems?o++:n.push(s)}for(i=o;i<this._numItems;i++){var c=a.PoolManager.GetPrefab(this.itemPrefab);c.setParent(this.content.node),r(c,o)}for(n.forEach(function(t){return a.PoolManager.PutPrefab(t)}),i=0;i<this.content.node.childrenCount;i++)r(s=this.content.node.children[i],i);var u=this.itemPrefab.data.height,l=this.content.spacingY,f=this.itemPrefab.data.width,p=this.content.spacingX;this.content.type==cc.Layout.Type.VERTICAL?this.content.node.height=this._numItems*(u+l)-l:this.content.type==cc.Layout.Type.HORIZONTAL&&(this.content.node.width=this._numItems*(f+p)-p)},enumerable:!1,configurable:!0}),i([u(cc.Prefab)],e.prototype,"itemPrefab",void 0),i([c],e)}(cc.Component);n.default=l,cc._RF.pop()},{"../../Managers/PoolManager":"PoolManager"}],NumberFormatter:[function(t,e,n){"use strict";cc._RF.push(e,"1259cUZEwJKm4+TjhlPw7Fx","NumberFormatter"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(){}return Object.defineProperty(t,"locale",{get:function(){return t.m_locale},set:function(e){t.m_locale=e},enumerable:!1,configurable:!0}),t.format=function(t,e,n){void 0===e&&(e=0),void 0===n&&(n=!1);var o=0,r=Math.pow(10,e),i=Math.round(r*t)/r,a=-1==i.indexOf("."),s=a?i.length:i.indexOf("."),c=(a&&!e?"":n?",":".")+i.substr(s+1);if(e)for(var u=0;u<=e-(i.length-(a?s-1:s));u++)c+="0";for(;o+3<("-"==i.substr(0,1)?s-1:s);)c=(n?".":",")+i.substr(s-(o+=3),3)+c;return i.substr(0,s-o)+c},t.formatRound=function(e){if(null==e)return"0";if(e=e,"en_US"==t.locale||"vi_VN"==t.locale)return t.formatEngNumber(e);var n;switch(t.locale){case"zh_CN":n=["\u4ebf","\u4e07"];break;case"zh_TW":n=["\u5104","\u842c"];break;case"ja_JP":n=["\u5104","\u4e07"];break;case"ko_KR":n=["\uc5b5","\ub9cc"];break;default:n=[]}if(n.length>0){if(e>=1e8)return Math.floor(e/1e8)+n[0];if(e>=1e5)return Math.floor(e/1e4)+n[1]}return e.toString()},t.formatTime=function(t,e,n){if(void 0===e&&(e=!1),void 0===n&&(n=!1),isNaN(t)||t<=0)return"00:00";var o=Math.ceil(t/1e3),r=0,i="";n&&(o-=86400*(r=Math.floor(o/3600/24)),i=r+(e?"\u5929":":"));var a=Math.floor(o/3600);o-=3600*a;var s=Math.floor(o/60);return o-=60*s,i+(this.formatTimeNumber(a)+(e?"\u5c0f\u65f6":":"))+this.formatTimeNumber(s)+(e?"\u5206":":")+this.formatTimeNumber(o)+(e?"\u79d2":"")},t.formatTimeHm=function(t,e){if(void 0===e&&(e=!1),isNaN(t)||t<=0)return"00:00";var n=Math.ceil(t/1e3),o=Math.floor(n/3600);n-=3600*o;var r=Math.ceil(n/60);return(e?o>0?o+"h":"":this.formatTimeNumber(o)+":")+(e?r>0?r+"m":"":this.formatTimeNumber(r))},t.formatTimeMs=function(t,e){if(void 0===e&&(e=!1),isNaN(t)||t<=0)return"00:00";var n=Math.ceil(t/1e3),o=Math.floor(n/60);return n-=60*o,(e?o>0?o+"m":"":this.formatTimeNumber(o)+":")+(e?n>0?n+"s":"":this.formatTimeNumber(n))},t.formatTimeNumber=function(t){return t<10?"0"+t:t.toString()},t.formatEngNumber=function(e){var n,o;return(e=e)>=1e9?(o=e/1e9,n=(.01*Math.floor(o/.01)).toFixed(2),t.formatEndingZero(n)+"B"):e>=1e6?(o=e/1e6,n=(.01*Math.floor(o/.01)).toFixed(2),t.formatEndingZero(n)+"M"):e>=1e3?(o=e/1e3,n=(.01*Math.floor(o/.01)).toFixed(2),t.formatEndingZero(n)+"K"):e+""},t.formatEndingZero=function(e){return t.endWith(e,"00")?e.substring(0,e.length-3):t.endWith(e,"0")?e.substring(0,e.length-1):e},t.endWith=function(t,e){return e==t.substring(t.length-e.length)},t.m_locale="zh_CN",t}();n.default=o,cc._RF.pop()},{}],ObjStruct:[function(t,e,n){"use strict";cc._RF.push(e,"8e7faU/fydKdpWbID3qsExT","ObjStruct"),Object.defineProperty(n,"__esModule",{value:!0});n.default=function(t){this.grids=[],this.grids=t},cc._RF.pop()},{}],Operator:[function(t,e,n){"use strict";cc._RF.push(e,"e0da9trFCFFAbSFvg/naXpq","Operator");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ETaskErrorCode=void 0;var a=t("./Controller/CameraCtrl"),s=t("./Controller/Map/MapCtrl"),c=t("./Controller/Map/Region"),u=t("./Controller/Map/TileGrid"),l=t("./Controller/Map/TileObjects/BlockObj"),f=t("./Controller/Map/TileTips"),p=t("./Controller/Player/PlayerCtrl"),h=t("./Controller/ScreenEffectMask"),d=t("./Controller/TouchCtrl/MainTouchCtrl"),g=t("./Factory"),y=t("./Managers/EventCenter"),m=t("./Managers/SoundManager"),_=t("./Mgr/MiniMapMgr"),v=t("./Model/Inventory"),I=t("./UI/FairyUI/U_HUD"),b=t("./UI/FairyUI/U_MapWindow"),C=t("./UI/UI"),M=t("./UI/U_Boardcast"),w=t("./UI/U_TaskTips"),P=t("./Utils/CocosExtension"),O=cc._decorator,T=O.ccclass;O.property,function(t){t.NoError="no error",t.NoObject="\u6b64\u683c\u65e0\u77f3\u5757\u53ef\u6316",t.Unexplored="\u6b64\u683c\u672a\u63a2\u7d22",t.LowPickaxeLevel="\u9550\u5b50\u7b49\u7ea7\u4e0d\u591f",t.LowWeaponLevel="\u6b66\u5668\u7b49\u7ea7\u4e0d\u591f\u65e0\u6cd5\u653b\u51fb\u5899\u540e\u7684\u602a\u7269",t.NoMatchWeaponMonster="\u6b66\u5668\u65e0\u6cd5\u653b\u51fb\u5899\u540e\u7684\u602a\u7269",t.NoWeapon="\u6ca1\u6709\u6b66\u5668\u65e0\u6cd5\u653b\u51fb\u5899\u540e\u7684\u602a\u7269",t.LackMaterial="\u6750\u6599\u4e0d\u8db3",t.LackExplorePoint="\u63a2\u7d22\u70b9\u4e0d\u8db3",t.LackCopperKey="\u7f3a\u5c11\u94dc\u94a5\u5319",t.LackSliverKey="\u7f3a\u5c11\u94f6\u94a5\u5319",t.LackGoldKey="\u7f3a\u5c11\u91d1\u94a5\u5319",t.NoArrivable="\u4e0d\u53ef\u8fbe"}(n.ETaskErrorCode||(n.ETaskErrorCode={}));var j=function(){function t(){}var e;return e=t,t.canDig=function(t){return r(this,void 0,void 0,function(){var e,n,o,r;return i(this,function(){if(!t||!t.object)return C.default.getUI(w.default).setTxt("\u6ca1\u6709\u7269\u4f53\u53ef\u6316"),[2,!1];if(t.state==u.EGridState.Unexplored)return C.default.getUI(w.default).setTxt("\u672a\u63a2\u7d22"),[2,!1];if(v.default.Ins.pickaxe.pickaxeCfg.power<t.object.blockCfg.threshold){for(e=t.object,n=config.Pickaxe.list,o=null,r=0;r<n.length;r++)if(n[r].power>=e.blockCfg.threshold){o=n[r];break}return null==o?C.default.getUI(w.default).setTxt("\u9550\u529b\u9700\u8981\u8fbe\u5230"+e.blockCfg.threshold):C.default.getUI(w.default).setTxt("\u81f3\u5c11\u9700\u8981"+config.Item.getById(o.resId).name),[2,!1]}return[2,!0]})})},t.applyDig=function(t,e){s.default.Ins.clearObj(t),a.default.Ins.shake(),e&&e()},t.enterStory=function(){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return C.default.getUI(I.default).fadeOut(),p.default.Ins.invincible=!0,[4,h.default.Ins.enterStory()];case 1:return t.sent(),[2]}})})},t.exitStory=function(){return r(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return[4,h.default.Ins.exitStory()];case 1:return t.sent(),p.default.Ins.invincible=!1,C.default.getUI(I.default).fadeIn(),[2]}})})},t.applyOpenDoor=function(t){return r(this,void 0,void 0,function(){var e,n,o,r,a,u,l,p,m,v,M,O,T;return i(this,function(i){switch(i.label){case 0:return e=t.doorCfg.keyId,n=config.Item.getById(e),o=t.grid,this.reduceByList([e],[1]),d.default.Ins.blockTouch(),C.default.getUI(w.default).setTxt("\u6d88\u8017\u4e00\u628a"+n.name),C.default.getUI(I.default).fadeOut(),f.default.Ins.hideDoorTips(o),r=!!t.doorCfg.isHorizontal,[4,s.default.Ins.focusToCrdAsync(o.crd)];case 1:return i.sent(),[4,h.default.Ins.enterStory()];case 2:return i.sent(),[4,P.delay(1e3)];case 3:return i.sent(),y.default.send(y.E_OpenDoor,t),o.clearObj(),s.default.Ins.exploreGrid(o),[4,f.default.Ins.showOpenTheDoor(o,"door1")];case 4:return i.sent(),a=g.default.getTileObjectByGid(t.doorCfg.openGid),o.setObj(a),[4,P.delay(500)];case 5:return i.sent(),r?(u=o.crd.add(cc.v2(-1,0)),l=o.crd.add(cc.v2(1,0)),p=s.default.Ins.getRegionByCrd(u),m=s.default.Ins.getRegionByCrd(l),p.curState!=c.ERegionState.Sleep?[3,7]:[4,C.default.getUI(b.default).showUnlockRegion(p.id)]):[3,10];case 6:i.sent(),_.default.send(_.EMiniMapEvent.unlockRegion,p.id),i.label=7;case 7:return p.unlockRegion(),m.curState!=c.ERegionState.Sleep?[3,9]:[4,C.default.getUI(b.default).showUnlockRegion(m.id)];case 8:i.sent(),_.default.send(_.EMiniMapEvent.unlockRegion,m.id),i.label=9;case 9:return m.unlockRegion(),[3,15];case 10:return v=o.crd.add(cc.v2(0,-1)),M=o.crd.add(cc.v2(0,1)),O=s.default.Ins.getRegionByCrd(v),T=s.default.Ins.getRegionByCrd(M),O.curState!=c.ERegionState.Sleep?[3,12]:[4,C.default.getUI(b.default).showUnlockRegion(O.id)];case 11:i.sent(),i.label=12;case 12:return O.unlockRegion(),T.curState!=c.ERegionState.Sleep?[3,14]:[4,C.default.getUI(b.default).showUnlockRegion(T.id)];case 13:i.sent(),i.label=14;case 14:T.unlockRegion(),i.label=15;case 15:return C.default.getUI(I.default).fadeIn(),[4,s.default.Ins.returnToPlayer()];case 16:return i.sent(),[4,h.default.Ins.exitStory()];case 17:return i.sent(),d.default.Ins.unblockTouch(),[2]}})})},t.isEnoughByList=function(t,e){for(var n=0;n<t.length;n++){var o=e[n];if(v.default.Ins.findResNum(t[n])<o)return!1}return!0},t.reduceByList=function(t,e){for(var n=0;n<t.length;n++){var o=e[n];v.default.Ins.loseItem(t[n],o)}},t.addMoney=function(t){v.default.Ins.addMoney(t)},t.costMoney=function(t){v.default.Ins.addMoney(-t)},t.consumeCraftMat=function(t){for(var e=config.Craft.getById(t),n=0;n<e.matId.length;n++){var o=e.matId[n],r=e.matNum[n];v.default.Ins.loseItem(o,r)}},t.consumePickaxe=function(){var t,e=v.default.Ins.pickaxe;e.pickaxeCfg.duration>0&&(C.default.getUI(I.default).warnPickaxe(),e.duration<7&&C.default.getUI(w.default).setTxt("\u9550\u5b50\u5373\u5c06\u635f\u574f")),v.default.Ins.consumePickaxe(1)&&(null===(t=C.default.getUI(w.default))||void 0===t||t.setTxt(e.cfg.name+"\u5df2\u5230\u671f"))},t.consumeWeapon=function(){var t,e=v.default.Ins.weapon;e.weaponCfg.duration>0&&(C.default.getUI(I.default).warnWeapon(),e.duration<7&&C.default.getUI(w.default).setTxt("\u6b66\u5668\u5373\u5c06\u635f\u574f")),v.default.Ins.consumeWeapon(1)&&(null===(t=C.default.getUI(w.default))||void 0===t||t.setTxt(e.cfg.name+"\u5df2\u5230\u671f"))},t.consumeBuildMat=function(t){for(var e=config.Works.getById(t),n=0;n<e.matId.length;n++){var o=e.matId[n],r=e.matNum[n];v.default.Ins.loseItem(o,r)}},t.gainRes=function(t,e,n){var o=config.Item.getById(t);cc.Color.fromHEX(cc.color(),config.QualityColor.getById(o.quality).color),C.default.getUI(M.default).sendGetItem(t,e),v.default.Ins.getItem(t,e),n&&n()},t.useFood=function(t){return r(this,void 0,void 0,function(){var n,o,r,c,g,y,_,I,b;return i(this,function(i){switch(i.label){case 0:return"food"!=t.consumeCfg.type?[3,1]:(p.default.Ins.addEnergy(t.consumeCfg.energy),p.default.Ins.addHp(t.consumeCfg.heal),h.default.Ins.setMask(cc.Color.GREEN,1,150),m.SoundManager.playEffect(m.SoundType.Eat),v.default.Ins.loseItem(t.cfgId,1),[3,16]);case 1:if("bomb"!=t.consumeCfg.type)return[3,12];if(n=[],!(o=s.default.Ins.getGrid(p.default.Ins.curCrd)).isEmpty)return C.default.getUI(w.default).setTxt("\u8bf7\u5728\u7a7a\u5730\u4e0a\u653e\u7f6e\u70b8\u5f39"),[2];for(_=1;_<=t.consumeCfg.scale;_++)r=_,c=s.default.Ins.extNearGrids(o,r,function(e){if(e.object&&e.object instanceof l.default){if(e.object.blockCfg.threshold>t.consumeCfg.digPower)return!1}else if(e.isBlockMove)return!1;return!0}),n.push(c);for(g=function(t,e){for(var n=0;n<t.length;n++){var o=t[n];e.includes(o)&&(t.splice(n,1),n--)}},_=1;_<n.length;_++)g(n[_],n[_-1]);return y=f.default.Ins.setBombAnim(o,t.consumeCfg.bombAnim),v.default.Ins.loseItem(t.cfgId,1),[4,P.delay(1e3)];case 2:i.sent(),f.default.Ins.warnGrid(o,1),_=0,i.label=3;case 3:if(!(_<n.length))return[3,6];for(I=n[_],b=0;b<I.length;b++)f.default.Ins.warnGrid(I[b],1);return[4,P.delay(300)];case 4:i.sent(),i.label=5;case 5:return _++,[3,3];case 6:return[4,P.delay(1e3)];case 7:i.sent(),f.default.Ins.hideBombAnim(y),f.default.Ins.setBoomAnim(o),_=0,i.label=8;case 8:if(!(_<n.length))return[3,11];for(I=n[_],b=0;b<I.length;b++)I[b].emit(u.EGridEvent.PlayerAtk,t.consumeCfg.damage,I[b].crd.sub(o.crd),!1),I[b].emit(u.EGridEvent.EnvHurt,45,o.crd),I[b].exploded(t.consumeCfg.damage),f.default.Ins.setBoomAnim(I[b]);return a.default.Ins.shake(2),[4,P.delay(300)];case 9:i.sent(),i.label=10;case 10:return _++,[3,8];case 11:return[3,16];case 12:return"return"!=t.consumeCfg.type?[3,16]:(v.default.Ins.loseItem(t.cfgId,1),d.default.Ins.blockTouch(),[4,e.enterStory()]);case 13:return i.sent(),f.default.Ins.showTeleportTips(s.default.Ins.crd2lp(p.default.Ins.curCrd).sub(cc.v2(0,30))),p.default.Ins.Hero.hide(),[4,P.delay(1e3)];case 14:return i.sent(),p.default.Ins.teleportTo(s.default.Ins.spawnCrd),f.default.Ins.showTeleportTips(s.default.Ins.crd2lp(p.default.Ins.curCrd).sub(cc.v2(0,30))),p.default.Ins.Hero.show(),s.default.Ins.returnToPlayer(),[4,e.exitStory()];case 15:i.sent(),d.default.Ins.unblockTouch(),i.label=16;case 16:return[2]}})})},t.cnt=0,e=o([T],t)}();n.default=j,cc._RF.pop()},{"./Controller/CameraCtrl":"CameraCtrl","./Controller/Map/MapCtrl":"MapCtrl","./Controller/Map/Region":"Region","./Controller/Map/TileGrid":"TileGrid","./Controller/Map/TileObjects/BlockObj":"BlockObj","./Controller/Map/TileTips":"TileTips","./Controller/Player/PlayerCtrl":"PlayerCtrl","./Controller/ScreenEffectMask":"ScreenEffectMask","./Controller/TouchCtrl/MainTouchCtrl":"MainTouchCtrl","./Factory":"Factory","./Managers/EventCenter":"EventCenter","./Managers/SoundManager":"SoundManager","./Mgr/MiniMapMgr":"MiniMapMgr","./Model/Inventory":"Inventory","./UI/FairyUI/U_HUD":"U_HUD","./UI/FairyUI/U_MapWindow":"U_MapWindow","./UI/UI":"UI","./UI/U_Boardcast":"U_Boardcast","./UI/U_TaskTips":"U_TaskTips","./Utils/CocosExtension":"CocosExtension"}],PlantObj:[function(t,e,n){"use strict";cc._RF.push(e,"3efadTj6ThM/oJJMCfL7s7R","PlantObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../../UI/UI"),a=t("../../../UI/U_TaskTips"),s=t("../../Player/PlayerCtrl"),c=t("../MapCtrl"),u=t("../TileGrid"),l=t("../TileTips"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timer=0,e.isMature=!0,e}return r(e,t),e.prototype.getNearestCrd=function(){return this.grid.crd},e.prototype.select=function(){},e.prototype.cancelSelect=function(){},Object.defineProperty(e.prototype,"plantCfg",{get:function(){var t=this;return config.Plant.list.find(function(e){return e.objId==t.objId})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matureGid",{get:function(){return this.cfg.gid},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"immatureGid",{get:function(){return this.plantCfg.gid2},enumerable:!1,configurable:!0}),e.prototype.finishGrow=function(){this.isMature=!0,c.default.Ins.setTile(this.grid.crd,this.matureGid,c.ETileLayer.Object)},e.prototype.backGrow=function(){this.isMature=!1,this.timer=0,c.default.Ins.setTile(this.grid.crd,this.immatureGid,c.ETileLayer.Object)},e.prototype.init=function(e){t.prototype.init.call(this,e),this.grid.on(u.EGridEvent.PlayerAtk,this.onPlayerAtk,this)},e.prototype.clear=function(){t.prototype.clear.call(this),this.grid&&this.grid.off(u.EGridEvent.PlayerAtk,this.onPlayerAtk,this)},e.prototype.onPlayerAtk=function(){if(l.default.Ins.setTips(this.grid,cc.v2(0,15),this.plantCfg.time-Math.floor(this.timer)+"s",3),this.isMature){var t=this.plantCfg.numScale[0],e=this.plantCfg.numScale[1];c.default.Ins.createDrops(this.grid,this.plantCfg.rewardId,Math.floor(Math.random()*(e-t)+t)),this.backGrow()}},e.prototype.onUpdate=function(t){this.isMature||(this.timer+=t,this.timer>=this.plantCfg.time&&(this.timer=0,this.finishGrow()))},e.prototype.onClick=function(){var t=this,e=c.default.Ins.findCrdSideofObj(this.grid);e?s.default.Ins.moveToGrid(e,function(){return s.default.Ins.fightWith(t)}):i.default.getUI(a.default).setTxt("\u65e0\u6cd5\u5230\u8fbe")},e}(t("./TileObject").default);n.default=f,cc._RF.pop()},{"../../../UI/UI":"UI","../../../UI/U_TaskTips":"U_TaskTips","../../Player/PlayerCtrl":"PlayerCtrl","../MapCtrl":"MapCtrl","../TileGrid":"TileGrid","../TileTips":"TileTips","./TileObject":"TileObject"}],PlayerCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"1221748klJPipAQjIGckSl6","PlayerCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.EDigRet=n.EPlayerEvent=n.PlayerInfo=n.EPlayerState=void 0;var s,c=t("../../Managers/MoveManager"),u=t("../../Managers/SoundManager"),l=t("../../Model/Inventory"),f=t("../../Operator"),p=t("../../UI/UI"),h=t("../../UI/U_TaskTips"),d=t("../GameManager"),g=t("../HeroView"),y=t("../Map/MapCtrl"),m=t("../Map/TileGrid"),_=t("./PlayerDead"),v=t("./PlayerDig"),I=t("./PlayerFight"),b=t("./PlayerHurt"),C=t("./PlayerIdle"),M=t("./PlayerMove"),w=cc._decorator,P=w.ccclass,O=w.property;(function(t){t.Dig="Dig",t.Move="Move",t.Fight="Fight",t.Idle="Idle",t.Hurt="Hurt",t.Dead="Dead"})(s=n.EPlayerState||(n.EPlayerState={}));var T,j=function(){this.hp=100,this.maxHp=100,this.damage=1,this.food=100,this.light=2.5,this.crit=.1,this.moveSpeed=100,this.digPower=25,this.digSpeed=1};n.PlayerInfo=j,function(t){t.PlayerMoveCrd="PlayerMoveCrd"}(T=n.EPlayerEvent||(n.EPlayerEvent={})),function(t){t[t.Common=0]="Common",t[t.Fail=1]="Fail",t[t.Finish=2]="Finish"}(n.EDigRet||(n.EDigRet={}));var k=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hero=null,e.stateMap=new Map([[s.Dig,new v.default(e)],[s.Fight,new I.default(e)],[s.Idle,new C.default(e)],[s.Move,new M.default(e)],[s.Hurt,new b.default(e)],[s.Dead,new _.default(e)]]),e.isDie=!1,e.invincible=!1,e.banInput=!1,e._info=new j,e.operateLock=!1,e.curStateEnum=s.Idle,e.lastAttackRange=[],e.move_isCrdMove=!0,e.attackDetectFlag=!1,e}var n;return r(e,t),n=e,Object.defineProperty(e.prototype,"Hero",{get:function(){return this.hero},enumerable:!1,configurable:!0}),e.prototype.on=function(t,e,n,o){this.node.on(t,e,n,o)},e.prototype.off=function(t,e,n,o){this.node.off(t,e,n,o)},e.prototype.emit=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(e=this.node).emit.apply(e,a([t],n))},Object.defineProperty(e.prototype,"info",{get:function(){return this._info},enumerable:!1,configurable:!0}),e.prototype.switchState=function(t,e){void 0===e&&(e=!1),this.curStateEnum!=t||e?(this.curState&&this.curState.onExit(),this.curStateEnum=t,this.curState=this.stateMap.get(t),this.curState.onEnter(),console.warn("player switch to "+t)):(this.curState.onRefresh(),console.warn("player refresh to "+t))},Object.defineProperty(e,"Ins",{get:function(){return n.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this},e.prototype.refreshAttackRange=function(){var t=this,e=this.getAttackableGrids();this.lastAttackRange.forEach(function(e){e.off(m.EGridEvent.MonsterMove,t.onMonsterMove,t)}),e.forEach(function(e){e.on(m.EGridEvent.MonsterMove,t.onMonsterMove,t)}),this.lastAttackRange=e},e.prototype.onMonsterMove=function(){this.attackDetectFlag=!0},e.prototype.updateCrd=function(t){if(console.log("update To",t.x,t.y),!this.curCrd.equals(t)){var e=y.default.Ins.getGrid(this.curCrd);this.curCrd=t;var n=y.default.Ins.getGrid(this.curCrd);this.exitGrid(e),this.enterGrid(n),this.refreshAttackRange();var o=y.default.Ins.getRegionByCrd(e.crd),r=y.default.Ins.getRegionByCrd(n.crd);o!=r&&(null==o||o.playerExit(),null==r||r.playerEnter())}},e.prototype.enterGrid=function(t){t.on(m.EGridEvent.MonsterAtk,this.onMonsterAtkGrid,this),t.on(m.EGridEvent.EnvHurt,this.onEnvAtkGrid,this),t.emit(m.EGridEvent.PlayerMove,t)},e.prototype.exitGrid=function(t){t.off(m.EGridEvent.MonsterAtk,this.onMonsterAtkGrid,this),t.off(m.EGridEvent.EnvHurt,this.onEnvAtkGrid,this),t.emit(m.EGridEvent.PlayerExit,t)},e.prototype.onMonsterAtkGrid=function(t,e){this.curState.onHurt(e,t.curCrd)},e.prototype.onEnvAtkGrid=function(t,e){this.curState.onHurt(t,e)},e.prototype.init=function(t){this.banInput=!1,this.node.active=!0,this.isDie=!1;var e=y.default.Ins.crd2lp(t);this.hero.setLayerPos(e),this.curCrd=t,this.enterGrid(y.default.Ins.getGrid(t));var n=y.default.Ins.getRegionByCrd(t);null==n||n.playerEnter(),this.switchState(s.Idle,!0),this.invincible=!1,this.emit(T.PlayerMoveCrd),this.switchWeapon(l.default.Ins.weapon.weaponCfg.id),this.switchPickaxe(l.default.Ins.pickaxe.pickaxeCfg.id),this.info.hp=this.info.maxHp,this.info.food=100},e.prototype.reset=function(t){this.banInput=!1,this.node.active=!0,this.isDie=!1;var e=y.default.Ins.crd2lp(t);this.hero.setLayerPos(e),this.updateCrd(t),this.switchState(s.Idle,!0),this.invincible=!1,this.emit(T.PlayerMoveCrd),this.switchWeapon(l.default.Ins.weapon.weaponCfg.id),this.switchPickaxe(l.default.Ins.pickaxe.pickaxeCfg.id),this.info.hp=this.info.maxHp,this.info.food=100},e.prototype.saveData=function(){var t={food:this.info.food,hp:this.info.hp};localStorage.setItem("player",JSON.stringify(t))},e.prototype.clearSave=function(){localStorage.removeItem("player")},e.prototype.moveToGrid=function(t,e){var n=this;this.banInput||(this.move_isCrdMove=!0,this.curState.onAction(function(){n.move_targetCrd=t,n.switchState(s.Move)}),this.move_endCall=e)},e.prototype.moveToPos=function(t,e,n){var o=this;this.banInput||(this.move_isCrdMove=!1,this.curState.onAction(function(){o.move_targetCrd=e,o.move_targetPos=t,o.switchState(s.Move)}),this.move_endCall=n)},e.prototype.teleportTo=function(t){this.hero.setLayerPos(y.default.Ins.crd2lp(t)),this.updateCrd(t)},e.prototype.detectAttack=function(){if(this.attackDetectFlag){this.attackDetectFlag=!1;for(var t=this.getAttackableGrids(),e=0;e<t.length;e++)if(t[e].touchObjs.length>0){this.fightWith(t[e].touchObjs[0]);break}}},e.prototype.fightWith=function(t){var e=this;this.banInput||this.curState.onAction(function(){e.fight_target=t,e.switchState(s.Fight,!0)})},e.prototype.addHp=function(t){this.info.hp=Math.min(this.info.maxHp,this.info.hp+t)},e.prototype.loseHp=function(t){if(this.info.hp=Math.max(0,this.info.hp-t),this.info.hp<=0)return this.info.hp=0,this.switchState(s.Dead),void c.default.stopMove(this.hero)},e.prototype.addEnergy=function(t){this.info.food=Math.min(100,this.info.food+t)},e.prototype.isInFightRange=function(t){var e=this;return null!=this.getAttackGridsToMonster(t).find(function(n){return n.crd.equals(t.getNearestCrd(e.curCrd))})&&!(null!=y.default.Ins.getTouchedPosBetweenTwoPoints(this.curCrd,t.getNearestCrd(this.curCrd)).find(function(t){var e=y.default.Ins.getGrid(t);return e.isBlockMove||e.isBlockVisual}))},e.prototype.update=function(t){d.default.Ins.isInited&&(t*=d.default.Ins.timeScale,this.curState.onUpdate(t),this.info.food>90?this.addHp(2*t):this.info.food<5&&(this.loseHp(3*t),p.default.getUI(h.default).setTxt("\u4f60\u611f\u5230\u975e\u5e38\u9965\u997f")))},e.prototype.setCrdPos=function(t){this.hero.setLayerPos(y.default.Ins.crd2lp(t)),this.updateCrd(t)},e.prototype.gainDrops=function(t,e){f.default.gainRes(t,e),this.hero.getDrops(t,e)},e.prototype.switchWeapon=function(t){var e=config.Weapon.getById(t);this.info.damage=e.damage,this.info.crit=e.crit,this.hero.updateAnim()},e.prototype.switchPickaxe=function(t){var e=config.Pickaxe.getById(t);e||(e=config.Pickaxe.getById(1)),this.info.digPower=e.power,this.info.digSpeed=e.speed,this.curStateEnum==s.Dig&&this.switchState(s.Idle),this.hero.updateAnim()},e.prototype.moveToDig=function(t){var e=this;this.banInput||this.curState.onAction(function(){e.dig_targetBlock=t,e.switchState(s.Dig)})},e.prototype.moveTo=function(t,e,n,o){var r=this;void 0===o&&(o=!0),this.Hero.setAnimState(g.EAnimState.Move,!o),c.default.moveTo(this.Hero,this.info.moveSpeed,this.curCrd,t,function(t){t.x<0?r.Hero.changeDir(!0):t.x>0&&r.Hero.changeDir(!1)},function(t){r.updateCrd(t),e&&e()},function(){r.switchState(s.Idle)},function(t){r.updateCrd(t),n&&n(),r.onMoveCrd()})},e.prototype.moveToByDirect=function(t,e,n){var o=this;this.Hero.setAnimState(g.EAnimState.Move);var r=cc.Vec2.distance(this.Hero.curPos,t)/this.info.moveSpeed;c.default.directTo(this.Hero,r,function(t){return t},this.hero.curPos,t,function(){o.updateCrd(e),n&&n()})},e.prototype.onMoveCrd=function(){this.emit(T.PlayerMoveCrd),this.attackDetectFlag=!0},e.prototype.hurt=function(t,e){var n=this;if(!this.invincible){if(this.invincible=!0,cc.tween(this).delay(.6).call(function(){return n.invincible=!1}).start(),this.info.hp-=t,u.SoundManager.playEffect(u.SoundType.Hurt),this.info.hp<=0)return this.info.hp=0,u.SoundManager.playEffect(u.SoundType.Dead),this.switchState(s.Dead),void c.default.stopMove(this.hero);var o=y.default.Ins.neighborGrids(this.curCrd,1,function(t){return!t.isBlockMove&&t.crd!=e});0==o.length&&(o=[y.default.Ins.getGrid(this.curCrd)]);var r=this.curCrd.sub(e),i=[];o.forEach(function(t){var o=t.crd.sub(e),a=cc.Vec2.dot(o,r)+100*cc.Vec2.distance(n.Hero.curPos,y.default.Ins.crd2lp(t.crd));i.push({crd:t.crd,wei:a+.01*Math.random()})}),i.sort(function(t,e){return t.wei-e.wei});var a=i[0].crd;this.hurt_targetCrd=a,this.switchState(s.Hurt)}},e.prototype.nearestCrdTo=function(t){var e=this;return a(t).sort(function(t,n){return cc.Vec2.distance(t,e.curCrd)-cc.Vec2.distance(n,e.curCrd)})[0]},e.prototype.consumeFood=function(t){this.info.food=Math.max(this.info.food-t,0)},e.prototype.getAttackLeftDir=function(t){var e=t.getNearestCrd(this.curCrd),n=this.hero.leftDir;return e.x-this.curCrd.x>0?n=!1:e.x-this.curCrd.x<0&&(n=!0),n},e.prototype.getAttackableGrids=function(){for(var t=l.default.Ins.weapon.weaponCfg.scale,e=[],n=-t;n<=t;n++)for(var o=-t;o<=t;o++){var r=y.default.Ins.getGrid(this.curCrd.add(cc.v2(n,o)));r&&e.push(r)}return e},e.prototype.getAttackGridsToMonster=function(t){for(var e=this,n=l.default.Ins.weapon.weaponCfg.scale,o=[],r=-n;r<=0;r++)for(var i=-n;i<=n;i++)o.push(cc.v2(r,i));var a=[],s=this.getAttackLeftDir(t);return o.forEach(function(t){var n=e.curCrd.add(t.mul(s?1:-1));y.default.Ins.validCrd(n)&&a.push(y.default.Ins.getGrid(n))}),a},e.instance=null,i([O(g.default)],e.prototype,"hero",void 0),n=i([P],e)}(cc.Component);n.default=k,window.PlayerCtrl=k,cc._RF.pop()},{"../../Managers/MoveManager":"MoveManager","../../Managers/SoundManager":"SoundManager","../../Model/Inventory":"Inventory","../../Operator":"Operator","../../UI/UI":"UI","../../UI/U_TaskTips":"U_TaskTips","../GameManager":"GameManager","../HeroView":"HeroView","../Map/MapCtrl":"MapCtrl","../Map/TileGrid":"TileGrid","./PlayerDead":"PlayerDead","./PlayerDig":"PlayerDig","./PlayerFight":"PlayerFight","./PlayerHurt":"PlayerHurt","./PlayerIdle":"PlayerIdle","./PlayerMove":"PlayerMove"}],PlayerDead:[function(t,e,n){"use strict";cc._RF.push(e,"24f6fuFStJISb4NrxMqvKXn","PlayerDead");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../CameraCtrl"),s=t("../GameManager"),c=t("../HeroView"),u=t("../ScreenEffectMask"),l=t("./PlayerStateBase"),f=cc._decorator,p=f.ccclass,h=(f.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onEnter=function(){this.player.banInput=!0,s.default.Ins.pauseFrame(20),u.default.Ins.setMask(cc.Color.RED,1,255),a.default.Ins.scaled(1.1,.2),this.player.Hero.setAnimState(c.EAnimState.Dead,!1,[function(){return s.default.Ins.gameOver()}]),this.player.isDie=!0},e.prototype.onExit=function(){this.player.isDie=!1},e.prototype.onAction=function(){},e.prototype.onHurt=function(){},i([p],e)}(l.default));n.default=h,cc._RF.pop()},{"../CameraCtrl":"CameraCtrl","../GameManager":"GameManager","../HeroView":"HeroView","../ScreenEffectMask":"ScreenEffectMask","./PlayerStateBase":"PlayerStateBase"}],PlayerDig:[function(t,e,n){"use strict";cc._RF.push(e,"e9c3bkXmZNN94BWBecQMNfu","PlayerDig");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../Model/Inventory"),a=t("../../Operator"),s=t("../HeroView"),c=t("../Map/MapCtrl"),u=t("../Map/TileObjects/BlockObj"),l=t("./PlayerCtrl"),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInPath=!1,e.lastBlock=null,e.cacheAction=null,e.lastPickaxeId=0,e}return r(e,t),e.prototype.onEnter=function(){this.lastPickaxeId=i.default.Ins.pickaxe.pickaxeCfg.id,this.onRefresh()},e.prototype.onAction=function(t){this.isInPath?this.cacheAction=t:(t&&t(),this.cacheAction=null)},e.prototype.onRefresh=function(){var t=this,e=this.player.dig_targetBlock;if(e!=this.lastBlock&&(this.lastBlock=e,e)){var n=c.default.Ins.findCrdSideofObj(e.grid,function(t){return t==e.grid||!t.isBlockVisual&&!t.isBlockMove});if(n){var o=i.default.Ins.pickaxe;o.pickaxeCfg.id==this.lastPickaxeId?(this.lastPickaxeId=o.pickaxeCfg.id,this.isInPath=!0,this.player.moveTo(n,function(){t.isInPath=!1;var n=e.grid.crd.x-t.player.curCrd.x;n<0?t.player.Hero.changeDir(!0):n>0&&t.player.Hero.changeDir(!1);var o=function(){if(e){var n=e.grid,r=e.digged(t.player.info.digPower);switch(c.default.Ins.extNeighborGrids(n,i.default.Ins.pickaxe.pickaxeCfg.spotterScale,function(t){return!(t.object&&t.object instanceof u.default&&t.object.blockCfg.threshold>i.default.Ins.pickaxe.pickaxeCfg.power)},function(t){return t.diggable}).forEach(function(t){t.object&&t.object instanceof u.default&&t.object.digged(i.default.Ins.pickaxe.pickaxeCfg.spotterPower)}),r){case l.EDigRet.Common:t.player.Hero.setAnimState(s.EAnimState.Dig,!0,[o]),a.default.consumePickaxe();break;case l.EDigRet.Fail:t.player.Hero.setAnimState(s.EAnimState.Idle,!0,null,function(){return t.player.switchState(l.EPlayerState.Idle)});break;case l.EDigRet.Finish:t.player.Hero.setAnimState(s.EAnimState.Idle,!0,null,function(){return t.player.switchState(l.EPlayerState.Idle)}),a.default.consumePickaxe()}}else t.player.switchState(l.EPlayerState.Idle)};t.player.Hero.setAnimState(s.EAnimState.Dig,!1,[o]),t.updateSpeed()},this.getCrdCall.bind(this),!0)):this.player.switchState(l.EPlayerState.Idle)}else this.player.switchState(l.EPlayerState.Idle)}},e.prototype.updateSpeed=function(){var t=this.player.Hero.getRuntimeAnimState(s.EAnimState.Dig);t&&(t.speed=this.player.info.digSpeed)},e.prototype.onUpdate=function(){this.updateSpeed()},e.prototype.getCrdCall=function(){this.cacheAction&&this.cacheAction(),this.cacheAction=null},e.prototype.onExit=function(){this.player.dig_targetBlock=null,this.cacheAction=null,this.lastBlock=null,this.lastPickaxeId=-1},e}(t("./PlayerStateBase").default);n.default=f,cc._RF.pop()},{"../../Model/Inventory":"Inventory","../../Operator":"Operator","../HeroView":"HeroView","../Map/MapCtrl":"MapCtrl","../Map/TileObjects/BlockObj":"BlockObj","./PlayerCtrl":"PlayerCtrl","./PlayerStateBase":"PlayerStateBase"}],PlayerFight:[function(t,e,n){"use strict";cc._RF.push(e,"8d4838GquZBk6QB4MZqDeph","PlayerFight");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../Managers/MoveManager"),a=t("../../Managers/SoundManager"),s=t("../../Operator"),c=t("../HeroView"),u=t("../Map/MapCtrl"),l=t("../Map/TileGrid"),f=t("../Map/TileTips"),p=t("./PlayerCtrl"),h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInPath=!1,e.cacheAction=null,e.idx=0,e.lastMonster=null,e}return r(e,t),e.prototype.onEnter=function(){this.onRefresh()},e.prototype.onExit=function(){var t;null===(t=this.lastMonster)||void 0===t||t.cancelSelect(),this.lastMonster=null},e.prototype.moveToMonster=function(){this.isInPath=!0,this.player.moveTo(this.targetMonster.getNearestCrd(this.player.curCrd),this.onGetCrd.bind(this),this.onGetCrd.bind(this))},e.prototype.onGetCrd=function(){this.cacheAction?(this.cacheAction(),this.cacheAction=null):this.exceptCrd.equals(this.player.curCrd)||this.detect()},e.prototype.onAction=function(t){this.isInPath?this.cacheAction=t:t&&t()},e.prototype.detect=function(){this.exceptCrd=this.player.curCrd,this.isInPath?this.idx++:this.idx=0,this.player.getAttackGridsToMonster(this.targetMonster).forEach(function(t){return f.default.Ins.highLightTile(t,cc.Color.BLUE)}),f.default.Ins.highLightTile(u.default.Ins.getGrid(this.targetMonster.getNearestCrd(this.player.curCrd)),cc.Color.RED),this.player.isInFightRange(this.targetMonster)?this.startAttack():this.player.switchState(p.EPlayerState.Idle)},e.prototype.startAttack=function(){var t=this,e=this.player.getAttackLeftDir(this.targetMonster);this.player.Hero.changeDir(e),i.default.stopMove(this.player.Hero),this.isInPath=!1,this.player.Hero.clearAnimState(),this.player.Hero.setAnimState(c.EAnimState.Attack,!1,[this.attack.bind(this)],null,function(){t.detect()})},e.prototype.attack=function(){var t=this;a.SoundManager.playEffect(Math.random()<.5?a.SoundType.Shake1:a.SoundType.Shake2);var e=this.player.getAttackGridsToMonster(this.targetMonster);s.default.consumeWeapon(),e.forEach(function(e){var n=t.player.info.crit>Math.random();e.emit(l.EGridEvent.PlayerAtk,t.player.info.damage,e.crd.sub(t.player.curCrd),n)})},e.prototype.onRefresh=function(){this.lastMonster&&this.lastMonster.cancelSelect(),this.targetMonster=this.player.fight_target,this.targetMonster.select(),this.lastMonster=this.targetMonster,this.detect()},e}(t("./PlayerStateBase").default);n.default=h,cc._RF.pop()},{"../../Managers/MoveManager":"MoveManager","../../Managers/SoundManager":"SoundManager","../../Operator":"Operator","../HeroView":"HeroView","../Map/MapCtrl":"MapCtrl","../Map/TileGrid":"TileGrid","../Map/TileTips":"TileTips","./PlayerCtrl":"PlayerCtrl","./PlayerStateBase":"PlayerStateBase"}],PlayerHurt:[function(t,e,n){"use strict";cc._RF.push(e,"fd2b7bDn5NOYq9tpzAGTHeF","PlayerHurt");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../Managers/MoveManager"),a=t("../CameraCtrl"),s=t("../GameManager"),c=t("../HeroView"),u=t("../Map/MapCtrl"),l=t("../ScreenEffectMask"),f=t("./PlayerCtrl"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onEnter=function(){var t=this,e=this.player.hurt_targetCrd,n=this.player.Hero.curPos,o=u.default.Ins.crd2lp(e);s.default.Ins.pauseFrame(5),l.default.Ins.setMask(cc.Color.RED,1,150),a.default.Ins.scaled(1.02,.07),i.default.directTo(this.player.Hero,.4,cc.easing.quartOut,n,o,function(){t.player.updateCrd(e),f.default.Ins.Hero.setLayerPos(o)}),this.player.banInput=!0,this.player.Hero.setAnimState(c.EAnimState.Hurt,!1,[function(){t.player.switchState(f.EPlayerState.Idle)}])},e.prototype.onExit=function(){this.player.hurt_targetCrd=null,this.player.banInput=!1},e}(t("./PlayerStateBase").default);n.default=p,cc._RF.pop()},{"../../Managers/MoveManager":"MoveManager","../CameraCtrl":"CameraCtrl","../GameManager":"GameManager","../HeroView":"HeroView","../Map/MapCtrl":"MapCtrl","../ScreenEffectMask":"ScreenEffectMask","./PlayerCtrl":"PlayerCtrl","./PlayerStateBase":"PlayerStateBase"}],PlayerIdle:[function(t,e,n){"use strict";cc._RF.push(e,"4937b1HiKZJ2a8/sK6YtGGw","PlayerIdle");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../HeroView"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onEnter=function(){this.player.Hero.setAnimState(i.EAnimState.Idle),this.player.detectAttack()},e.prototype.onUpdate=function(){this.player.detectAttack()},e}(t("./PlayerStateBase").default);n.default=a,cc._RF.pop()},{"../HeroView":"HeroView","./PlayerStateBase":"PlayerStateBase"}],PlayerMove:[function(t,e,n){"use strict";cc._RF.push(e,"68377cJptRKk6fGINquxb0p","PlayerMove");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("./PlayerCtrl"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cacheAction=null,e}return r(e,t),e.prototype.onEnter=function(){this.onRefresh()},e.prototype.onExit=function(){this.player.move_updateData=null,this.cacheAction=null},e.prototype.onAction=function(t){this.cacheAction=t},e.prototype.onGetCrd=function(){this.cacheAction&&this.cacheAction(),this.cacheAction=null},e.prototype.onRefresh=function(){var t=this;if(this.player.move_isCrdMove){var e=this.player.move_targetCrd;this.player.moveTo(e,function(){t.player.switchState(i.EPlayerState.Idle),t.player.move_endCall&&t.player.move_endCall()},function(){t.onGetCrd()})}else{e=this.player.move_targetCrd;var n=this.player.move_targetPos;this.player.moveToByDirect(n,e,function(){t.player.switchState(i.EPlayerState.Idle),t.player.move_endCall&&t.player.move_endCall()})}},e}(t("./PlayerStateBase").default);n.default=a,cc._RF.pop()},{"./PlayerCtrl":"PlayerCtrl","./PlayerStateBase":"PlayerStateBase"}],PlayerStateBase:[function(t,e,n){"use strict";cc._RF.push(e,"c30084fHeFLBbZyu7aMBBQP","PlayerStateBase");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,i=r.ccclass,a=(r.property,function(){function t(t){this.player=t}return t.prototype.onEnter=function(){},t.prototype.onUpdate=function(){},t.prototype.onExit=function(){},t.prototype.onAction=function(t){t&&t()},t.prototype.onRefresh=function(){},t.prototype.onHurt=function(t,e){this.player.hurt(t,e)},o([i],t)}());n.default=a,cc._RF.pop()},{}],PlayerTask:[function(t,e,n){"use strict";cc._RF.push(e,"721a6EiyddKkJLsLlPeyHKd","PlayerTask");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],PoolManager:[function(t,e,n){"use strict";cc._RF.push(e,"80c87G27EVGKaevNPf9D63T","PoolManager");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0}),n.PrefabPool=n.ObjectPool=n.AbstractPool=n.PoolManager=void 0;var i=t("../Utils/collections/dictionary"),a=function(){function t(){}return t.PrefabPool=function(t,e,n){if(void 0===e&&(e=-1),void 0===n&&(n=0),!t)throw"prefab is null";if(this.HasPoolPrefab(t))return this.prefabPools.tryGetValue(t);var o=new u;return o.prefab=t,o.name=t.name,o.MaxPoolCount=e,o.PrepareCount=n,this.prefabPools.add(t,o),o},t.GetPrefab=function(t,e,n){void 0===e&&(e=-1),void 0===n&&(n=0);var o=this.PrefabPool(t,e,n).Get();return o.poolRes=t,o.poolType="Prefab",o.active=!0,o.opacity=255,o},t.PutPrefab=function(t){var e=t.poolRes;return e?(this.GetPoolPrefab(e).Put(t),!0):(t.parent&&t.removeFromParent(!1),!1)},t.PutPrefabByParent=function(e){for(;e.childrenCount;)t.PutPrefab(e.children[0])},t.Get=function(t,e,n){void 0===e&&(e=-1),void 0===n&&(n=0);var o=this.Pool(t,e,n).Get();return o.poolRes=t,o.poolType="Class",o},t.Put=function(t){var e=t.poolRes;return!!e&&("Class"==t.poolType?this.GetPool(e).Put(t):"Prefab"==t.poolType&&this.GetPoolPrefab(e).Put(t),!0)},t.Pool=function(t,e,n){void 0===e&&(e=-1),void 0===n&&(n=0),this.HasPool(t)&&this.typePools.tryGetValue(t);var o=new c(t);return o.name=t.name,o.MaxPoolCount=e,this.typePools.add(t,o),o},t.HasPoolPrefab=function(t){return t&&this.prefabPools.containsKey(t)},t.HasPool=function(t){return this.typePools.containsKey(t)},t.GetPoolPrefab=function(t){if(!t)throw"prefab";if(!this.HasPoolPrefab(t))throw" pool does not exist."+t.name;return this.prefabPools.tryGetValue(t)},t.GetPool=function(t){if(!this.HasPool(t))throw"pool does not exist."+t;return this.typePools.tryGetValue(t)},t.typePools=new i.Dictionary,t.prefabPools=new i.Dictionary,t}();n.PoolManager=a;var s=function(){};n.AbstractPool=s;var c=function(t){function e(e){var n=t.call(this)||this;return n.mPool=[],n.mMaxPoolCount=10,n.mPrepareCount=10,n.type=e,n}return r(e,t),e.prototype.Get=function(){return this.PoolCount>0?this.mPool.pop():this.Instantiate()},e.prototype.Put=function(t){-1==this.mPool.indexOf(t)&&(this.PoolCount<this.mMaxPoolCount||this.mMaxPoolCount<0?(this.Remove(t),this.mPool.push(t)):this.Destroy(t))},e.prototype.Destroy=function(){},e.prototype.Remove=function(){},e.prototype.Instantiate=function(){return new this.type},e.prototype.PrepareInit=function(){if(this.PoolCount<this.mPrepareCount&&this.type)for(var t=0;t<this.mPrepareCount-this.PoolCount;t++){var e=new this.type;this.mPool.push(e)}},Object.defineProperty(e.prototype,"PoolCount",{get:function(){return this.mPool.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"MaxPoolCount",{get:function(){return this.mMaxPoolCount},set:function(t){this.mMaxPoolCount=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"PrepareCount",{get:function(){return this.mPrepareCount},set:function(t){this.mPrepareCount=t,this.PrepareInit()},enumerable:!1,configurable:!0}),e}(s);n.ObjectPool=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.Instantiate=function(){return cc.instantiate(this.prefab)},e.prototype.Destroy=function(t){t.stopAllActions(),t.removeFromParent(!0),t.destroy()},e.prototype.Remove=function(t){t.stopAllActions(),t.removeFromParent(!1)},e.prototype.PrepareInit=function(){if(this.PoolCount<this.PrepareCount&&this.prefab)for(var t=0;t<this.PrepareCount-this.PoolCount;t++){var e=cc.instantiate(this.prefab);this.Put(e)}},e}(c);n.PrefabPool=u,cc._RF.pop()},{"../Utils/collections/dictionary":"dictionary"}],Region:[function(t,e,n){"use strict";cc._RF.push(e,"da8aahe+4ZMdqmayNfcPsbf","Region");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.ERegionState=void 0;var i,a=t("../../UI/FairyUI/U_TitleBoard"),s=t("../../UI/UI"),c=t("../Monster/Monster"),u=t("../Player/PlayerCtrl"),l=t("./AreaInfo"),f=t("./MapCtrl"),p=t("./TileObjects/SpawnObj");(function(t){t[t.Unlock=0]="Unlock",t[t.Active=1]="Active",t[t.Sleep=2]="Sleep"})(i=n.ERegionState||(n.ERegionState={}));var h=function(){function t(t,e){this.curState=i.Sleep,this.isUnlock=!1,this.monsters=[],this.timer=0,this.monsterTimer=0,this.teleport=null,this.hasMonster=!1,this.initData=null,this.isPlayerInRegion=!1,this.active=!1,this.area=null,this.emptyGrids=[],this.id=t,this.active=!1,this.area=e,this.curState=i.Sleep}return t.prototype.isCrdInArea=function(t){return this.area.isCrdInArea(t)},Object.defineProperty(t.prototype,"isHeartRegion",{get:function(){return 36==this.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ld",{get:function(){return f.default.Ins.lp2crd(cc.v2(this.area.minX,this.area.minY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ru",{get:function(){return f.default.Ins.lp2crd(cc.v2(this.area.maxX,this.area.maxY))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cfg",{get:function(){return config.Region.getById(this.id)},enumerable:!1,configurable:!0}),t.prototype.onUpdate=function(){},t.prototype.getStorageData=function(){return{id:this.id,isClearBoss:!1,isUnlock:this.isUnlock,teleport:this.teleport?this.teleport.getData():null}},Object.defineProperty(t.prototype,"centerPos",{get:function(){var t=f.default.Ins.crd2lp(this.ld),e=f.default.Ins.crd2lp(this.ru);return cc.v2(t.add(e).div(2))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var t=f.default.Ins.crd2lp(this.ld),e=f.default.Ins.crd2lp(this.ru);return Math.abs(t.x-e.x)+f.default.Ins.tileSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var t=f.default.Ins.crd2lp(this.ld),e=f.default.Ins.crd2lp(this.ru);return Math.abs(t.y-e.y)+f.default.Ins.tileSize.height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Active",{get:function(){return this.active},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"grids",{get:function(){return this.area.crds.map(function(t){return f.default.Ins.getGrid(t)})},enumerable:!1,configurable:!0}),t.prototype.switchState=function(t){this.curState=t},t.prototype.load=function(t){for(var e=0;e<this.grids.length;e++)this.grids[e].isEmpty&&this.emptyGrids.push(this.grids[e]);this.initData=t},t.prototype.init=function(){this.initData&&(this.isUnlock=this.initData.isUnlock),this.cfg.teleportIds.length>0&&(this.teleport=f.default.Ins.createTeleport(this),this.teleport.grids.forEach(function(t){f.default.Ins.clearObj(t)}),f.default.Ins.initStructObj(this.teleport),this.teleport.init(this.initData?this.initData.teleport:null)),this.initData=null,this.refreshState(),u.default.Ins.on(u.EPlayerEvent.PlayerMoveCrd,this.onPlayerMoveCrd,this),this.hasMonster=!1;for(var t=0;t<this.grids.length;t++){var e=this.grids[t].object;e&&e instanceof p.default&&(this.hasMonster=!0)}},t.prototype.onPlayerMoveCrd=function(){return o(this,void 0,void 0,function(){return r(this,function(){return[2]})})},t.prototype.onMonsterDead=function(t){this.monsters.splice(this.monsters.indexOf(t),1),t.off(c.EMonsterEvent.Dead,this.onMonsterDead,this)},t.prototype.addObj=function(t){this.emptyGrids.splice(this.emptyGrids.indexOf(t),1)},t.prototype.removeObj=function(t){this.emptyGrids.push(t)},t.prototype.attempToCreateMonster=function(t,e){if(!(this.monsters.length>=this.cfg.maxMonsterNum)){var n=f.default.Ins.createMonster(t,e);n.on(c.EMonsterEvent.Dead,this.onMonsterDead,this),this.monsters.push(n)}},Object.defineProperty(t.prototype,"canTeleport",{get:function(){return!!this.teleport&&this.teleport.isFinish&&this.isUnlock||this.isHeartRegion},enumerable:!1,configurable:!0}),t.prototype.playerEnter=function(){this.isPlayerInRegion=!0,s.default.getUI(a.default).setData(this.cfg.title),this.hasMonster&&s.default.getUI(a.default).setData("\u6ce8\u610f\u5237\u602a",3),f.default.Ins.highlightRegionMask(this),this.refreshState(),this.grids.forEach(function(t){return t.onActiveRegion()})},t.prototype.playerExit=function(){var t=this;this.isPlayerInRegion=!1,this.refreshState(),this.monsters.forEach(function(e){e.off(c.EMonsterEvent.Dead,t.onMonsterDead,t),e.clear()}),this.monsters=[],this.grids.forEach(function(t){return t.onDeactiveRegion()})},t.prototype.unlockRegion=function(){this.isUnlock=!0,this.refreshState()},t.prototype.refreshState=function(){var t=i.Unlock;t=this.isPlayerInRegion?i.Active:this.isUnlock?i.Unlock:i.Sleep,this.curState!=t&&this.switchState(t)},t.prototype.onEnterActive=function(){var t=this;this.active=!0;var e=this.grids;if(e)for(var n=[],o=[],r=function(r){if(null==n.find(function(t){return t==e[r].crd})&&!e[r].isBlockMove){var i=f.default.Ins.searchAreaCrds(e[r].crd,function(e){return!f.default.Ins.crd2RegionId(e.crd)||f.default.Ins.crd2RegionId(e.crd)!=t.id},n),a=new l.default(f.default.Ins);a.edgeGrids=i.edges,a.areaGrids=i.areas,o.push(a)}},i=0;i<e.length;i++)r(i)},t.prototype.onExitActive=function(){this.active=!1},t.prototype.refreshGridState=function(){this.grids.forEach(function(t){return t.refreshState()})},t}();n.default=h,cc._RF.pop()},{"../../UI/FairyUI/U_TitleBoard":"U_TitleBoard","../../UI/UI":"UI","../Monster/Monster":"Monster","../Player/PlayerCtrl":"PlayerCtrl","./AreaInfo":"AreaInfo","./MapCtrl":"MapCtrl","./TileObjects/SpawnObj":"SpawnObj"}],RequireTips_Auto:[function(t,e,n){"use strict";cc._RF.push(e,"6c7c7BIoQZEgIfq//TIcL77","RequireTips_Auto");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.requireRoot=null,e.progress=null,e.list=null,e}return r(e,t),i([c(cc.Node)],e.prototype,"requireRoot",void 0),i([c(cc.Sprite)],e.prototype,"progress",void 0),i([c(cc.Node)],e.prototype,"list",void 0),i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],RequireTips:[function(t,e,n){"use strict";cc._RF.push(e,"c48e3eY5XFNQbkDfYUV90pv","RequireTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./AutoScripts/RequireTips_Auto"),s=t("./Res"),c=t("./UI/Coms/MyListCom"),u=cc._decorator,l=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.needResId=[],e.needResNum=[],e.hasResNum=[],e}return r(e,t),Object.defineProperty(e.prototype,"com",{get:function(){return this.getComponent(a.default)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"list",{get:function(){return this.com.list.getComponent(c.default)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"anim",{get:function(){return this.com.getComponent(cc.Animation)},enumerable:!1,configurable:!0}),e.prototype.initNeed=function(t){this.needResId=t,this.needResNum=this.needResNum,this.hasResNum=[];for(var e=0;e<this.needResId.length;e++)this.hasResNum[e]=0;this.list.itemRenderer=this.onRenderItem.bind(this)},e.prototype.onRenderItem=function(t,e){var n=config.Item.getById(this.needResId[e]);t.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=s.default.Ins.getSprite(n.url),t.getChildByName("label").getComponent(cc.Label).string=this.hasResNum[e]+"/"+this.needResNum[e],t.getChildByName("label").color=this.hasResNum[e]>=this.needResNum[e]?cc.Color.GREEN:cc.Color.RED},e.prototype.gain=function(t){-1!=this.needResId.indexOf(t)&&(this.hasResNum[this.needResId.indexOf(t)]++,this.refresh())},e.prototype.refresh=function(){var t=0,e=0;this.hasResNum.forEach(function(t){return e+=t}),this.needResNum.forEach(function(e){return t+=e}),this.com.progress.fillRange=e/t,this.list.numItems=this.needResId.length},e.prototype.enter=function(){this.anim.play("enter")},e.prototype.exit=function(){this.anim.play("exit")},i([l],e)}(cc.Component));n.default=f,cc._RF.pop()},{"./AutoScripts/RequireTips_Auto":"RequireTips_Auto","./Res":"Res","./UI/Coms/MyListCom":"MyListCom"}],Res:[function(t,e,n){"use strict";cc._RF.push(e,"3ec679znAJCZo4OLE2eL89y","Res");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0}),n.requireRes=void 0;var a=t("./Controller/GameManager"),s=t("./Managers/EventCenter"),c=t("./Managers/SoundManager"),u=cc._decorator,l=u.ccclass,f=u.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._isLoaded=!1,e._cacheFunc=[],e.spriteMap=new Map,e.configs=null,e.rowSprite=null,e.defaultGrid=null,e.monsterPrefabs=[],e.drops=null,e.tag=null,e.bigOres=[],e}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return n.instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return this._isLoaded},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this,this.LoadRes()},e.prototype.LoadRes=function(){var t=this;c.SoundManager.init(),config.decodeConfig(this.configs.json),this._isLoaded=!1,cc.resources.loadDir("texture/icons/",cc.SpriteFrame,function(e,n){e?console.error("load sprite err:"+e):(n.forEach(function(e){t.spriteMap.set(e.name,e)}),s.default.send(s.E_ResLoaded),t._isLoaded=!0,console.log("=======\u8d44\u6e90\u52a0\u8f7d\u5b8c\u6210\uff01\uff01\uff01\uff01========"),t.excuteWaitFunc(),a.default.Ins.initGame())})},e.prototype.requireFunc=function(t){this._isLoaded?t():this._cacheFunc.push(t)},e.prototype.excuteWaitFunc=function(){this._cacheFunc.forEach(function(t){t()}),this._cacheFunc=[]},e.prototype.getSprite=function(t){return this.spriteMap.get(t)||(console.error("\u627e\u4e0d\u5230\u56fe\u7247\uff1a"+t),null)},e.getIconUrl=function(t){return"texture/icons/"+t},e.getHeadUrl=function(t){return"texture/heads/"+t},e.instance=null,e.coinUrl="\u949e\u7968",e.coinQuality=1,i([f(cc.JsonAsset)],e.prototype,"configs",void 0),i([f(cc.Prefab)],e.prototype,"rowSprite",void 0),i([f(cc.Prefab)],e.prototype,"defaultGrid",void 0),i([f(cc.Prefab)],e.prototype,"monsterPrefabs",void 0),i([f(cc.Prefab)],e.prototype,"drops",void 0),i([f(cc.Prefab)],e.prototype,"tag",void 0),i([f(cc.Prefab)],e.prototype,"bigOres",void 0),i([f(cc.Prefab)],e.prototype,"teleport",void 0),n=i([l],e)}(cc.Component);n.default=p,n.requireRes=function(){return function(t,e,n){var o=n.value;n.value=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];p.Ins.requireFunc(function(){o.apply(t,e)})}}},cc._RF.pop()},{"./Controller/GameManager":"GameManager","./Managers/EventCenter":"EventCenter","./Managers/SoundManager":"SoundManager"}],ScaleScreen:[function(t,e,n){"use strict";cc._RF.push(e,"34ea87/x9hJdpvd9gWV/Q8Q","ScaleScreen");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchPoints=[],e}return r(e,t),e.prototype.onLoad=function(){this.touchPoints=[]},e.prototype.onTouchStart=function(t){2===t.getTouches().length&&(this.touchPoints=t.getTouches().map(function(t){return t.getLocation()}))},e.prototype.onTouchMove=function(t){if(2===t.getTouches().length){var e=t.getTouches().map(function(t){return t.getLocation()});cc.Vec2.distance(this.touchPoints[0],this.touchPoints[1]);cc.Vec2.distance(e[0],e[1]),this.touchPoints=e}},e.prototype.onTouchEnd=function(t){2===t.getTouches().length&&(this.touchPoints=[])},e.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this)},i([s],e)}(cc.Component));n.default=c,cc._RF.pop()},{}],ScreenEffectMask:[function(t,e,n){"use strict";cc._RF.push(e,"634b1qGYT1Kragk0uGivIEf","ScreenEffectMask");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=cc._decorator,u=c.ccclass,l=c.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hurtMask=null,e.fadeMask=null,e.storyMask=null,e.guideMask=null,e}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return n._ins},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n._ins=this},e.prototype.setMask=function(t,e,n){void 0===n&&(n=255),this.hurtMask.color=t,this.hurtMask.opacity=n,cc.tween(this.hurtMask).to(e,{opacity:0}).start()},e.prototype.fadeOut=function(t,e,n){void 0===t&&(t=3),void 0===e&&(e=cc.Color.BLACK),this.fadeMask.opacity=0,this.fadeMask.color=e,cc.tween(this.fadeMask).to(t,{opacity:255}).call(function(){return n&&n()}).start()},e.prototype.fadeIn=function(t,e,n,o){void 0===t&&(t=3),void 0===e&&(e=cc.Color.BLACK),void 0===n&&(n=255),this.fadeMask.opacity=n,this.fadeMask.color=e,cc.tween(this.fadeMask).to(t,{opacity:0}).call(function(){return o&&o()}).start()},e.prototype.enterStory=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){var n=t.storyMask.getComponent(cc.Animation);n.play("enter"),n.clear(),n.once(cc.Animation.EventType.FINISHED,function(){return e()})})]})})},e.prototype.exitStory=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){var n=t.storyMask.getComponent(cc.Animation);n.play("exit"),n.clear(),n.once(cc.Animation.EventType.FINISHED,function(){return e()})})]})})},e._ins=null,i([l(cc.Node)],e.prototype,"hurtMask",void 0),i([l(cc.Node)],e.prototype,"fadeMask",void 0),i([l(cc.Node)],e.prototype,"storyMask",void 0),i([l(cc.Node)],e.prototype,"guideMask",void 0),n=i([u],e)}(cc.Component);n.default=f,cc._RF.pop()},{}],Slime2Attack:[function(t,e,n){"use strict";cc._RF.push(e,"a235duF54VHnKF7fljaoaCF","Slime2Attack");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../MonsterState/MonsterStateBase"),s=cc._decorator,c=s.ccclass,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"slime",{get:function(){return this.monster},enumerable:!1,configurable:!0}),e.prototype.onEnter=function(){this.monster.playAnimation(this.slime.attack_animName)},i([c],e)}(a.default));n.default=u,cc._RF.pop()},{"../MonsterState/MonsterStateBase":"MonsterStateBase"}],Slime2Dead:[function(t,e,n){"use strict";cc._RF.push(e,"c7f68wWfZJEdqgK6njJltJ1","Slime2Dead");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onEnter=function(){this.monster.playAnimation("kingDead")},e}(t("../MonsterState/MonsterStateBase").default);n.default=i,cc._RF.pop()},{"../MonsterState/MonsterStateBase":"MonsterStateBase"}],Slime2Idle:[function(t,e,n){"use strict";cc._RF.push(e,"6d592R3dp5A7JG3rjmAnYQG","Slime2Idle");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.smallTimes=1,e.maxSmallTimes=3,e.timer=0,e.idleTime=0,e.isSmallAtk=!1,e}return r(e,t),Object.defineProperty(e.prototype,"slime",{get:function(){return this.monster},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"smallAtkIdleTime",{get:function(){return Math.random()+.5},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bigAtkIdleTime",{get:function(){return 2*Math.random()+2},enumerable:!1,configurable:!0}),e.prototype.onEnter=function(){this.monster.playAnimation("idle"),this.smallTimes<this.maxSmallTimes?(this.idleTime=this.smallAtkIdleTime,this.isSmallAtk=!0):(this.smallTimes=0,this.idleTime=this.bigAtkIdleTime,this.isSmallAtk=!1),this.smallTimes++,this.timer=0},e.prototype.onUpdate=function(t){this.timer+=t,this.timer>this.idleTime&&(this.timer=0,this.isSmallAtk?this.slime.smallAtk():this.slime.bigAtk())},e}(t("../MonsterState/MonsterStateBase").default);n.default=i,cc._RF.pop()},{"../MonsterState/MonsterStateBase":"MonsterStateBase"}],Slime2Monster:[function(t,e,n){"use strict";cc._RF.push(e,"81593ZweSxMk7o0KO8gpNpi","Slime2Monster");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../Managers/MoveManager"),s=t("../../../Managers/PoolManager"),c=t("../../GameManager"),u=t("../../Map/MapCtrl"),l=t("../../Map/TileGrid"),f=t("../../Map/TileTips"),p=t("../../Player/PlayerCtrl"),h=t("../Monster"),d=t("../Slime/SlimeMonster"),g=t("./Slime2Attack"),y=t("./Slime2Dead"),m=t("./Slime2Idle"),_=cc._decorator,v=_.ccclass,I=(_.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.flagArea=null,e.maxAtk1CrdDist=3.99,e.maxAtk2CrdDist=6.99,e.attack_targetAllGrids=[],e.attack_moveTime=0,e.attack_animName="",e.splitHpDelta=70,e.lastHpSplit=0,e.hurted=!1,e}return r(e,t),e.prototype.getNearestCrd=function(t){var e=this.crds;return e.sort(function(e,n){return cc.Vec2.distance(e,t)-cc.Vec2.distance(n,t)}),e[0]},e.prototype.onRegistState=function(){this.stateMap=new Map([[h.EMonsterState.Idle,new m.default(this)],[h.EMonsterState.Attack,new g.default(this)],[h.EMonsterState.Dead,new y.default(this)]])},Object.defineProperty(e.prototype,"crds",{get:function(){for(var t=this.curCrd,e=[],n=-1;n<=1;n++)for(var o=-1;o<=1;o++)e.push(t.add(cc.v2(n,o)));return e},enumerable:!1,configurable:!0}),e.prototype.getLimitedCrd=function(t){var e=this.flagArea,n=e.ld,o=e.ru;return cc.v2(cc.misc.clampf(t.x,n.x,o.x),cc.misc.clampf(t.y,o.y,n.y))},e.prototype.isReadyToAttack=function(){var t=p.default.Ins.curCrd;return!!(Math.abs(t.x-this.curCrd.x)+Math.abs(t.y-this.curCrd.y)<=2&&u.default.Ins.isDirectPath(this.curCrd,p.default.Ins.curCrd))},e.prototype.isFindPlayer=function(){return this.flagArea.isCrdInArea(p.default.Ins.curCrd)},e.prototype.updateCrd=function(t){var e=this,n=this.curCrd;this.curCrd=t;var o=this.curCrd;this.emit(h.EMonsterEvent.MoveCrd,t);for(var r=[],i=[],a=-1;a<=1;a++)for(var s=-1;s<=1;s++){var c=u.default.Ins.getGrid(n.add(cc.v2(a,s)));c&&!c.isBlockMove&&r.push(c);var l=u.default.Ins.getGrid(o.add(cc.v2(a,s)));l&&!l.isBlockMove&&i.push(l)}r.forEach(function(t){e.exitGrid(t)}),i.forEach(function(t){return e.enterGrid(t)})},e.prototype.getAttackGrids=function(){return this.attack_targetAllGrids},e.prototype.A_StartAttackMove=function(){var t=this;a.default.directTo(this,this.attack_moveTime,function(t){return t},cc.v2(this.node.position),u.default.Ins.crd2lp(this.attack_targetCenter),function(){t.updateCrd(t.attack_targetCenter)})},e.prototype.A_Attack=function(){var t=this;this.attack_targetAllGrids.forEach(function(e){return e.emit(l.EGridEvent.MonsterAtk,t,t.info.damage)})},e.prototype.A_EndAttack=function(){this.switchState(h.EMonsterState.Idle)},e.prototype.A_WarnAttack=function(){this.attack_targetAllGrids.forEach(function(t){return f.default.Ins.warnGrid(t,1)})},e.prototype.smallAtk=function(){this.attack_moveTime=.6;var t=this.getLimitedCrd(this.getFarestTargetCrd(this.maxAtk1CrdDist));this.attack_targetAllGrids=[];for(var e=-1;e<=1;e++)for(var n=-1;n<=1;n++){var o=u.default.Ins.getGrid(cc.v2(e,n).add(t));o&&!o.isBlockMove&&this.attack_targetAllGrids.push(o)}this.attack_animName="attack1",this.attack_targetCenter=t,this.switchState(h.EMonsterState.Attack)},e.prototype.bigAtk=function(){this.attack_moveTime=.8;var t=this.getLimitedCrd(this.getFarestTargetCrd(this.maxAtk2CrdDist));this.attack_targetAllGrids=[];for(var e=-2;e<=2;e++)for(var n=-2;n<=2;n++){var o=u.default.Ins.getGrid(cc.v2(e,n).add(t));o&&!o.isBlockMove&&this.attack_targetAllGrids.push(o)}this.attack_targetCenter=t,this.attack_animName="attack2",this.switchState(h.EMonsterState.Attack)},e.prototype.getFarestTargetCrd=function(t){var e=p.default.Ins.curCrd,n=this.curCrd,o=e.sub(n),r=e;if(o.mag()>t){var i=o.normalize().mul(t).add(this.curCrd);r=cc.v2(Math.round(i.x),Math.round(i.y))}return r},e.prototype.hurt=function(e,n,o){var r=this;if(!this.hurted)for(this.hurted=!0,c.default.Ins.cache(function(){return r.hurted=!1}),t.prototype.hurt.call(this,e,n,o);this.lastHpSplit-this.splitHpDelta>this.info.hp;)this.lastHpSplit-=this.splitHpDelta,this.split()},e.prototype.split=function(){var t=this.crds,e=t[Math.floor(Math.random()*t.length)];u.default.Ins.createMonster(2,e)},e.prototype.init=function(e,n){t.prototype.init.call(this,e,n),this.lastHpSplit=this.info.hp},e.prototype.die=function(){a.default.stopMove(this);for(var t=-1;t<=1;t++)for(var e=-1;e<=1;e++){var n=u.default.Ins.getGrid(this.curCrd.add(cc.v2(t,e)));n&&!n.isBlockMove&&this.exitGrid(n)}this.switchState(h.EMonsterState.Dead),this.emit(h.EMonsterEvent.Dead,this)},e.prototype.clear=function(){a.default.stopMove(this);for(var t=-1;t<=1;t++)for(var e=-1;e<=1;e++){var n=u.default.Ins.getGrid(this.curCrd.add(cc.v2(t,e)));n&&!n.isBlockMove&&this.exitGrid(n)}this.drops=[],s.PoolManager.PutPrefab(this.node)},i([v],e)}(d.default));n.default=I,cc._RF.pop()},{"../../../Managers/MoveManager":"MoveManager","../../../Managers/PoolManager":"PoolManager","../../GameManager":"GameManager","../../Map/MapCtrl":"MapCtrl","../../Map/TileGrid":"TileGrid","../../Map/TileTips":"TileTips","../../Player/PlayerCtrl":"PlayerCtrl","../Monster":"Monster","../Slime/SlimeMonster":"SlimeMonster","./Slime2Attack":"Slime2Attack","./Slime2Dead":"Slime2Dead","./Slime2Idle":"Slime2Idle"}],SlimeAttack:[function(t,e,n){"use strict";cc._RF.push(e,"5c7f6TaFM1Fr6UsuYyPWap0","SlimeAttack");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../Player/PlayerCtrl"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onEnter=function(){this.monster.setAtkTargetPos(i.default.Ins.curCrd),this.monster.attack_targetGrids=this.monster.getAttackGrids(),this.monster.playAnimation("attack")},e}(t("../MonsterState/MonsterAttack").default);n.default=a,cc._RF.pop()},{"../../Player/PlayerCtrl":"PlayerCtrl","../MonsterState/MonsterAttack":"MonsterAttack"}],SlimeChase:[function(t,e,n){"use strict";cc._RF.push(e,"9e360DVPgJLw4PVvtbg6KT0","SlimeChase");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../../Managers/MoveManager"),a=t("../../Map/MapCtrl"),s=t("../../Player/PlayerCtrl"),c=t("../Monster"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.path=null,e.pathIdx=0,e.refindFlag=!1,e}return r(e,t),e.prototype.onEnter=function(){if(this.monster.isReadyToAttack())this.monster.switchState(c.EMonsterState.Attack);else{s.default.Ins.on(s.EPlayerEvent.PlayerMoveCrd,this.onPlayerMove,this);var t=this.monster;this.refindPath(),t.move_startMoveEvent=this.onStartMove.bind(this),t.move_endMoveEvent=this.onEndMove.bind(this),this.monster.playAnimation("move")}},e.prototype.refindPath=function(){this.path=a.default.Ins.findPathByDir8(this.monster.curCrd,s.default.Ins.curCrd),this.pathIdx=0},e.prototype.onStartMove=function(){var t=this;if(!this.path||this.pathIdx>=this.path.pathCrds.length-1)this.monster.switchState(c.EMonsterState.Idle);else{var e=this.path.pathCrds[this.pathIdx+1],n=a.default.Ins.crd2lp(this.monster.curCrd),o=a.default.Ins.crd2lp(e);i.default.directTo(this.monster,.4,function(t){return t},n,o,function(){t.monster.updateCrd(e),cc.tween(t).delay(.2*Math.random()).call(function(){t.refindFlag&&(t.refindFlag=!1,t.refindPath())})}),this.pathIdx++}},e.prototype.onEndMove=function(){this.monster.isReadyToAttack()?this.monster.switchState(c.EMonsterState.Attack):this.pathIdx>=this.path.pathCrds.length-1&&this.monster.switchState(c.EMonsterState.Idle)},e.prototype.onUpdate=function(){},e.prototype.onExit=function(){s.default.Ins.off(s.EPlayerEvent.PlayerMoveCrd,this.onPlayerMove,this);var t=this.monster;t.move_startMoveEvent=null,t.move_endMoveEvent=null},e.prototype.onPlayerMove=function(){this.refindFlag=!0},e}(t("../MonsterState/MonsterChase").default);n.default=u,cc._RF.pop()},{"../../../Managers/MoveManager":"MoveManager","../../Map/MapCtrl":"MapCtrl","../../Player/PlayerCtrl":"PlayerCtrl","../Monster":"Monster","../MonsterState/MonsterChase":"MonsterChase"}],SlimeMonster:[function(t,e,n){"use strict";cc._RF.push(e,"9d584xdYM5EE47Kg/SB2tTe","SlimeMonster");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../../Managers/MoveManager"),s=t("../../Map/MapCtrl"),c=t("../../Player/PlayerCtrl"),u=t("../Monster"),l=t("../MonsterState/MonsterDead"),f=t("../MonsterState/MonsterIdle"),p=t("./SlimeAttack"),h=t("./SlimeChase"),d=t("./SlimePatrol"),g=cc._decorator,y=g.ccclass,m=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.move_startMoveEvent=null,e.move_endMoveEvent=null,e}return r(e,t),e.prototype.onRegistState=function(){this.stateMap=new Map([[u.EMonsterState.Idle,new f.default(this)],[u.EMonsterState.Patrol,new d.default(this)],[u.EMonsterState.Chase,new h.default(this)],[u.EMonsterState.Attack,new p.default(this)],[u.EMonsterState.Dead,new l.default(this)]])},e.prototype.setAtkTargetPos=function(t){this.targetCrd=t},e.prototype.isReadyToAttack=function(){var t=c.default.Ins.curCrd;return!!(Math.abs(t.x-this.curCrd.x)+Math.abs(t.y-this.curCrd.y)<=2&&s.default.Ins.isDirectPath(this.curCrd,c.default.Ins.curCrd))},e.prototype.isFindPlayer=function(){return this.getCrdDistFromPlayer()<=config.MonsterCfg.config.maxSightDist&&s.default.Ins.isDirectPath(this.curCrd,c.default.Ins.curCrd)},e.prototype.A_StartAttackMove=function(){var t=this;a.default.directTo(this,.4,function(t){return t},cc.v2(this.node.position),s.default.Ins.crd2lp(this.targetCrd),function(){t.updateCrd(s.default.Ins.lp2crd(cc.v2(t.node.position)))})},e.prototype.A_StartMove=function(){this.move_startMoveEvent&&this.move_startMoveEvent()},e.prototype.A_EndMove=function(){this.move_endMoveEvent&&this.move_endMoveEvent()},e.prototype.getAttackGrids=function(){return[s.default.Ins.getGrid(this.targetCrd)]},i([y],e)}(u.default));n.default=m,cc._RF.pop()},{"../../../Managers/MoveManager":"MoveManager","../../Map/MapCtrl":"MapCtrl","../../Player/PlayerCtrl":"PlayerCtrl","../Monster":"Monster","../MonsterState/MonsterDead":"MonsterDead","../MonsterState/MonsterIdle":"MonsterIdle","./SlimeAttack":"SlimeAttack","./SlimeChase":"SlimeChase","./SlimePatrol":"SlimePatrol"}],SlimePatrol:[function(t,e,n){"use strict";cc._RF.push(e,"9e029J40/1EFbSMm84slUex","SlimePatrol");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../../Managers/MoveManager"),a=t("../../Map/MapCtrl"),s=t("../Monster"),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.path=null,e.pathIdx=0,e}return r(e,t),e.prototype.onEnter=function(){var t=a.default.Ins.findAllAreaGrid(this.monster.curCrd,config.MonsterCfg.config.patrolDist[0],config.MonsterCfg.config.patrolDist[1]);if(t&&0!=t.length){var e=this.monster,n=t[Math.floor(Math.random()*t.length)].grid.crd;this.path=a.default.Ins.findPathByDir8(e.curCrd,n),this.pathIdx=0,e.move_startMoveEvent=this.onStartMove.bind(this),e.move_endMoveEvent=this.onEndMove.bind(this),this.monster.playAnimation("move")}else this.monster.switchState(s.EMonsterState.Idle)},e.prototype.onStartMove=function(){var t=this;if(this.path){var e=this.path.pathCrds[this.pathIdx+1],n=a.default.Ins.crd2lp(this.monster.curCrd),o=a.default.Ins.crd2lp(e);i.default.directTo(this.monster,.4,function(t){return t},n,o,function(){return t.monster.updateCrd(e)}),this.pathIdx++}},e.prototype.onEndMove=function(){this.monster.isReadyToAttack()?this.monster.switchState(s.EMonsterState.Attack):this.pathIdx>=this.path.pathCrds.length-1&&this.monster.switchState(s.EMonsterState.Idle)},e.prototype.onUpdate=function(){},e.prototype.onExit=function(){var t=this.monster;t.move_startMoveEvent=null,t.move_endMoveEvent=null},e}(t("../MonsterState/MonsterPatrol").default);n.default=c,cc._RF.pop()},{"../../../Managers/MoveManager":"MoveManager","../../Map/MapCtrl":"MapCtrl","../Monster":"Monster","../MonsterState/MonsterPatrol":"MonsterPatrol"}],SoundManager:[function(t,e,n){"use strict";cc._RF.push(e,"74ec3w2rINIza+EZziVPaA0","SoundManager");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.SoundManager=n.Sound=n.SoundType=void 0;var i,a=t("../Utils/CocosExtension"),s=cc._decorator;s.ccclass,s.property,function(t){t.BGM="bgm_01",t.Hurt="\u53d7\u4f24",t.Hit="\u6253\u51fb",t.Pickup="\u62fe\u53d6",t.GetItem="\u62ff\u53d6\u97f3\u6548",t.Dig="\u6316\u77ff",t.Dig2="\u6316\u77ff2",t.SlimeJump="\u53f2\u83b1\u59c6\u8df3",t.Backpack="\u80cc\u5305",t.Eat="\u5403",t.Shake1="\u6325\u52a8_01",t.Shake2="\u6325\u52a8_02",t.Dead="\u6b7b\u4ea1",t.Crack="\u77f3\u5757\u7834\u788e",t.Step1="\u811a\u6b65",t.Step2="\u811a\u6b652"}(i=n.SoundType||(n.SoundType={}));var c=function(){};n.Sound=c;var u=function(){function t(){}return t.init=function(){this.registerSound(i.BGM),this.registerSound(i.Hurt),this.registerSound(i.Hit),this.registerSound(i.Pickup),this.registerSound(i.GetItem),this.registerSound(i.Dig),this.registerSound(i.Dig2),this.registerSound(i.SlimeJump),this.registerSound(i.Backpack),this.registerSound(i.Eat),this.registerSound(i.Shake1),this.registerSound(i.Shake2),this.registerSound(i.Dead),this.registerSound(i.Crack),this.registerSound(i.Step1),this.registerSound(i.Step2)},t.registerSound=function(t,e){if(void 0===e&&(e=!1),!this.soundMap.has(t)){var n="sound/"+t,o=new c;o.path=n,o.isEffect=e,this.soundMap.set(t,o)}},t.getClip=function(t){return o(this,void 0,Promise,function(){var e,n;return r(this,function(o){switch(o.label){case 0:return(e=this.audioMap.get(t))?[3,2]:null==(n=this.soundMap.get(t))?(console.error("type is not register: "+t+"  "+n+"  "+this.soundMap.size),[2]):[4,a.loadRes(cc.AudioClip,n.path)];case 1:e=o.sent(),o.label=2;case 2:return[2,e]}})})},t.playMusic=function(t,e){return void 0===e&&(e=1),o(this,void 0,void 0,function(){var n,o;return r(this,function(r){switch(r.label){case 0:return[4,this.getClip(t)];case 1:return n=r.sent(),cc.audioEngine.getState(this.musicMap.get(n))==cc.audioEngine.AudioState.PLAYING?[2]:(o=cc.audioEngine.play(n,!0,this.musicVolume*e),this.musicMap.set(n,o),[2])}})})},t.playEffect=function(t,e,n){return void 0===e&&(e=!1),void 0===n&&(n=1),o(this,void 0,void 0,function(){var o,i,a=this;return r(this,function(r){switch(r.label){case 0:return console.log("play sound effect :"+t+"  "+e+"  "+n),[4,this.getClip(t)];case 1:return o=r.sent(),i=cc.audioEngine.play(o,e,this.effectVolume*n),this.effectMap.set(o,i),e||cc.audioEngine.setFinishCallback(i,function(){return a.effectMap.delete(o)}),[2]}})})},t.getMusicIsPlay=function(t){return o(this,void 0,void 0,function(){var e,n;return r(this,function(o){switch(o.label){case 0:return e=this.soundMap.get(t),[4,this.getClip(t)];case 1:return(n=o.sent())?e.isEffect?[2,this.effectMap.has(n)]:[2,this.musicMap.has(n)]:[2,!1]}})})},t.stop=function(t){return o(this,void 0,void 0,function(){var e,n,o;return r(this,function(r){switch(r.label){case 0:return e=this.soundMap.get(t),[4,this.getClip(t)];case 1:if(!(n=r.sent()))return[2];if(o=0,e.isEffect){if(!this.effectMap.has(n))return[2];o=this.effectMap.get(n),this.effectMap.delete(n)}else{if(!this.musicMap.has(n))return[2];o=this.musicMap.get(n),this.musicMap.delete(n)}return cc.audioEngine.stop(o),[2]}})})},t.stopMusic=function(){return o(this,void 0,void 0,function(){return r(this,function(){return this.musicMap.forEach(function(t){cc.audioEngine.stop(t)}),this.musicMap.clear(),[2]})})},t.stopEffect=function(){return o(this,void 0,void 0,function(){return r(this,function(){return this.effectMap.forEach(function(t){cc.audioEngine.stop(t)}),this.effectMap.clear(),[2]})})},t.stopAll=function(){return o(this,void 0,void 0,function(){return r(this,function(){return cc.audioEngine.stopAll(),this.soundMap.clear(),this.musicMap.clear(),[2]})})},t.setVolume=function(t,e){var n=this.audioMap.get(t),o=this.soundMap.get(t);if(n){var r=0;if(o.isEffect){if(!this.effectMap.has(n))return;r=this.effectMap.get(n)}else{if(!this.musicMap.has(n))return;r=this.musicMap.get(n)}cc.audioEngine.setVolume(r,e)}},t.setAllVolume=function(t){this.setEffectVolume(t),this.setMusicVolume(t)},t.setMusicVolume=function(t){t<0&&(t=0),t>1&&(t=1),this.musicMap.forEach(function(e){cc.audioEngine.setVolume(e,t)}),this.musicVolume=t},t.setEffectVolume=function(t){t<0&&(t=0),t>1&&(t=1),this.effectMap.forEach(function(e){cc.audioEngine.setVolume(e,t)}),this.effectVolume=t},t.soundMap=new Map,t.audioMap=new Map,t.musicMap=new Map,t.effectMap=new Map,t.musicVolume=.8,t.effectVolume=.8,t}();n.SoundManager=u,cc._RF.pop()},{"../Utils/CocosExtension":"CocosExtension"}],SpawnObj:[function(t,e,n){"use strict";cc._RF.push(e,"f0077NhI9lGU4o5S7qxh/N9","SpawnObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../MapCtrl"),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInActive=!1,e.timer=0,e.refreshMonsterTime=0,e}return r(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e)},e.prototype.clear=function(){t.prototype.clear.call(this)},e.prototype.onActiveRegion=function(){this.isInActive=!0},e.prototype.onDeactiveRegion=function(){this.isInActive=!1},Object.defineProperty(e.prototype,"subType",{get:function(){return this.cfg.type.split("_")[1]},enumerable:!1,configurable:!0}),e.prototype.onUpdate=function(t){if(this.isInActive&&(this.timer+=t,this.timer>this.refreshMonsterTime)){var e=0;switch(this.subType){case"slime":e=2;break;case"bat":e=Math.random()<.2?3:1}this.timer=0,this.refreshMonsterTime=15*Math.random()+5,i.default.Ins.getRegionByCrd(this.grid.crd).attempToCreateMonster(e,this.grid.crd)}},e}(t("./TileObject").default);n.default=a,cc._RF.pop()},{"../MapCtrl":"MapCtrl","./TileObject":"TileObject"}],StartGameCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"bfc84u2Bu5DwbSmG+V6DSWi","StartGameCtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../GuideMgr"),u=t("../Mgr/DialogMgr"),l=t("../Mgr/MiniMapMgr"),f=t("../Mgr/StorageMgr"),p=t("../Mgr/UnlockMgr"),h=t("../Model/Inventory"),d=t("../Operator"),g=t("../UI/FairyUI/U_HUD"),y=t("../UI/FairyUI/U_TaskRequire"),m=t("../UI/UI"),_=t("../UI/U_Modal"),v=t("../Utils/CocosExtension"),I=t("./Map/MapCtrl"),b=t("./Player/PlayerCtrl"),C=t("./ScreenEffectMask"),M=t("./TouchCtrl/MainTouchCtrl"),w=cc._decorator,P=w.ccclass,O=(w.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=0,e}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return this.instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"startCrd",{get:function(){return I.default.Ins.getFlagPoint("cameraStart").crd},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"endCrd",{get:function(){return I.default.Ins.getFlagPoint("cameraEnd").crd},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tutorialState",{get:function(){return this.state},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this},e.prototype.jumpTo=function(t){this.startGame(t)},e.prototype.jumpStart=function(){I.default.Ins.heartCtrl.isFinishedStartGuide=!0,I.default.Ins.heartCtrl.tips.node.active=!1,I.default.Ins.heartCtrl.setState(8),C.default.Ins.exitStory(),m.default.getUI(g.default).show()},e.prototype.saveData=function(){console.log("storage start"),localStorage.setItem(f.EStorageKey.startGameState,JSON.stringify(this.state)),console.log("storage end")},e.prototype.clearSave=function(){localStorage.removeItem(f.EStorageKey.startGameState)},e.prototype.startGame=function(t){return void 0===t&&(t=-1),a(this,void 0,void 0,function(){var e,n,o,r,i,y,w,P,O,T,j,k,S=this;return s(this,function(U){switch(U.label){case 0:return this.state=-1==t?f.default.newVer()?null:localStorage.getItem(f.EStorageKey.startGameState)?JSON.parse(f.default.newVer()?null:localStorage.getItem(f.EStorageKey.startGameState)):0:t,e=I.default.Ins.heartCtrl,n=47,o=43,e.setState(1),m.default.getUI(g.default).show(),this.state<=0?(m.default.getUI(_.default).show(),a(S,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,c.default.Ins.guideGetItem(64,1)];case 1:return t.sent(),[4,u.default.Ins.showDialog(24)];case 2:return t.sent(),[2]}})}),m.default.getUI(_.default).show(),M.default.Ins.blockTouch(),C.default.Ins.enterStory(),[4,this.focusMove()]):[3,16];case 1:return U.sent(),[4,v.delay(1e3)];case 2:return U.sent(),m.default.getUI(_.default).hide(),[4,u.default.Ins.showDialog(1)];case 3:return U.sent(),[4,I.default.Ins.returnToPlayer()];case 4:return U.sent(),[4,u.default.Ins.showDialog(2)];case 5:return U.sent(),[4,I.default.Ins.focusToCrdAsync(I.default.Ins.heartCtrl.centerCrd)];case 6:return U.sent(),e.setRequire(n,15,null,function(){if(!I.default.Ins.heartCtrl.startRequireInfo.isFinish){var t=I.default.Ins.findFromGrid(n);c.default.Ins.guideToClick(t,function(){t.onTouchGrid(),I.default.Ins.returnToPlayer(),M.default.Ins.unblockTouch(),m.default.getUI(_.default).hide()},null,!0,!0,"\u8fd8\u9700\u8981\u66f4\u591a\u96ea\u5757")}}),m.default.getUI(g.default).showTask("\u6316\u6398\u96ea\u5757\u4fee\u7406\u77ff\u673a"),[4,v.delay(1e3)];case 7:return U.sent(),[4,u.default.Ins.showDialog(3)];case 8:return U.sent(),I.default.Ins.returnToPlayer(),[4,C.default.Ins.exitStory()];case 9:return U.sent(),[4,m.default.getUI(g.default).fadeIn()];case 10:return U.sent(),M.default.Ins.blockTouch(),r=I.default.Ins.findFromGrid(n),[4,c.default.Ins.guideToClick(r,null,null,!0,!0,"\u70b9\u51fb\u6b64\u5904\u6316\u6398\u96ea\u5757")];case 11:return U.sent(),M.default.Ins.blockTouch(),r.onTouchGrid(),I.default.Ins.returnToPlayer(),[4,c.default.Ins.guideGetItem(n,5)];case 12:return U.sent(),M.default.Ins.blockTouch(),[4,I.default.Ins.focusToCrdAsync(I.default.Ins.heartCtrl.centerCrd)];case 13:return U.sent(),[4,c.default.Ins.guideToClick(I.default.Ins.heartCtrl.node,null,null,!0,!0,"\u70b9\u51fb\u94bb\u673a\u4f7f\u7528\u96ea\u5757\u706d\u706b")];case 14:return U.sent(),I.default.Ins.heartCtrl.onClick(),M.default.Ins.unblockTouch(),[4,e.awaitFinishRequire(n)];case 15:U.sent(),m.default.getUI(g.default).finishTask(),this.state++,f.default.save(),U.label=16;case 16:return this.state<=1?(M.default.Ins.blockTouch(),I.default.Ins.focusToCrdAsync(I.default.Ins.heartCtrl.centerCrd),m.default.getUI(g.default).fadeOut(),[4,C.default.Ins.enterStory()]):[3,25];case 17:return U.sent(),[4,v.delay(1e3)];case 18:return U.sent(),e.setState(2),e.tweenEffect(),[4,u.default.Ins.showDialog(4)];case 19:return U.sent(),e.setRequire(o,20),[4,v.delay(1500)];case 20:return U.sent(),m.default.getUI(g.default).showTask("\u6316\u6398\u51b0\u4fee\u7406\u77ff\u673a"),[4,C.default.Ins.exitStory()];case 21:return U.sent(),m.default.getUI(g.default).fadeIn(),w=I.default.Ins.findFromGrid(o),[4,I.default.Ins.focusToCrdAsync(w.crd)];case 22:return U.sent(),[4,c.default.Ins.guideToClick(w,null,null,!0,!0,"\u70b9\u51fb\u6b64\u5904\u6316\u6398\u51b0\u5757")];case 23:return U.sent(),M.default.Ins.blockTouch(),w.onTouchGrid(),I.default.Ins.returnToPlayer(),M.default.Ins.unblockTouch(),[4,e.awaitFinishRequire(o)];case 24:U.sent(),m.default.getUI(g.default).finishTask(),this.state++,f.default.save(),M.default.Ins.unblockTouch(),I.default.Ins.returnToPlayer(),c.default.Ins.cancelGuideGetItem(64),U.label=25;case 25:return e.finishRequire(),e.setState(8),this.state<=2?[4,u.default.Ins.showDialog(17)]:[3,43];case 26:return U.sent(),[4,u.default.Ins.showDialog(18)];case 27:return U.sent(),[4,u.default.Ins.showDialog(19)];case 28:return U.sent(),[4,u.default.Ins.showDialog(20)];case 29:return U.sent(),[4,u.default.Ins.showDialog(21)];case 30:return U.sent(),[4,u.default.Ins.showDialog(22)];case 31:return U.sent(),[4,u.default.Ins.showDialog(23)];case 32:return U.sent(),[4,u.default.Ins.showDialog(25)];case 33:return U.sent(),[4,u.default.Ins.showDialog(26)];case 34:return U.sent(),[4,u.default.Ins.showDialog(27)];case 35:return U.sent(),[4,u.default.Ins.showDialog(28)];case 36:return U.sent(),[4,u.default.Ins.showDialog(29)];case 37:return U.sent(),m.default.getUI(g.default).showTask("\u627e\u5230\u94dc\u94a5\u5319"),h.default.Ins.findResNum(64)>1?[4,u.default.Ins.showDialog(32)]:[3,39];case 38:return U.sent(),m.default.getUI(g.default).finishTask(),[3,42];case 39:return[4,c.default.Ins.guideGetItem(64,1)];case 40:return U.sent(),m.default.getUI(g.default).finishTask(),[4,u.default.Ins.showDialog(33)];case 41:U.sent(),U.label=42;case 42:this.state++,f.default.save(),U.label=43;case 43:return this.state<=3?(m.default.getUI(g.default).showTask("\u627e\u5230\u5e76\u6253\u5f00\u533a\u57df\u8fb9\u7f18\u7684\u94dc\u95e8"),w=I.default.Ins.getGrid(cc.v2(44,47)),i=w.object,[4,c.default.Ins.awaitOpenDoor(i)]):[3,46];case 44:return U.sent(),this.state++,f.default.save(),[4,v.delay(3e3)];case 45:U.sent(),m.default.getUI(g.default).finishTask(),U.label=46;case 46:return this.state<=5?[4,u.default.Ins.showDialog(35)]:[3,53];case 47:return U.sent(),[4,u.default.Ins.showDialog(36)];case 48:return U.sent(),[4,u.default.Ins.showDialog(37)];case 49:return U.sent(),m.default.getUI(g.default).showTask("\u627e\u5230\u6307\u5b9a\u533a\u57df\u7684\u4fe1\u6807\u7ec8\u7aef"),l.default.Ins.signToRegion(27),[4,c.default.Ins.guideToClick(m.default.getUI(g.default).view.m_mapBtn)];case 50:return U.sent(),[4,v.delay(1e3)];case 51:return U.sent(),[4,u.default.Ins.showDialog(38)];case 52:U.sent(),U.label=53;case 53:return this.state<=4?[4,c.default.Ins.awaitOpenDoorByKeyId(64)]:[3,59];case 54:return U.sent(),this.state++,f.default.save(),[4,u.default.Ins.showDialog(39)];case 55:return U.sent(),[4,u.default.Ins.showDialog(40)];case 56:return U.sent(),[4,u.default.Ins.showDialog(41)];case 57:return U.sent(),[4,u.default.Ins.showDialog(42)];case 58:U.sent(),d.default.gainRes(102,1),U.label=59;case 59:return this.state<=5?(y=config.Blueprint.list.find(function(t){return 102==t.resId}),p.default.Ins.isUnlockBuy(y.goodsId)||d.default.gainRes(102,1),[4,c.default.Ins.awaitClickTeleport()]):[3,66];case 60:return U.sent(),m.default.getUI(g.default).finishTask(),this.state++,f.default.save(),[4,u.default.Ins.showDialog(45)];case 61:return U.sent(),[4,u.default.Ins.showDialog(46)];case 62:return U.sent(),(w=I.default.Ins.getGrid(cc.v2(35,41))).isExplored?[3,66]:(M.default.Ins.blockTouch(),m.default.getUI(_.default).show(),[4,I.default.Ins.focusToCrdAsync(w.crd)]);case 63:return U.sent(),[4,c.default.Ins.guideToClick(w,null,null,!0,!0,"\u77ff\u77f3\u5728\u9ed1\u6697\u5904\u5c06\u6709\u95ea\u5149")];case 64:return U.sent(),[4,I.default.Ins.returnToPlayer()];case 65:U.sent(),M.default.Ins.unblockTouch(),m.default.getUI(_.default).hide(),U.label=66;case 66:return this.state<=6?(m.default.getUI(g.default).showTask("\u4fee\u7406\u5e76\u6fc0\u6d3b\u6307\u5b9a\u533a\u57df\u7684\u4fe1\u6807\u7ec8\u7aef"),[4,c.default.Ins.awaitFinishTeleport(27)]):[3,73];case 67:return U.sent(),m.default.getUI(g.default).finishTask(),l.default.Ins.clearSign(27),this.state++,f.default.save(),[4,u.default.Ins.showDialog(47)];case 68:return U.sent(),[4,u.default.Ins.showDialog(48)];case 69:return U.sent(),[4,u.default.Ins.showDialog(49)];case 70:return U.sent(),d.default.gainRes(108,1),d.default.gainRes(88,1),d.default.gainRes(98,1),d.default.gainRes(103,1),d.default.gainRes(111,1),[4,c.default.Ins.awaitHideCont()];case 71:return U.sent(),[4,u.default.Ins.showDialog(50)];case 72:U.sent(),U.label=73;case 73:return this.state<=7?[4,u.default.Ins.showDialog(51)]:[3,93];case 74:return U.sent(),[4,u.default.Ins.showDialog(52)];case 75:return U.sent(),m.default.getUI(g.default).showTask("\u51fb\u8d25\u897f\u5317\u65b9\u795e\u79d8\u751f\u7269"),[4,u.default.Ins.showDialog(53)];case 76:return U.sent(),[4,u.default.Ins.showDialog(54)];case 77:return U.sent(),[4,u.default.Ins.showDialog(55)];case 78:return U.sent(),[4,u.default.Ins.showDialog(56)];case 79:return U.sent(),l.default.Ins.signToRegion(18),[4,c.default.Ins.awaitMoveToGrid(I.default.Ins.getGrid(cc.v2(23,40)))];case 80:return U.sent(),b.default.Ins.switchState(b.EPlayerState.Idle),[4,u.default.Ins.showDialog(97)];case 81:return U.sent(),[4,u.default.Ins.showDialog(98)];case 82:return U.sent(),[4,u.default.Ins.showDialog(99)];case 83:return U.sent(),P=I.default.Ins.getGrid(cc.v2(24,40)),[4,c.default.Ins.guideToClick(P,null,null,!0,!0,"\u70b9\u51fb\u690d\u7269\u8fdb\u884c\u91c7\u96c6\u548c\u67e5\u770b\u751f\u957f\u72b6\u6001")];case 84:return U.sent(),P.onTouchGrid(),[4,c.default.Ins.guideToClick(m.default.getUI(g.default).view.m_bottomUI.m_slot3,null,null,!0,!0,"\u70b9\u51fb\u6d88\u8017\u54c1\u680f\uff0c\u67e5\u770b\u98df\u7269\u7b49\u6d88\u8017\u54c1")];case 85:return U.sent(),O=h.default.Ins.resList.findIndex(function(t){return 39==t.cfgId}),(T=m.default.getUI(g.default).getBpCom(O))?[4,c.default.Ins.guideToClick(T.asCom,null,null,!0,!0,"\u70b9\u51fb\u98df\u7269\u4ee5\u88c5\u5907")]:[3,88];case 86:return U.sent(),[4,c.default.Ins.guideToClick(m.default.getUI(g.default).view.m_bottomUI.m_foodBtn,null,null,!0,!0,"\u70b9\u51fb\u4f7f\u7528")];case 87:U.sent(),U.label=88;case 88:return[4,c.default.Ins.awaitClearBoss(18)];case 89:return U.sent(),m.default.getUI(g.default).finishTask(),l.default.Ins.clearSign(18),[4,u.default.Ins.showDialog(57)];case 90:return U.sent(),[4,u.default.Ins.showDialog(58)];case 91:return U.sent(),[4,u.default.Ins.showDialog(59)];case 92:U.sent(),this.state++,f.default.save(),U.label=93;case 93:return this.state<=8?[4,u.default.Ins.showDialog(60)]:[3,97];case 94:return U.sent(),l.default.Ins.signToRegion(23),m.default.getUI(g.default).showTask("\u4fee\u7406\u5e76\u6fc0\u6d3b\u6307\u5b9a\u533a\u57df\u7684\u4fe1\u6807\u7ec8\u7aef"),[4,c.default.Ins.awaitFinishTeleport(23)];case 95:return U.sent(),m.default.getUI(g.default).finishTask(),l.default.Ins.clearSign(23),[4,u.default.Ins.showDialog(61)];case 96:U.sent(),d.default.gainRes(104,1),d.default.gainRes(81,1),d.default.gainRes(89,1),d.default.gainRes(99,1),this.state++,f.default.save(),U.label=97;case 97:return this.state<=9?[4,u.default.Ins.showDialog(62)]:[3,102];case 98:return U.sent(),[4,u.default.Ins.showDialog(63)];case 99:return U.sent(),[4,u.default.Ins.showDialog(64)];case 100:return U.sent(),l.default.Ins.signToRegion(5),m.default.getUI(g.default).showTask("\u51fb\u8d25\u5317\u65b9\u795e\u79d8\u751f\u7269"),[4,c.default.Ins.awaitClearBoss(5)];case 101:U.sent(),l.default.Ins.clearSign(5),m.default.getUI(g.default).finishTask(),this.state++,f.default.save(),U.label=102;case 102:return this.state<=10?[4,u.default.Ins.showDialog(65)]:[3,111];case 103:return U.sent(),[4,u.default.Ins.showDialog(66)];case 104:return U.sent(),l.default.Ins.signToRegion(17),m.default.getUI(g.default).showTask("\u4fee\u7406\u5e76\u6fc0\u6d3b\u6307\u5b9a\u533a\u57df\u7684\u4fe1\u6807\u7ec8\u7aef"),[4,c.default.Ins.awaitFinishTeleport(17)];case 105:return U.sent(),m.default.getUI(g.default).finishTask(),l.default.Ins.clearSign(17),[4,u.default.Ins.showDialog(67)];case 106:return U.sent(),d.default.gainRes(90,1),d.default.gainRes(95,1),d.default.gainRes(100,1),d.default.gainRes(105,1),[4,c.default.Ins.awaitHideCont()];case 107:return U.sent(),[4,u.default.Ins.showDialog(68)];case 108:return U.sent(),[4,u.default.Ins.showDialog(69)];case 109:return U.sent(),[4,u.default.Ins.showDialog(70)];case 110:U.sent(),d.default.gainRes(110,1),this.state++,f.default.save(),U.label=111;case 111:return this.state<=11?[4,u.default.Ins.showDialog(71)]:[3,116];case 112:return U.sent(),m.default.getUI(g.default).showTask("\u51fb\u8d25\u4e1c\u5317\u65b9\u795e\u79d8\u751f\u7269"),l.default.Ins.signToRegion(25),[4,u.default.Ins.showDialog(72)];case 113:return U.sent(),[4,c.default.Ins.awaitClearBoss(25)];case 114:return U.sent(),l.default.Ins.clearSign(25),m.default.getUI(g.default).finishTask(),[4,u.default.Ins.showDialog(73)];case 115:U.sent(),this.state++,f.default.save(),U.label=116;case 116:return this.state<=12?[4,u.default.Ins.showDialog(74)]:[3,123];case 117:return U.sent(),[4,u.default.Ins.showDialog(75)];case 118:return U.sent(),m.default.getUI(g.default).showTask("\u4fee\u7406\u5e76\u6fc0\u6d3b\u6307\u5b9a\u533a\u57df\u7684\u4fe1\u6807\u7ec8\u7aef"),l.default.Ins.signToRegion(55),[4,c.default.Ins.awaitFinishTeleport(55)];case 119:return U.sent(),m.default.getUI(g.default).finishTask(),l.default.Ins.clearSign(55),[4,u.default.Ins.showDialog(76)];case 120:return U.sent(),[4,u.default.Ins.showDialog(77)];case 121:return U.sent(),d.default.gainRes(96,1),d.default.gainRes(86,1),d.default.gainRes(101,1),d.default.gainRes(106,1),[4,c.default.Ins.awaitHideCont()];case 122:U.sent(),this.state++,f.default.save(),U.label=123;case 123:return this.state<=13?[4,u.default.Ins.showDialog(78)]:[3,129];case 124:return U.sent(),[4,u.default.Ins.showDialog(79)];case 125:return U.sent(),m.default.getUI(g.default).showTask("\u51fb\u8d25\u897f\u5357\u65b9\u795e\u79d8\u751f\u7269"),l.default.Ins.signToRegion(64),[4,c.default.Ins.awaitClearBoss(64)];case 126:return U.sent(),l.default.Ins.clearSign(64),m.default.getUI(g.default).finishTask(),[4,u.default.Ins.showDialog(80)];case 127:return U.sent(),[4,u.default.Ins.showDialog(81)];case 128:U.sent(),this.state++,f.default.save(),U.label=129;case 129:return this.state<=14?[4,u.default.Ins.showDialog(82)]:[3,139];case 130:return U.sent(),[4,u.default.Ins.showDialog(83)];case 131:return U.sent(),[4,u.default.Ins.showDialog(84)];case 132:return U.sent(),[4,u.default.Ins.showDialog(85)];case 133:return U.sent(),[4,u.default.Ins.showDialog(86)];case 134:return U.sent(),[4,u.default.Ins.showDialog(87)];case 135:return U.sent(),m.default.getUI(g.default).showTask("\u4fee\u7406\u5e76\u6fc0\u6d3b\u6307\u5b9a\u533a\u57df\u7684\u4fe1\u6807\u7ec8\u7aef"),l.default.Ins.signToRegion(83),[4,c.default.Ins.awaitFinishTeleport(83)];case 136:return U.sent(),m.default.getUI(g.default).finishTask(),l.default.Ins.clearSign(83),[4,u.default.Ins.showDialog(88)];case 137:return U.sent(),d.default.gainRes(96,1),d.default.gainRes(86,1),d.default.gainRes(101,1),d.default.gainRes(106,1),[4,c.default.Ins.awaitHideCont()];case 138:U.sent(),this.state++,f.default.save(),U.label=139;case 139:return this.state<=15?[4,u.default.Ins.showDialog(89)]:[3,150];case 140:return U.sent(),[4,u.default.Ins.showDialog(90)];case 141:return U.sent(),[4,u.default.Ins.showDialog(91)];case 142:return U.sent(),[4,u.default.Ins.showDialog(92)];case 143:for(U.sent(),m.default.getUI(g.default).showTask("\u4fee\u7406\u5e76\u6fc0\u6d3b\u6240\u6709\u7684\u4fe1\u6807\u7ec8\u7aef"),j=0;j<config.Region.list.length;j++)k=config.Region.list[j],!I.default.Ins.getRegionById(k.id).isUnlock&&k.teleportIds.length>0&&l.default.Ins.signToRegion(k.id);return[4,c.default.Ins.awaitFinishAllTeleport()];case 144:return U.sent(),m.default.getUI(g.default).finishTask(),[4,u.default.Ins.showDialog(93)];case 145:return U.sent(),[4,u.default.Ins.showDialog(94)];case 146:return U.sent(),[4,u.default.Ins.showDialog(95)];case 147:return U.sent(),[4,u.default.Ins.showDialog(96)];case 148:return U.sent(),d.default.gainRes(83,100),[4,c.default.Ins.awaitHideCont()];case 149:U.sent(),this.state++,f.default.save(),U.label=150;case 150:return[2]}})})},e.prototype.awaitGetRuby=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return[4,c.default.Ins.guideGetItem(8,1)];case 1:return t.sent(),[4,u.default.Ins.showDialog(13)];case 2:return t.sent(),[4,c.default.Ins.guideToClick(I.default.Ins.getGrid(I.default.Ins.heartCtrl.centerCrd))];case 3:return t.sent(),m.default.getUI(y.default).show(),[4,c.default.Ins.guideToClick(m.default.getUI(y.default).view.m_craftPage.m_upgradeBtn,null,null,!0,!0,"\u70b9\u51fb\u5347\u7ea7\u7ec8\u7aef")];case 4:return t.sent(),[4,u.default.Ins.showDialog(14)];case 5:return t.sent(),[2]}})})},e.prototype.focusMove=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){I.default.Ins.setFocus(t.startCrd);var n={crd:t.startCrd};cc.tween(n).to(2,{crd:t.endCrd},{onUpdate:function(){I.default.Ins.setFocus(n.crd)}}).call(function(){e()}).start()})]})})},e.instance=null,n=i([P],e)}(cc.Component));n.default=O,cc._RF.pop()},{"../GuideMgr":"GuideMgr","../Mgr/DialogMgr":"DialogMgr","../Mgr/MiniMapMgr":"MiniMapMgr","../Mgr/StorageMgr":"StorageMgr","../Mgr/UnlockMgr":"UnlockMgr","../Model/Inventory":"Inventory","../Operator":"Operator","../UI/FairyUI/U_HUD":"U_HUD","../UI/FairyUI/U_TaskRequire":"U_TaskRequire","../UI/UI":"UI","../UI/U_Modal":"U_Modal","../Utils/CocosExtension":"CocosExtension","./Map/MapCtrl":"MapCtrl","./Player/PlayerCtrl":"PlayerCtrl","./ScreenEffectMask":"ScreenEffectMask","./TouchCtrl/MainTouchCtrl":"MainTouchCtrl"}],StateCtrl:[function(t,e,n){"use strict";cc._RF.push(e,"a2ebeeWlDtPeryZ4Q/KlR+j","StateCtrl");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var i=function(){function t(t){this.curState=t,this.stateFuncMap=new Map,this.transFuncMap=new Map}return t.prototype.bindState=function(t,e){return this.stateFuncMap.set(t,e),this},t.prototype.bindTrans=function(t,e,n){return this.transFuncMap.set({start:t,end:e},n),this},t.prototype.is=function(t){return this.curState==t},t.prototype.refresh=function(){var t=this.stateFuncMap.get(this.curState);return t&&t(),this},t.prototype.switchTo=function(t){return o(this,void 0,void 0,function(){var e,n,o,i,a;return r(this,function(r){switch(r.label){case 0:return e=this.curState,n=t,o=null,i=!1,this.transFuncMap.forEach(function(t,r){i||r.start==e&&r.end==n&&(i=!0,o=t)}),a=this.stateFuncMap.get(t),o?[4,o()]:[3,2];case 1:r.sent(),r.label=2;case 2:return a&&a(),this.curState=t,[2]}})})},t.prototype.refreshTo=function(t){var e=this.stateFuncMap.get(t);e&&e(),this.curState=t},t}();n.default=i,cc._RF.pop()},{}],StorageMgr:[function(t,e,n){"use strict";cc._RF.push(e,"a03beIUmwhADa0H/wsniix9","StorageMgr"),Object.defineProperty(n,"__esModule",{value:!0}),n.EStorageKey=void 0;var o,r=t("../CollectMgr"),i=t("../Controller/Map/MapCtrl"),a=t("../Controller/Player/PlayerCtrl"),s=t("../Controller/StartGameCtrl"),c=t("../CraftTaskMgr"),u=t("../Model/Inventory"),l=t("../UI/UI"),f=t("../UI/U_TaskTips"),p=t("./UnlockMgr");(function(t){t.mapData="mapData",t.playerInfo="playerInfo",t.inventory="inventory",t.startGameState="startGameState",t.craftTask="craftTask",t.version="version",t.regionsInfo="regions",t.craftLock="craftLock",t.buyLock="buyLock",t.playerCrd="playerCrd",t.collect="collect"})(o=n.EStorageKey||(n.EStorageKey={}));var h=function(){function t(){}return t.save=function(){i.default.Ins.saveData(),a.default.Ins.saveData(),u.default.Ins.saveData(),s.default.Ins.saveData(),c.default.Ins.saveData(),t.setItem(o.version,2.1.toString()),p.default.Ins.saveData(),r.default.Ins.saveData(),l.default.getUI(f.default).setTxt("\u4fdd\u5b58\u5b58\u6863")},t.clear=function(){i.default.Ins.clearSave(),a.default.Ins.clearSave(),u.default.Ins.clearSave(),s.default.Ins.clearSave(),c.default.Ins.clearSave(),p.default.Ins.clearSave(),r.default.Ins.clearSave(),l.default.getUI(f.default).setTxt("\u6e05\u9664\u5b58\u6863")},t.newVer=function(){var t=localStorage.getItem(o.version);return t&&t!=2.1.toString()},t.getItem=function(t){return this.newVer()?null:localStorage.getItem(t)},t.setItem=function(t,e){localStorage.setItem(t,e)},t.removeItem=function(t){localStorage.removeItem(t)},t}();n.default=h,cc._RF.pop()},{"../CollectMgr":"CollectMgr","../Controller/Map/MapCtrl":"MapCtrl","../Controller/Player/PlayerCtrl":"PlayerCtrl","../Controller/StartGameCtrl":"StartGameCtrl","../CraftTaskMgr":"CraftTaskMgr","../Model/Inventory":"Inventory","../UI/UI":"UI","../UI/U_TaskTips":"U_TaskTips","./UnlockMgr":"UnlockMgr"}],TeleportObj:[function(t,e,n){"use strict";cc._RF.push(e,"46aacFtgdBN9raRhayUZ5BI","TeleportObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../../AutoScripts/Tips_Auto"),u=t("../../../Managers/AnimationManager"),l=t("../../../Managers/EventCenter"),f=t("../../../Mgr/DialogMgr"),p=t("../../../Model/Inventory"),h=t("../../../Operator"),d=t("../../../Res"),g=t("../../../UI/FairyUI/U_MapWindow"),y=t("../../../UI/UI"),m=t("../../../UI/U_Modal"),_=t("../../../UI/U_PopupTips"),v=t("../../../UI/U_TaskTips"),I=t("../../../Utils/CocosExtension"),b=t("../../GameManager"),C=t("../../HeartCtrl"),M=t("../../Player/PlayerCtrl"),w=t("../../TouchCtrl/MainTouchCtrl"),P=t("../MapCtrl"),O=t("../TileGrid"),T=t("../TileTips"),j=cc._decorator,k=j.ccclass,S=j.property,U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stateIdx=0,e.banClick=!1,e.isPlayerInTeleport=!1,e.targetRegionId=-1,e.sprite=null,e}return r(e,t),Object.defineProperty(e.prototype,"grids",{get:function(){var t=[];return t.push(P.default.Ins.getGrid(this.centerCrd)),t.push(P.default.Ins.getGrid(this.centerCrd.add(cc.v2(1,0)))),t.push(P.default.Ins.getGrid(this.centerCrd.add(cc.v2(1,-1)))),t.push(P.default.Ins.getGrid(this.centerCrd.add(cc.v2(0,-1)))),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"aroundGrids",{get:function(){var t=this.centerCrd.x,e=this.centerCrd.x,n=this.centerCrd.y,o=this.centerCrd.y;this.grids.forEach(function(r){r.crd.x>e&&(e=r.crd.x),r.crd.x<t&&(t=r.crd.x),r.crd.y>o&&(o=r.crd.y),r.crd.y<n&&(n=r.crd.y)});for(var r=[],i=t-2;i<=e+2;i++)for(var a=function(t){var e=P.default.Ins.getGrid(cc.v2(i,t));e&&!s.grids.find(function(t){return t.crd.equals(e.crd)})&&r.push(e)},s=this,c=n-2;c<=o+2;c++)a(c);return r},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"centerPos",{get:function(){var t=cc.v2(),e=this.grids;return e.forEach(function(e){t.addSelf(P.default.Ins.crd2lp(e.crd))}),t.div(e.length)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"teleportPosition",{get:function(){return this.teleportPos.position.add(this.node.position)},enumerable:!1,configurable:!0}),e.prototype.isCrdInArea=function(t){return!!this.grids.find(function(e){return e.crd.equals(t)})},e.prototype.getData=function(){return{state:this.stateIdx,requireHas:this.isFinish?0:this.requires.has,requireId:this.isFinish?0:this.requires.id,requireNeed:this.isFinish?0:this.requires.need}},Object.defineProperty(e.prototype,"isFinish",{get:function(){return this.stateIdx>=config.Region.getById(this.region.id).teleportIds.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlockMove",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlockVisual",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.onClick=function(){var t=this;if(!this.banClick){var e=P.default.Ins.findCrdSideOfStructObj(this);e?M.default.Ins.moveToGrid(e,function(){t.onOperate()}):y.default.getUI(v.default).setTxt("\u65e0\u6cd5\u5230\u8fbe")}},e.prototype.onOperate=function(){return a(this,void 0,void 0,function(){var t,e,n,o=this;return s(this,function(r){switch(r.label){case 0:return l.default.send(l.E_ClickTeleport),this.isFinish?p.default.Ins.findResNum(2)<3?(y.default.getUI(_.default).setData("\u80fd\u6e90\u6c34\u6676\u4e0d\u8db3",function(){}),[2]):(y.default.getUI(_.default).setData("\u9700\u8981\u6d88\u80173\u5757\u80fd\u6e90\u6c34\u6676\uff08\u5f53\u524d\u62e5\u6709"+p.default.Ins.findResNum(2)+"\uff09",function(){y.default.getUI(g.default).openSelectTeleport(function(t){P.default.Ins.getRegionById(t).canTeleport?(h.default.reduceByList([2],[3]),o.enterTeleport(t)):y.default.getUI(v.default).setTxt("\u8be5\u533a\u5757\u672a\u63a2\u7d22\u6216\u6ca1\u6709\u4f20\u9001\u5668")},null)}),[3,4]):[3,1];case 1:return t=this.requires.id,e=p.default.Ins.findResNum(t),(n=Math.min(e,this.requires.need-this.requires.has))>0?(this.banClick=!0,[4,T.default.Ins.flyItems(t,n,M.default.Ins.Hero.curPos,this.centerPos,function(){h.default.reduceByList([t],[1]),o.requires.gain(1)})]):[3,3];case 2:return r.sent(),this.banClick=!1,[3,4];case 3:f.default.Ins.showDialogByTxt("\u6211\u8fd8\u9700\u8981\u627e\u4e00\u70b9"+config.Item.getById(t).name),r.label=4;case 4:return[2]}})})},e.prototype.enterTeleport=function(t){return a(this,void 0,void 0,function(){var e,n=this;return s(this,function(o){switch(o.label){case 0:return w.default.Ins.blockTouch(),[4,h.default.enterStory()];case 1:return o.sent(),P.default.Ins.topNodeLayer(M.default.Ins.Hero.node),e=cc.v2(this.teleportPosition),P.default.Ins.focusToLpAsync(e),M.default.Ins.moveToPos(e,this.centerCrd,function(){return a(n,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return this.isPlayerInTeleport=!0,this.targetRegionId=t,[4,I.delay(1e3)];case 1:return e.sent(),u.AM.play(this.getComponent(cc.Animation),"enter"),[2]}})})}),[2]}})})},e.prototype.exitTeleport=function(){return a(this,void 0,void 0,function(){return s(this,function(){return u.AM.play(this.getComponent(cc.Animation),"exit"),[2]})})},e.prototype.init=function(t){if(P.default.Ins.getGrid(this.centerCrd).on(O.EGridEvent.Explored,this.refresh,this),t)this.stateIdx=t.state,this.setState(this.stateIdx,!0),this.isFinish?(this.requires=null,this.tipsCom.node.active=!1):(this.initRequire(t.requireId,t.requireNeed),this.requires.has=t.requireHas);else{var e=this.region.cfg.teleportIds,n=this.region.cfg.teleportNum;this.initRequire(e[0],n[0]),this.setState(0,!0)}this.refresh()},e.prototype.initRequire=function(t,e){var n=this;this.requires=new C.RequireInfo(t,e),this.requires.finishFunc=function(){n.setState(n.stateIdx+1)},this.requires.numChangeFunc=function(){n.tipsCom.num.string=n.requires.has+"/"+n.requires.need,n.tipsCom.progress.fillRange=n.requires.has/n.requires.need},this.tipsCom.num.string=this.requires.has+"/"+this.requires.need,this.tipsCom.icon.spriteFrame=d.default.Ins.getSprite(config.Item.getById(t).url),this.tipsCom.progress.fillRange=0;var o=this.tipsCom.requireRoot.getComponent(cc.Animation);u.AM.play(o,"enter"),o.once(cc.Animation.EventType.FINISHED,function(){return u.AM.play(o,"idle")},this)},e.prototype.refresh=function(){var t=P.default.Ins.getGrid(this.centerCrd);this.tipsCom.node.active=!this.isFinish&&t.isExplored,this.sprite.enabled=t.isExplored},e.prototype.A_teleportStart=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return this.isPlayerInTeleport=!1,t=P.default.Ins.getRegionById(this.targetRegionId),M.default.Ins.Hero.hide(),[4,T.default.Ins.showTeleportTips(this.centerPos)];case 1:return e.sent(),t.isHeartRegion?[4,P.default.Ins.heartCtrl.exitTeleport()]:[3,3];case 2:return e.sent(),[3,5];case 3:return[4,t.teleport.exitTeleport()];case 4:e.sent(),e.label=5;case 5:return[2]}})})},e.prototype.A_teleportExit=function(){return a(this,void 0,void 0,function(){var t,e=this;return s(this,function(n){switch(n.label){case 0:return this.isPlayerInTeleport=!0,P.default.Ins.focusToLpAsync(this.centerPos),M.default.Ins.teleportTo(this.centerCrd),M.default.Ins.Hero.setLayerPos(cc.v2(this.teleportPosition)),M.default.Ins.Hero.show(),[4,T.default.Ins.showTeleportTips(this.centerPos)];case 1:return n.sent(),t=P.default.Ins.findCrdSideOfStructObj(this),M.default.Ins.moveToPos(P.default.Ins.crd2lp(t),t,function(){return a(e,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this.isPlayerInTeleport=!1,P.default.Ins.normalNodeLayer(M.default.Ins.Hero.node),[4,h.default.exitStory()];case 1:return t.sent(),w.default.Ins.unblockTouch(),[2]}})})}),[2]}})})},e.prototype.update=function(){if(b.default.Ins.timeScale,this.isPlayerInTeleport&&M.default.Ins.Hero.setLayerPos(cc.v2(this.teleportPosition)),this.isFinish){var t=p.default.Ins.findResNum(2);this.costLabel.string=t+"/3",this.costLabel.node.color=t>=3?cc.Color.BLACK:cc.Color.RED}},e.prototype.setState=function(t,e){return void 0===e&&(e=!1),a(this,void 0,void 0,function(){var n,o,r,i;return s(this,function(a){switch(a.label){case 0:return this.stateIdx=t,e?[3,3]:(w.default.Ins.blockTouch(),h.default.enterStory(),y.default.getUI(m.default).show(),[4,P.default.Ins.focusToLpAsync(this.centerPos)]);case 1:return a.sent(),[4,I.delay(500)];case 2:a.sent(),a.label=3;case 3:return n=this.getComponent(cc.Animation),this.isFinish?(this.teleportTipsRoot.active=!0,this.tipsCom.requireRoot.getComponent(cc.Animation).play("exit"),o=this.getComponent(cc.Animation),l.default.send(l.E_FinishTeleport,this),u.AM.play(o,"finish"),o.once(cc.Animation.EventType.FINISHED,function(){return u.AM.play(o,"idle"+(t+1))})):(this.teleportTipsRoot.active=!1,u.AM.play(n,"idle"+(t+1)),r=this.region.cfg.teleportIds,i=this.region.cfg.teleportNum,this.initRequire(r[this.stateIdx],i[this.stateIdx])),e?[3,7]:[4,I.delay(500)];case 4:return a.sent(),[4,h.default.exitStory()];case 5:return a.sent(),y.default.getUI(m.default).hide(),w.default.Ins.unblockTouch(),[4,P.default.Ins.returnToPlayer()];case 6:a.sent(),a.label=7;case 7:return[2]}})})},e.prototype.load=function(t,e){this.centerCrd=e,this.region=t},i([S(cc.Node)],e.prototype,"teleportPos",void 0),i([S(cc.Node)],e.prototype,"teleportTipsRoot",void 0),i([S(cc.Label)],e.prototype,"costLabel",void 0),i([S(cc.Sprite)],e.prototype,"sprite",void 0),i([S(c.default)],e.prototype,"tipsCom",void 0),i([k],e)}(cc.Component);n.default=U,cc._RF.pop()},{"../../../AutoScripts/Tips_Auto":"Tips_Auto","../../../Managers/AnimationManager":"AnimationManager","../../../Managers/EventCenter":"EventCenter","../../../Mgr/DialogMgr":"DialogMgr","../../../Model/Inventory":"Inventory","../../../Operator":"Operator","../../../Res":"Res","../../../UI/FairyUI/U_MapWindow":"U_MapWindow","../../../UI/UI":"UI","../../../UI/U_Modal":"U_Modal","../../../UI/U_PopupTips":"U_PopupTips","../../../UI/U_TaskTips":"U_TaskTips","../../../Utils/CocosExtension":"CocosExtension","../../GameManager":"GameManager","../../HeartCtrl":"HeartCtrl","../../Player/PlayerCtrl":"PlayerCtrl","../../TouchCtrl/MainTouchCtrl":"MainTouchCtrl","../MapCtrl":"MapCtrl","../TileGrid":"TileGrid","../TileTips":"TileTips"}],TileDrops:[function(t,e,n){"use strict";cc._RF.push(e,"683fcXs2ZVBA66Ez9s7tOc3","TileDrops");var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,i=r.ccclass,a=(r.property,function(){function t(t,e){this.resId=t,this.num=e}return o([i],t)}());n.default=a,cc._RF.pop()},{}],TileGrid:[function(t,e,n){"use strict";cc._RF.push(e,"f2765kNs9VMurs/USa0rGrR","TileGrid");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.EGridEvent=n.EGridState=void 0;var a,s,c=t("../../Factory"),u=t("../../Operator"),l=t("../../Utils/CocosExtension"),f=t("./MapCtrl"),p=t("../../UI/UI"),h=t("./TileTips"),d=t("../Player/PlayerCtrl"),g=t("../../UI/U_TaskTips"),y=t("../GameManager"),m=t("./TileObjects/BlockObj"),_=t("../../Managers/EventCenter"),v=t("../../CollectMgr"),I=t("./TileDrops");(function(t){t[t.Unexplored=0]="Unexplored",t[t.Visible=1]="Visible"})(a=n.EGridState||(n.EGridState={})),function(t){t.PlayerAtk="PlayerAtk",t.MonsterAtk="MonsterAtk",t.Visible="Visible",t.Invisible="Invisible",t.PlayerMove="PlayerMove",t.PlayerExit="PlayerExit",t.InputClick="InputClick",t.MonsterMove="MonsterMove",t.Explored="Explored",t.EnvHurt="Exploded"}(s=n.EGridEvent||(n.EGridEvent={}));var b=function(){function t(){this._object=null,this._ground=null,this.withAreas=[],this._isExplored=!1,this.touchObjs=[],this.shakeTween=null,this.isInShake=!1,this.initGid=0}return Object.defineProperty(t.prototype,"object",{get:function(){return this._object},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ground",{get:function(){return this._ground},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"getGridData",{get:function(){return{ground_gid:this.ground?this.ground.gid:0,object_gid:this.object?this.object.cfg.gid:0,ore_gid:this.oreCfg?this.oreCfg.gid:0,isExplored:this.isExplored}},enumerable:!1,configurable:!0}),t.prototype.update=function(t){t*=y.default.Ins.timeScale,this.object&&this.object.onUpdate(t)},t.prototype.shakeTile=function(){return o(this,void 0,void 0,function(){var t=this;return r(this,function(){return[2,new Promise(function(e){var n=f.default.Ins.getTiledTile(t.crd,f.ETileLayer.Object),o=f.default.Ins.getTiledTile(t.crd,f.ETileLayer.Ore),r=n.node.x,i={v:0},a=function(){n&&(n.node.x=r+i.v),o&&(o.node.x=r+i.v)};t.shakeTween=cc.tween(i).to(.05,{v:-2},{onUpdate:function(){return a()}}).to(.05,{v:2},{onUpdate:function(){return a()}}).to(.05,{v:-2},{onUpdate:function(){return a()}}).to(.05,{v:2},{onUpdate:function(){return a()}}).to(.05,{v:-2},{onUpdate:function(){return a()}}).to(.05,{v:0},{onUpdate:function(){return a()}}).call(function(){e(),t.shakeTween=null}).start()})]})})},t.prototype.onActiveRegion=function(){var t;null===(t=this.object)||void 0===t||t.onActiveRegion()},t.prototype.onDeactiveRegion=function(){var t;null===(t=this.object)||void 0===t||t.onDeactiveRegion()},t.prototype.continueShake=function(){return o(this,void 0,void 0,function(){return r(this,function(t){switch(t.label){case 0:h.default.Ins.showShakeTileTips(this,null),this.isInShake=!0,t.label=1;case 1:return this.isInShake?[4,this.shakeTile()]:[2];case 2:return t.sent(),[4,l.delay(500)];case 3:return t.sent(),[3,1];case 4:return[2]}})})},t.prototype.endShake=function(){h.default.Ins.hideShakeTileTips(this),this.isInShake=!1,this.shakeTween&&(this.shakeTween.stop(),this.shakeTween=null)},t.prototype.on=function(t,e,n){_.default.on(t+"_TileGrid"+this.id,e,n)},t.prototype.off=function(t,e,n){_.default.off(t+"_TileGrid"+this.id,e,n)},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];_.default.send.apply(_.default,i([t+"_TileGrid"+this.id],e))},t.prototype.isItemFrom=function(t){var e=this.object;if(e&&e.blockCfg)for(var n=0;n<e.blockCfg.dropsId.length;n++)if(e.blockCfg.dropsId[n]==t)return!0;return!1},t.prototype.load=function(e,n,o){this.id=t.cnt++,this.map=e,this.crd=n,this.initGid=o.object_gid,this._object=c.default.getTileObjectByGid(o.object_gid),this._ground=c.default.getTileGround(o.ground_gid),this.oreCfg=config.MapOre.list.find(function(t){return t.gid==o.ore_gid}),this._isExplored=o.isExplored,this.withAreas=[]},t.prototype.init=function(){this._object&&this._object.init(this);var t=this._object;t&&this.oreCfg&&(t.drops.push(new I.default(this.oreCfg.dropsId,this.oreCfg.dropsNum)),l.hasStr(this.oreCfg.type,"key")&&this.continueShake()),this.oreCfg&&this.oreCfg.sparkle>0&&h.default.Ins.openBlingbling(this,this.oreCfg.sparkle),this.refreshState()},Object.defineProperty(t.prototype,"diggable",{get:function(){return!!(this.object&&this.object instanceof m.default)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBlockVisual",{get:function(){return!!(this._object&&this._object.cfg&&this.object.cfg.isBlockVisual)||this._structObj&&this._structObj.isBlockVisual},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return!this.object&&!this._structObj},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isBlockMove",{get:function(){return!!this.object&&this._object.cfg&&this.object.cfg.isBlockMove||this._structObj&&this._structObj.isBlockMove},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.state==a.Visible},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExplored",{get:function(){return this._isExplored},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pos",{get:function(){return f.default.Ins.crd2lp(this.crd)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHome",{get:function(){return this._object&&this._object.cfg&&l.hasStr(this._object.cfg.type,"home")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isMonster",{get:function(){return this._object&&this._object.cfg&&l.hasStr(this._object.cfg.type,"monster")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChest",{get:function(){return this._object&&this._object.cfg&&l.hasStr(this._object.cfg.type,"chest")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isCrystal",{get:function(){return this.isBlockVisual&&l.hasStr(this._object.cfg.type,"crystal")},enumerable:!1,configurable:!0}),t.prototype.toStr=function(){return"("+this.crd.x+","+this.crd.y+")init by"+this.initGid+","+(this._object?this._object.toStr():"no obj")},t.prototype.setExplored=function(t){var e=this._isExplored;this._isExplored=t,this._object&&this._object.cfg&&v.default.Ins.collectBlock(this._object.cfg.id),!e&&t&&this.emit(s.Explored,this),this.refreshState()},t.prototype.exploded=function(t){return o(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return this.object?[4,this.object.exploded(t)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.clearObj=function(){var t,e;h.default.Ins.closeBlingbling(this),null===(t=this.object)||void 0===t||t.clear(),this._object=null,this.map.setTile(this.crd,0,f.ETileLayer.Object),this.map.setTile(this.crd,0,f.ETileLayer.Ore),this.oreCfg=null,this.endShake(),this.refreshState(),null===(e=f.default.Ins.getRegionByCrd(this.crd))||void 0===e||e.removeObj(this)},t.prototype.addTouchable=function(t){this.touchObjs.push(t)},t.prototype.removeTouchable=function(t){this.touchObjs.splice(this.touchObjs.findIndex(function(e){return e==t}),1)},t.prototype.onTouchGrid=function(){this.state==a.Unexplored?(p.default.getUI(g.default).setData(u.ETaskErrorCode.Unexplored,[this]),h.default.Ins.highLightTile(this,cc.Color.RED)):(h.default.Ins.highLightTile(this),this._object?this._object.onClick():this._structObj?this._structObj.onClick():d.default.Ins.moveToGrid(this.crd)),this.emit(s.InputClick)},t.prototype.onBuildWork=function(){return o(this,void 0,void 0,function(){return r(this,function(){return this.object,[2]})})},t.prototype.setObj=function(t){var e;t?(this._object=t,t.grid=this,this.map.setTile(this.crd,t.cfg.gid,f.ETileLayer.Object),t.init(this),null===(e=f.default.Ins.getRegionByCrd(this.crd))||void 0===e||e.addObj(this)):this._object=null,this.refreshState()},t.prototype.setGround=function(t){this._ground=t,this.map.setTile(this.crd,t.gid,f.ETileLayer.Object)},t.prototype.refreshState=function(){var t=this.state;switch(this.state=this.isExplored?a.Visible:a.Unexplored,this.state){case a.Unexplored:f.default.Ins.setTile(this.crd,f.mask_invisiable,f.ETileLayer.Mask);break;case a.Visible:f.default.Ins.setTile(this.crd,0,f.ETileLayer.Mask),t!=this.state&&this.emit(s.Visible)}},t.cnt=0,t}();n.default=b,cc._RF.pop()},{"../../CollectMgr":"CollectMgr","../../Factory":"Factory","../../Managers/EventCenter":"EventCenter","../../Operator":"Operator","../../UI/UI":"UI","../../UI/U_TaskTips":"U_TaskTips","../../Utils/CocosExtension":"CocosExtension","../GameManager":"GameManager","../Player/PlayerCtrl":"PlayerCtrl","./MapCtrl":"MapCtrl","./TileDrops":"TileDrops","./TileObjects/BlockObj":"BlockObj","./TileTips":"TileTips"}],TileGround:[function(t,e,n){"use strict";cc._RF.push(e,"ae403jH+RpP74u0J61mrOvN","TileGround"),Object.defineProperty(n,"__esModule",{value:!0});n.default=function(t){this.gid=0,this.gid=t},cc._RF.pop()},{}],TileObject:[function(t,e,n){"use strict";cc._RF.push(e,"4ae86WmWgNKG5zEZhSXtWMm","TileObject");var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},r=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../../Utils/CocosExtension"),a=t("../../Player/PlayerCtrl"),s=t("../MapCtrl"),c=function(){function t(t){this.onClear=null,this.drops=[],this.shakeTween=null,this.isShake=!1,this._objId=t}return Object.defineProperty(t.prototype,"objId",{get:function(){return this._objId},enumerable:!1,configurable:!0}),t.prototype.clear=function(){this.onClear&&this.onClear(this.grid),this.onClear=null,this.grid=null},t.prototype.init=function(t){this.grid=t},t.prototype.onActiveRegion=function(){},t.prototype.onDeactiveRegion=function(){},t.prototype.startShake=function(t,e){return o(this,void 0,void 0,function(){return r(this,function(n){switch(n.label){case 0:this.isShake=!0,n.label=1;case 1:return this.isShake?[4,this.tweenShake(t)]:[2];case 2:return n.sent(),[4,i.delay(e)];case 3:return n.sent(),[3,1];case 4:return[2]}})})},t.prototype.tweenShake=function(t){return o(this,void 0,void 0,function(){var e=this;return r(this,function(){return[2,new Promise(function(n){var o=s.default.Ins.getTiledTile(e.grid.crd,s.ETileLayer.Object),r=o.node.x,i=t/6;e.shakeTween=cc.tween(o.node).to(i,{x:r+5}).to(i,{x:r-5}).to(i,{x:r+5}).to(i,{x:r-5}).to(i,{x:r+5}).to(i,{x:r}).call(function(){e.shakeTween=null,n()}).start()})]})})},t.prototype.endShake=function(){var t;this.isShake=!1,null===(t=this.shakeTween)||void 0===t||t.stop()},t.prototype.onClick=function(){a.default.Ins.moveToGrid(this.grid.crd)},t.prototype.exploded=function(){return o(this,void 0,void 0,function(){return r(this,function(){return[2]})})},t.prototype.onUpdate=function(){},Object.defineProperty(t.prototype,"cfg",{get:function(){return config.MapObject.getById(this.objId)},enumerable:!1,configurable:!0}),t.prototype.toStr=function(){return this.constructor.name+": "+this.cfg.name},t}();n.default=c,cc._RF.pop()},{"../../../Utils/CocosExtension":"CocosExtension","../../Player/PlayerCtrl":"PlayerCtrl","../MapCtrl":"MapCtrl"}],TileTips:[function(t,e,n){"use strict";cc._RF.push(e,"6c80bQ8E+BEza/miOrsu0Ap","TileTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../ChestAnim"),u=t("../../Managers/AnimationManager"),l=t("../../Managers/PoolManager"),f=t("../../Model/Inventory"),p=t("../../Res"),h=t("../../TileTipsView/BlockCrack"),d=t("../../UI/Tips/FlyIcon"),g=t("../../UI/Tips/GetItemTips"),y=t("../../Utils/CocosExtension"),m=t("../DamageTxt"),_=t("../Drops"),v=t("./MapCtrl"),I=cc._decorator,b=I.ccclass,C=I.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.p_damageTxt=null,e.p_crackPrefab=null,e.p_highLightPrefab=null,e.p_warnPrefab=null,e.p_dropsPrefab=null,e.p_getResText=null,e.p_blingbling=null,e.p_fullHighLightPrefab=null,e.selectTileMap=new Map,e.blingblingMap=new Map,e.craftTipsMap=new Map,e.doorTipsMap=new Map,e.bombMap=new Map,e.bombCnt=0,e.shakeTileTipsMap=new Map,e}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return n.instance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tileNodes",{get:function(){return v.default.Ins.tileNodes},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this},Object.defineProperty(e.prototype,"map",{get:function(){return v.default.Ins},enumerable:!1,configurable:!0}),e.prototype.highLightTile=function(t,e,n,o,r){void 0===e&&(e=cc.Color.WHITE),void 0===n&&(n=150),void 0===o&&(o=function(){}),void 0===r&&(r=.5);var i=l.PoolManager.GetPrefab(this.p_highLightPrefab);i.setParent(this.tileNodes),i.position=cc.v3(t.pos),i.color=e,i.width=this.map.tileSize.width,i.height=this.map.tileSize.height,i.opacity=n,cc.tween(i).to(r,{opacity:0}).call(function(){l.PoolManager.PutPrefab(i)}).call(function(){o&&o()}).start()},e.prototype.fullHighLightTile=function(t,e,n,o,r){void 0===e&&(e=cc.Color.WHITE),void 0===n&&(n=150),void 0===o&&(o=function(){}),void 0===r&&(r=.5);var i=l.PoolManager.GetPrefab(this.p_fullHighLightPrefab);i.setParent(this.tileNodes),i.position=cc.v3(t.pos),i.color=e,i.width=this.map.tileSize.width,i.height=this.map.tileSize.height,i.opacity=n,cc.tween(i).to(r,{opacity:0}).call(function(){l.PoolManager.PutPrefab(i)}).call(function(){o&&o()}).start()},e.prototype.selectTile=function(t){var e=l.PoolManager.GetPrefab(this.p_highLightPrefab);e.setParent(this.tileNodes),e.position=cc.v3(t.pos),e.color=cc.Color.YELLOW,e.width=this.map.tileSize.width,e.height=this.map.tileSize.height,e.opacity=100,this.selectTileMap.set(t,e)},e.prototype.cancelSelectTile=function(t){var e=this.selectTileMap.get(t);e&&(l.PoolManager.PutPrefab(e),this.selectTileMap.delete(t))},e.prototype.setBurst=function(t,e,n,o){void 0===o&&(o=.5);for(var r=function(){var n=l.PoolManager.GetPrefab(p.default.Ins.rowSprite);n.setParent(i.tileNodes),n.position=cc.v3(t.pos),n.getComponent(cc.Sprite).spriteFrame=p.default.Ins.getSprite(e),n.scale=1,cc.tween(n).to(o,{position:i.distributeTargetPos(50,50)},{easing:cc.easing.quadOut}).to(.5,{scale:0},{easing:cc.easing.backIn}).call(function(){l.PoolManager.PutPrefab(n)}).start()},i=this,a=0;a<n;a++)r()},e.prototype.distributeTargetPos=function(t,e){var n=cc.v2(Math.random()*t-t/2,Math.random()*e-e/2);return cc.v3(n)},e.prototype.getCrackIdx=function(t){var e=1-t;return e<=.3?0:e<=.7?1:e<=1?2:-1},e.prototype.crackBlock=function(t,e,o,r){var i;void 0===r&&(r=function(){}),n.crackMap.has(t)?i=n.crackMap.get(t):(i=l.PoolManager.GetPrefab(this.p_crackPrefab),n.crackMap.set(t,i)),i.setParent(this.tileNodes),i.position=cc.v3(t.pos),i.getComponent(h.default).setData(this.getCrackIdx(e),o,function(){r&&r(),n.crackMap.delete(t),l.PoolManager.PutPrefab(i)})},e.prototype.breakBlock=function(t,e){this.crackBlock(t,-1,e,null)},e.prototype.warnGrid=function(t,e){var n=l.PoolManager.GetPrefab(this.p_warnPrefab);n.setParent(this.mapUI),n.position=cc.v3(v.default.Ins.crd2lp(t.crd)),n.opacity=255,cc.tween(n).to(e,{opacity:0}).call(function(){l.PoolManager.PutPrefab(n)}).start()},e.prototype.getDrops=function(t,e,n){var o=l.PoolManager.GetPrefab(this.p_dropsPrefab).getComponent(_.default);o.node.setParent(this.tileNodes),o.node.position=cc.v3(t.pos),o.setData(t,e,n)},e.prototype.setDamageText=function(t,e,n){var o=l.PoolManager.GetPrefab(this.p_damageTxt).getComponent(m.default),r=cc.v2(20*Math.random()-10,20*Math.random()-10);o.node.setParent(this.mapUI),o.node.position=cc.v3(t.add(r)),o.setData(e,n)},e.prototype.setGetResText=function(t,e,n){var o=l.PoolManager.GetPrefab(this.p_getResText).getComponent(g.default),r=config.Item.getById(e);o.node.setParent(this.mapUI),o.node.position=cc.v3(t),o.setData(r.name+"+"+n,cc.Color.fromHEX(cc.color(),config.QualityColor.getById(r.quality).color))},e.prototype.openBlingbling=function(t,e){var n;this.blingblingMap.has(t)?n=this.blingblingMap.get(t):(n=l.PoolManager.GetPrefab(this.p_blingbling),this.blingblingMap.set(t,n)),n.setParent(this.mapUI),n.position=cc.v3(v.default.Ins.crd2lp(t.crd)),u.AM.play(n.getComponent(cc.Animation),"blingbling"+e)},e.prototype.closeBlingbling=function(t){var e=this.blingblingMap.get(t);e&&(l.PoolManager.PutPrefab(e),this.blingblingMap.delete(t))},e.prototype.setTips=function(t,e,n,o){var r=l.PoolManager.GetPrefab(this.p_labelTips);r.setParent(this.mapUI),r.position=cc.v3(t.pos.add(e)),r.getComponent(cc.Label).string=n,r.opacity=255,cc.tween(r).to(o,{opacity:0}).call(function(){return l.PoolManager.PutPrefab(r)}).start()},e.prototype.setCraftTips=function(t,e){var n=this.craftTipsMap.get(t);if(!n){if(0==e)return;n=l.PoolManager.GetPrefab(this.p_craftTips),this.craftTipsMap.set(t,n),n.setParent(this.mapUI),n.position=cc.v3(t.pos)}0==e&&(l.PoolManager.PutPrefab(n),this.craftTipsMap.delete(t));var o="";switch(e){case 1:o="crafting";break;case 2:o="crafted";break;case 3:o="newRecipe"}n.getComponent(cc.Animation).play(o)},e.prototype.showOpenTheDoor=function(t,e){return a(this,void 0,void 0,function(){var n=this;return s(this,function(){return[2,new Promise(function(o){var r=l.PoolManager.GetPrefab(n.p_openTheDoorAnim);r.setParent(n.tileNodes),r.position=cc.v3(v.default.Ins.crd2lp(t.crd));var i=r.getComponent(cc.Animation);u.AM.play(i,e),i.clear(),i.once(cc.Animation.EventType.FINISHED,function(){l.PoolManager.PutPrefab(r),o()},n)})]})})},e.prototype.showDoorTips=function(t,e){var n=config.Item.getById(e),o=l.PoolManager.GetPrefab(this.p_doorTips);o.setParent(this.mapUI),o.position=cc.v3(v.default.Ins.crd2lp(t.crd).add(cc.v2(0,50)));var r=o.getChildByName("root");r.getChildByName("sprite").getComponent(cc.Sprite).spriteFrame=p.default.Ins.getSprite(n.url);var i=f.default.Ins.findResNum(e),a=r.getChildByName("label").getComponent(cc.Label);a.string="\u62e5\u6709"+i,a.node.color=i>=1?cc.Color.BLACK:cc.Color.RED;var s=o.getComponent(cc.Animation);u.AM.play(s,"enter"),s.clear(),s.once(cc.Animation.EventType.FINISHED,function(){u.AM.play(s,"idle")}),this.doorTipsMap.set(t,o)},e.prototype.hideDoorTips=function(t){var e=this.doorTipsMap.get(t);if(e){this.doorTipsMap.delete(t);var n=e.getComponent(cc.Animation);u.AM.play(n,"exit"),n.clear(),n.once(cc.Animation.EventType.FINISHED,function(){l.PoolManager.PutPrefab(e)})}},e.prototype.setBoomAnim=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){var o=l.PoolManager.GetPrefab(e.p_boomEffect);o.setParent(e.tileNodes),o.position=cc.v3(v.default.Ins.crd2lp(t.crd));var r=o.getComponent(cc.Animation);u.AM.play(r,"boomAnim"),r.clear(),r.once(cc.Animation.EventType.FINISHED,function(){l.PoolManager.PutPrefab(o),n()})})]})})},e.prototype.setBombAnim=function(t,e){var n=this.bombCnt++,o=l.PoolManager.GetPrefab(this.p_bombEffect);o.setParent(this.tileNodes),o.position=cc.v3(v.default.Ins.crd2lp(t.crd));var r=o.getComponent(cc.Animation);return u.AM.play(r,e),this.bombMap.set(n,o),n},e.prototype.hideBombAnim=function(t){var e=this.bombMap.get(t);e&&(this.bombMap.delete(t),l.PoolManager.PutPrefab(e))},e.prototype.flyIcon=function(t,e,n,o,r){void 0===r&&(r=!0);var i=l.PoolManager.GetPrefab(this.p_flyIcon);i.setParent(this.mapUI),i.getComponent(d.default).setData(config.Item.getById(t).url,e,n,o,r)},e.prototype.flyIcon2=function(t,e,n,o,r){void 0===r&&(r=!0);var i=l.PoolManager.GetPrefab(this.p_flyIcon);i.setParent(this.mapUI),i.getComponent(d.default).setData2(config.Item.getById(t).url,e,n,o)},e.prototype.flyCoin=function(t,e,n,o){void 0===o&&(o=!0);var r=l.PoolManager.GetPrefab(this.p_flyIcon);r.setParent(this.mapUI),r.getComponent(d.default).setData(p.default.coinUrl,t,e,n,o)},e.prototype.showShakeTileTips=function(t){var e=l.PoolManager.GetPrefab(this.p_shakeTileTips);e.setParent(this.tileNodes),e.position=cc.v3(t.pos),this.shakeTileTipsMap.set(t,e)},e.prototype.hideShakeTileTips=function(t){var e=this.shakeTileTipsMap.get(t);e&&(l.PoolManager.PutPrefab(e),this.shakeTileTipsMap.delete(t))},e.prototype.showTeleportTips=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,this.showAnimTipsByPos(this.p_teleportTips,t,"enter")];case 1:return e.sent(),[2]}})})},e.prototype.showAnimTips=function(t,e,n){return a(this,void 0,void 0,function(){var o=this;return s(this,function(){return[2,new Promise(function(r){var i=l.PoolManager.GetPrefab(t);i.setParent(o.tileNodes),i.position=cc.v3(v.default.Ins.crd2lp(e.crd));var a=i.getComponent(cc.Animation);u.AM.play(a,n),a.clear(),a.once(cc.Animation.EventType.FINISHED,function(){l.PoolManager.PutPrefab(i),r()})})]})})},e.prototype.flyItems=function(t,e,n,o,r){return a(this,void 0,void 0,function(){var i=this;return s(this,function(){return[2,new Promise(function(c){return a(i,void 0,void 0,function(){var i,a;return s(this,function(s){switch(s.label){case 0:i=e,a=0,s.label=1;case 1:return a<e?[4,y.delay(50)]:[3,4];case 2:s.sent(),this.flyIcon(t,n,o,function(){i--,r&&r(),i<=0&&c()}),s.label=3;case 3:return a++,[3,1];case 4:return[2]}})})})]})})},e.prototype.showAnimTipsByPos=function(t,e,n){return a(this,void 0,void 0,function(){var o=this;return s(this,function(){return[2,new Promise(function(r){var i=l.PoolManager.GetPrefab(t);i.setParent(o.tileNodes),i.position=cc.v3(e);var a=i.getComponent(cc.Animation);u.AM.play(a,n),a.clear(),a.once(cc.Animation.EventType.FINISHED,function(){l.PoolManager.PutPrefab(i),r()})})]})})},e.prototype.showChestAnim=function(t,e,n){var o=l.PoolManager.GetPrefab(this.p_openChestAnim);o.getComponent(c.default).setData(e,n),o.setParent(v.default.Ins.sortingNode),o.position=cc.v3(v.default.Ins.crd2lp(t.crd))},e.instance=null,e.crackMap=new Map,i([C(cc.Node)],e.prototype,"mapUI",void 0),i([C(cc.Prefab)],e.prototype,"p_damageTxt",void 0),i([C(cc.Prefab)],e.prototype,"p_crackPrefab",void 0),i([C(cc.Prefab)],e.prototype,"p_highLightPrefab",void 0),i([C(cc.Prefab)],e.prototype,"p_warnPrefab",void 0),i([C(cc.Prefab)],e.prototype,"p_dropsPrefab",void 0),i([C(cc.Prefab)],e.prototype,"p_getResText",void 0),i([C(cc.Prefab)],e.prototype,"p_blingbling",void 0),i([C(cc.Prefab)],e.prototype,"p_fullHighLightPrefab",void 0),i([C(cc.Prefab)],e.prototype,"p_labelTips",void 0),i([C(cc.Prefab)],e.prototype,"p_craftTips",void 0),i([C(cc.Prefab)],e.prototype,"p_flyIcon",void 0),i([C(cc.Prefab)],e.prototype,"p_doorTips",void 0),i([C(cc.Prefab)],e.prototype,"p_openTheDoorAnim",void 0),i([C(cc.Prefab)],e.prototype,"p_boomEffect",void 0),i([C(cc.Prefab)],e.prototype,"p_bombEffect",void 0),i([C(cc.Prefab)],e.prototype,"p_shakeTileTips",void 0),i([C(cc.Prefab)],e.prototype,"p_teleportTips",void 0),i([C(cc.Prefab)],e.prototype,"p_openChestAnim",void 0),n=i([b],e)}(cc.Component);n.default=M,cc._RF.pop()},{"../../ChestAnim":"ChestAnim","../../Managers/AnimationManager":"AnimationManager","../../Managers/PoolManager":"PoolManager","../../Model/Inventory":"Inventory","../../Res":"Res","../../TileTipsView/BlockCrack":"BlockCrack","../../UI/Tips/FlyIcon":"FlyIcon","../../UI/Tips/GetItemTips":"GetItemTips","../../Utils/CocosExtension":"CocosExtension","../DamageTxt":"DamageTxt","../Drops":"Drops","./MapCtrl":"MapCtrl"}],TipsBoard:[function(t,e,n){"use strict";cc._RF.push(e,"0c8e3LC5c1BDq3b1niA12WV","TipsBoard");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./Controller/Map/MapCtrl"),s=t("./Controller/Map/TileGrid"),c=t("./UI/FairyUI/U_TitleBoard"),u=t("./UI/UI"),l=cc._decorator,f=l.ccclass,p=l.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.title="hello",e.type=0,e}return r(e,t),Object.defineProperty(e.prototype,"crd",{get:function(){return a.default.Ins.lp2crd(cc.v2(this.node.position))},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.init()},e.prototype.init=function(){a.default.Ins.getGrid(this.crd).on(s.EGridEvent.PlayerMove,this.onPlayerMove,this)},e.prototype.onPlayerMove=function(){u.default.getUI(c.default).setData(this.title,this.type)},i([p],e.prototype,"title",void 0),i([p],e.prototype,"type",void 0),i([f],e)}(cc.Component);n.default=h,cc._RF.pop()},{"./Controller/Map/MapCtrl":"MapCtrl","./Controller/Map/TileGrid":"TileGrid","./UI/FairyUI/U_TitleBoard":"U_TitleBoard","./UI/UI":"UI"}],Tips_Auto:[function(t,e,n){"use strict";cc._RF.push(e,"4d60bENUKtH5rXwTVhezKyM","Tips_Auto");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.requireRoot=null,e.progress=null,e.icon=null,e.num=null,e}return r(e,t),i([c(cc.Node)],e.prototype,"requireRoot",void 0),i([c(cc.Sprite)],e.prototype,"progress",void 0),i([c(cc.Sprite)],e.prototype,"icon",void 0),i([c(cc.Label)],e.prototype,"num",void 0),i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],TouchPad2:[function(t,e,n){"use strict";cc._RF.push(e,"7d800mjNdhCtISzA8fpSaPZ","TouchPad2");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./MapTest"),s=cc._decorator,c=s.ccclass,u=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.map=null,e}return r(e,t),e.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this)},e.prototype.onTouchStart=function(t){var e=t.getLocation();console.log(e.x,e.y);var n=this.node.convertToWorldSpaceAR(e),o=this.map.wp2crd(n);this.map.setTile(o,151)},i([u(a.default)],e.prototype,"map",void 0),i([c],e)}(cc.Component);n.default=l,cc._RF.pop()},{"./MapTest":"MapTest"}],TouchPad:[function(t,e,n){"use strict";cc._RF.push(e,"a8703QjqxFHuYNejdE/phGC","TouchPad");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Map/MapCtrl"),s=t("./MainTouchCtrl"),c=cc._decorator,u=c.ccclass,l=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"tileCtrl",{get:function(){return a.default.Ins},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this)},e.prototype.onTouchStart=function(t){var e=t.getLocation();console.log(e.x,e.y);var n=this.node.convertToWorldSpaceAR(e);s.default.Ins.onTouch(n)},e.prototype.onTouchMove=function(t){s.default.Ins.onMoveGrid(t.getDelta())},e.prototype.onTouchEnd=function(){s.default.Ins.onEndGrid()},e.prototype.onTouchCancel=function(){s.default.Ins.onCancelGrid()},i([u],e)}(cc.Component));n.default=l,cc._RF.pop()},{"../Map/MapCtrl":"MapCtrl","./MainTouchCtrl":"MainTouchCtrl"}],TriggerObj:[function(t,e,n){"use strict";cc._RF.push(e,"be8dfoWJ/ZKEbrKY3YdpPLd","TriggerObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=t("../../Player/PlayerCtrl"),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"isBlockMove",{get:function(){return!1},enumerable:!1,configurable:!0}),e.prototype.onClick=function(){i.default.Ins.moveToGrid(this.grid.crd)},e}(t("./TileObject").default);n.default=a,cc._RF.pop()},{"../../Player/PlayerCtrl":"PlayerCtrl","./TileObject":"TileObject"}],UICtrl:[function(t,e,n){"use strict";cc._RF.push(e,"22f59w0NkFBD6tONhBY+Su0","UICtrl");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}var n;return r(e,t),n=e,Object.defineProperty(e,"Ins",{get:function(){return n.instance},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){n.instance=this},e.prototype.hideTips=function(){},e.prototype.showBackPack=function(){this.hideTips()},e.prototype.showHelp=function(){},e.instance=null,i([c(cc.Node)],e.prototype,"fairyGuiRoot",void 0),n=i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],UINode:[function(t,e,n){"use strict";cc._RF.push(e,"477e9Mpw/5In5reNMOgTaWh","UINode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./UI"),s=cc._decorator,c=s.ccclass,u=s.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.active=!0,e}return r(e,t),e.prototype.onLoad=function(){a.default.registUI(this.constructor,this),console.log("registUI:"+this.constructor.name)},e.prototype.show=function(){this.node.active=!0},e.prototype.hide=function(){this.node.active=!1},e.prototype.start=function(){this.active?this.show():this.hide()},i([u],e.prototype,"active",void 0),i([c],e)}(cc.Component);n.default=l,cc._RF.pop()},{"./UI":"UI"}],UI_Backpack:[function(t,e,n){"use strict";cc._RF.push(e,"38c7b2byqdHqphau7yfIBmy","UI_Backpack");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","Backpack")},e.prototype.onConstruct=function(){this.m_com=this.getChildAt(0),this.m_hideBtn=this.getChildAt(1)},e.URL="ui://a7e9jhhhd3l515",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_CollectionTips:[function(t,e,n){"use strict";cc._RF.push(e,"30c86Xm1/5OmK0Dp6qnoleV","UI_CollectionTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","CollectionTips")},e.prototype.onConstruct=function(){this.m_frame=this.getChildAt(1),this.m_icon=this.getChildAt(2),this.m_name=this.getChildAt(4),this.m_desc=this.getChildAt(5),this.m_enter=this.getTransitionAt(0),this.m_exit=this.getTransitionAt(1)},e.URL="ui://a7e9jhhhp1hk7c",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_CollectionWindow:[function(t,e,n){"use strict";cc._RF.push(e,"d5de60R4EZCyIpxmN94xzpE","UI_CollectionWindow");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","CollectionWindow")},e.prototype.onConstruct=function(){this.m_menu=this.getChildAt(0),this.m_content=this.getChildAt(1),this.m_backBtn=this.getChildAt(2)},e.URL="ui://a7e9jhhhjimz7f",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_ContTips:[function(t,e,n){"use strict";cc._RF.push(e,"ee574OpMcdP0qbzKd8uRrNg","UI_ContTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","ContTips")},e.prototype.onConstruct=function(){this.m_icon=this.getChildAt(2),this.m_title=this.getChildAt(3),this.m_name=this.getChildAt(4),this.m_desc=this.getChildAt(5),this.m_hide=this.getChildAt(8),this.m_rotation=this.getTransitionAt(0),this.m_enter=this.getTransitionAt(1)},e.URL="ui://a7e9jhhhtq5hc0",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_DialogHead:[function(t,e,n){"use strict";cc._RF.push(e,"157d1kFAV9Pt60oMeKFeMUM","UI_DialogHead");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","DialogHead")},e.prototype.onConstruct=function(){this.m_head=this.getChildAt(1),this.m_name=this.getChildAt(3),this.m_title=this.getChildAt(6)},e.URL="ui://a7e9jhhhtq5hbt",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_Dialog:[function(t,e,n){"use strict";cc._RF.push(e,"1df9bvTqhFBt7sFwpXAJ9br","UI_Dialog");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","Dialog")},e.prototype.onConstruct=function(){this.m_com=this.getChildAt(0),this.m_hideBtn=this.getChildAt(1),this.m_t0=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhgt098f",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_HUD:[function(t,e,n){"use strict";cc._RF.push(e,"9c1f5Xj4vFB5YBMpdFpc4i2","UI_HUD");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","HUD")},e.prototype.onConstruct=function(){this.m_topUI=this.getChildAt(0),this.m_bottomUI=this.getChildAt(1),this.m_backpackBtn=this.getChildAt(2),this.m_trackingCraft=this.getChildAt(3),this.m_followBtn=this.getChildAt(4),this.m_posTips=this.getChildAt(5),this.m_collectionBtn=this.getChildAt(6),this.m_coinNum=this.getChildAt(8),this.m_clearBtn=this.getChildAt(9),this.m_saveBtn=this.getChildAt(10),this.m_returnBtn=this.getChildAt(11),this.m_taskBoard=this.getChildAt(12),this.m_mapBtn=this.getChildAt(13),this.m_itemSelect=this.getChildAt(14),this.m_enterTips=this.getTransitionAt(0),this.m_exitTips=this.getTransitionAt(1),this.m_fadeIn=this.getTransitionAt(2),this.m_fadeOut=this.getTransitionAt(3)},e.URL="ui://a7e9jhhhd3l5w",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_ItemDetail:[function(t,e,n){"use strict";cc._RF.push(e,"49f23gvHFpCgaYlTGmfC7ro","UI_ItemDetail");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","ItemDetail")},e.prototype.onConstruct=function(){this.m_icon=this.getChildAt(1),this.m_name=this.getChildAt(2),this.m_type=this.getChildAt(3),this.m_desc=this.getChildAt(4),this.m_quality=this.getChildAt(5),this.m_foodBtn=this.getChildAt(6)},e.URL="ui://a7e9jhhhbbea43",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_MapBottom:[function(t,e,n){"use strict";cc._RF.push(e,"7c653Bex6RNt4avpHHEVeM5","UI_MapBottom");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","MapBottom")},e.prototype.onConstruct=function(){this.m_row1=this.getChildAt(9),this.m_row2=this.getChildAt(18),this.m_row3=this.getChildAt(27),this.m_row4=this.getChildAt(34),this.m_row5=this.getChildAt(45),this.m_row6=this.getChildAt(56),this.m_row7=this.getChildAt(67),this.m_row8=this.getChildAt(76),this.m_row9=this.getChildAt(83),this.m_row10=this.getChildAt(94),this.m_grp=this.getChildAt(95)},e.URL="ui://a7e9jhhhpsjgcd",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_MapBtn:[function(t,e,n){"use strict";cc._RF.push(e,"01c504GKJBA9J1Z0DWV9jXg","UI_MapBtn");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","MapBtn")},e.prototype.onConstruct=function(){this.m_cNew=this.getControllerAt(0),this.m_mapBtn=this.getChildAt(0),this.m_t0=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhpsjgce",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_MapGrp:[function(t,e,n){"use strict";cc._RF.push(e,"749b1iPTR1JqbuG4F+8W2xZ","UI_MapGrp");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","MapGrp")},e.prototype.onConstruct=function(){this.m_bottom=this.getChildAt(0),this.m_top=this.getChildAt(1),this.m_tips=this.getChildAt(2)},e.URL="ui://a7e9jhhhfve19n",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_MapTips:[function(t,e,n){"use strict";cc._RF.push(e,"68a54VZ/8pI34Bc6TAzzake","UI_MapTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","MapTips")},e.prototype.onConstruct=function(){this.m_row1=this.getChildAt(9),this.m_row2=this.getChildAt(18),this.m_row3=this.getChildAt(27),this.m_row4=this.getChildAt(34),this.m_row5=this.getChildAt(45),this.m_row6=this.getChildAt(56),this.m_row7=this.getChildAt(67),this.m_row8=this.getChildAt(76),this.m_row9=this.getChildAt(83),this.m_row10=this.getChildAt(94),this.m_grp=this.getChildAt(95)},e.URL="ui://a7e9jhhhfve19e",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_MapTop:[function(t,e,n){"use strict";cc._RF.push(e,"4c091f6SOhLzbg6eO9VnijM","UI_MapTop");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","MapTop")},e.prototype.onConstruct=function(){this.m_row1=this.getChildAt(10),this.m_row2=this.getChildAt(21),this.m_row3=this.getChildAt(32),this.m_row4=this.getChildAt(43),this.m_row5=this.getChildAt(54),this.m_row6=this.getChildAt(65),this.m_row7=this.getChildAt(76),this.m_row8=this.getChildAt(87),this.m_row9=this.getChildAt(98),this.m_row10=this.getChildAt(109),this.m_grp=this.getChildAt(110)},e.URL="ui://a7e9jhhhfve19c",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_MapWindow:[function(t,e,n){"use strict";cc._RF.push(e,"8b209FkD9ZFaLJJWqibVO7u","UI_MapWindow");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","MapWindow")},e.prototype.onConstruct=function(){this.m_cSelectTeleport=this.getControllerAt(0),this.m_hideBtn=this.getChildAt(1),this.m_map=this.getChildAt(4),this.m_t0=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhfve19g",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_Map:[function(t,e,n){"use strict";cc._RF.push(e,"2c168Gyx55KSqqVIz+xupjv","UI_Map");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","Map")},e.prototype.onConstruct=function(){this.m_grp=this.getChildAt(0)},e.URL="ui://a7e9jhhhfve19f",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_Modal:[function(t,e,n){"use strict";cc._RF.push(e,"041eeCTz1RLBbG47syUAytq","UI_Modal");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","Modal")},e.prototype.onConstruct=function(){this.m_empty=this.getChildAt(0)},e.URL="ui://a7e9jhhhgt098n",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_PopupTips:[function(t,e,n){"use strict";cc._RF.push(e,"1b8f08EBSZGRKQgXbp7BOZJ","UI_PopupTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","PopupTips")},e.prototype.onConstruct=function(){this.m_title=this.getChildAt(1),this.m_cancel=this.getChildAt(2),this.m_confirm=this.getChildAt(3)},e.URL="ui://a7e9jhhhdde5c2",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_ShopBuyItem:[function(t,e,n){"use strict";cc._RF.push(e,"8d811aI+u5Nw4Bcu6oFe10r","UI_ShopBuyItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","ShopBuyItem")},e.prototype.onConstruct=function(){this.m_cEnd=this.getControllerAt(0),this.m_cNew=this.getControllerAt(1),this.m_item=this.getChildAt(1),this.m_name=this.getChildAt(2),this.m_buyBtn=this.getChildAt(3),this.m_price=this.getChildAt(5),this.m_desc=this.getChildAt(7),this.m_t0=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhi6x08y",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_ShopSoldItem:[function(t,e,n){"use strict";cc._RF.push(e,"92338J+yZVLiJeAM8mbiyK8","UI_ShopSoldItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","ShopSoldItem")},e.prototype.onConstruct=function(){this.m_item=this.getChildAt(1),this.m_soldAll=this.getChildAt(2),this.m_num=this.getChildAt(3),this.m_allPrice=this.getChildAt(7),this.m_numSlider=this.getChildAt(8)},e.URL="ui://a7e9jhhhi6x08x",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_Shop:[function(t,e,n){"use strict";cc._RF.push(e,"12d32TW/YpLc5VQtvLMWCLt","UI_Shop");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","Shop")},e.prototype.onConstruct=function(){this.m_cMode=this.getControllerAt(0),this.m_tabList=this.getChildAt(3),this.m_hideBtn=this.getChildAt(4),this.m_buyList=this.getChildAt(5),this.m_soldList=this.getChildAt(6),this.m_craftList=this.getChildAt(7),this.m_coinNum=this.getChildAt(9),this.m_soldTips=this.getChildAt(10)},e.URL="ui://a7e9jhhhi6x08v",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_Springboard:[function(t,e,n){"use strict";cc._RF.push(e,"ae8a7tfQshPSIH8xNpqBEls","UI_Springboard");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","Springboard")},e.prototype.onConstruct=function(){this.m_board=this.getChildAt(0),this.m_title=this.getChildAt(1),this.m_tEnter=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhtq5hb7",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_TaskRequireMenu:[function(t,e,n){"use strict";cc._RF.push(e,"514f70kXrhHOpe9SpLTIhaY","UI_TaskRequireMenu");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","TaskRequireMenu")},e.prototype.onConstruct=function(){this.m_tabList=this.getChildAt(2),this.m_craftPage=this.getChildAt(3),this.m_hideBtn=this.getChildAt(4)},e.URL="ui://a7e9jhhhl1kx4w",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_TaskTips:[function(t,e,n){"use strict";cc._RF.push(e,"ff1d6/+DXhLUKa4NF/UNFXP","UI_TaskTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","TaskTips")},e.prototype.onConstruct=function(){this.m_label=this.getChildAt(1),this.m_t0=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhbbea3q",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_TipsBoard:[function(t,e,n){"use strict";cc._RF.push(e,"1eae11gebBLWIIAqThfg44k","UI_TipsBoard");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","TipsBoard")},e.prototype.onConstruct=function(){this.m_cType=this.getControllerAt(0)},e.URL="ui://a7e9jhhhtq5hbs",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_backpackCom:[function(t,e,n){"use strict";cc._RF.push(e,"c0666Vf8MVCwpTLlRLXqynH","UI_backpackCom");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","backpackCom")},e.prototype.onConstruct=function(){this.m_list=this.getChildAt(1)},e.URL="ui://a7e9jhhhl1kx5a",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_bottomUI:[function(t,e,n){"use strict";cc._RF.push(e,"a7ae5GevgdC0YqEhOC69nFT","UI_bottomUI");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","bottomUI")},e.prototype.onConstruct=function(){this.m_slot1=this.getChildAt(1),this.m_slot2=this.getChildAt(2),this.m_slot3=this.getChildAt(3),this.m_foodBtn=this.getChildAt(4)},e.URL="ui://a7e9jhhhl1kx59",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_bpItem:[function(t,e,n){"use strict";cc._RF.push(e,"da7b2Suj0pGvLRsXQTh0M9j","UI_bpItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","bpItem")},e.prototype.onConstruct=function(){this.m_frame=this.getChildAt(0),this.m_icon=this.getChildAt(1),this.m_num=this.getChildAt(2)},e.URL="ui://a7e9jhhhd3l514",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_buildItem:[function(t,e,n){"use strict";cc._RF.push(e,"05e5amBKsZKHrJyhZ69ZzwQ","UI_buildItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","buildItem")},e.prototype.onConstruct=function(){this.m_cLock=this.getControllerAt(0),this.m_cSelect=this.getControllerAt(1),this.m_icon=this.getChildAt(2),this.m_name=this.getChildAt(4)},e.URL="ui://a7e9jhhhd3l519",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_collectionContentCom:[function(t,e,n){"use strict";cc._RF.push(e,"68839xBoyxJiYg6o7enlsUi","UI_collectionContentCom");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","collectionContentCom")},e.prototype.onConstruct=function(){this.m_list=this.getChildAt(2)},e.URL="ui://a7e9jhhhjimz7y",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_collectionContentItem:[function(t,e,n){"use strict";cc._RF.push(e,"1595dvqjotAOb2OFGmGDkox","UI_collectionContentItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","collectionContentItem")},e.prototype.onConstruct=function(){this.m_item=this.getChildAt(0),this.m_lock=this.getChildAt(1),this.m_name=this.getChildAt(2)},e.URL="ui://a7e9jhhhjimz86",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_collectionMenuCom:[function(t,e,n){"use strict";cc._RF.push(e,"f36f7GkdFFI1K3ciwx0JR4/","UI_collectionMenuCom");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","collectionMenuCom")},e.prototype.onConstruct=function(){this.m_monster=this.getChildAt(2),this.m_block=this.getChildAt(3),this.m_item=this.getChildAt(4)},e.URL="ui://a7e9jhhhjimz7x",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_craftPage:[function(t,e,n){"use strict";cc._RF.push(e,"f884eiOioJPQYuYntFPvHhw","UI_craftPage");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","craftPage")},e.prototype.onConstruct=function(){this.m_list=this.getChildAt(1),this.m_level=this.getChildAt(3),this.m_upgradeBtn=this.getChildAt(5),this.m_lastLv=this.getChildAt(7),this.m_lv=this.getChildAt(8),this.m_lastSlotNum=this.getChildAt(11),this.m_slotNum=this.getChildAt(12),this.m_lastRefreshTime=this.getChildAt(13),this.m_refreshTime=this.getChildAt(14),this.m_addNum=this.getChildAt(16),this.m_upgradeFrame=this.getChildAt(19),this.m_upgradeIcon=this.getChildAt(20),this.m_upgradeNum=this.getChildAt(21)},e.URL="ui://a7e9jhhhu1et5j",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_dialogCom:[function(t,e,n){"use strict";cc._RF.push(e,"5495eiB4ttDIY9AeZu3sw72","UI_dialogCom");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","dialogCom")},e.prototype.onConstruct=function(){this.m_cLeft=this.getControllerAt(0),this.m_head=this.getChildAt(2),this.m_text=this.getChildAt(3),this.m_continue=this.getChildAt(4)},e.URL="ui://a7e9jhhhtq5hbv",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_dialogContinue:[function(t,e,n){"use strict";cc._RF.push(e,"fcaeceDM2lApY2KC2Fk6cKf","UI_dialogContinue");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","dialogContinue")},e.prototype.onConstruct=function(){this.m_cLeft=this.getControllerAt(0)},e.URL="ui://a7e9jhhhtq5hbu",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_frame:[function(t,e,n){"use strict";cc._RF.push(e,"4abf2u3wRZCGoYHJ3/T3e0w","UI_frame");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","frame")},e.prototype.onConstruct=function(){this.m_hasQuality=this.getControllerAt(0),this.m_cQuality=this.getControllerAt(1)},e.URL="ui://a7e9jhhhbbea4h",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_itemSelectPanel:[function(t,e,n){"use strict";cc._RF.push(e,"643deZP+WlFop1y9l9+g0Cv","UI_itemSelectPanel");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","itemSelectPanel")},e.prototype.onConstruct=function(){this.m_backPackCom=this.getChildAt(0),this.m_hideBtn=this.getChildAt(1)},e.URL="ui://a7e9jhhhd3l51y",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_lockFrame:[function(t,e,n){"use strict";cc._RF.push(e,"6e733b2aQJLYry2Nlen5BTx","UI_lockFrame");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","lockFrame")},e.prototype.onConstruct=function(){this.m_cQuality=this.getControllerAt(0)},e.URL="ui://a7e9jhhhjimz8e",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_mapLockNode:[function(t,e,n){"use strict";cc._RF.push(e,"a4614WeEMBCrJHXcswWsp7p","UI_mapLockNode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","mapLockNode")},e.prototype.onConstruct=function(){this.m_tActive=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhfve19d",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_mapTipsNode:[function(t,e,n){"use strict";cc._RF.push(e,"a7f26+d34tNWrx1IxlG9UIL","UI_mapTipsNode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","mapTipsNode")},e.prototype.onConstruct=function(){this.m_cActive=this.getControllerAt(0),this.m_cSign=this.getControllerAt(1),this.m_cHeart=this.getControllerAt(2),this.m_cTeleport=this.getControllerAt(3),this.m_cSelect=this.getControllerAt(4),this.m_pos=this.getTransitionAt(0),this.m_t1=this.getTransitionAt(1),this.m_t2=this.getTransitionAt(2)},e.URL="ui://a7e9jhhhpsjgcc",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_mapUnlockNode:[function(t,e,n){"use strict";cc._RF.push(e,"95dcf93O4lIhaZxMrWaJ97y","UI_mapUnlockNode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","mapUnlockNode")},e.prototype.onConstruct=function(){this.m_title=this.getChildAt(1),this.m_pos=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhfve19m",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_matItem:[function(t,e,n){"use strict";cc._RF.push(e,"6e6cdmIRKJPjYIjF+PYLp/1","UI_matItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","matItem")},e.prototype.onConstruct=function(){this.m_cHideNum=this.getControllerAt(0),this.m_frame=this.getChildAt(0),this.m_icon=this.getChildAt(1),this.m_label=this.getChildAt(2)},e.URL="ui://a7e9jhhhd3l517",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_newTips:[function(t,e,n){"use strict";cc._RF.push(e,"50224xFF+ZIJY+RUvuTg5+3","UI_newTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","newTips")},e.prototype.onConstruct=function(){this.m_t0=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhdde5c1",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_posTips:[function(t,e,n){"use strict";cc._RF.push(e,"d8f58fccsZMPquHAPeha+6+","UI_posTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","posTips")},e.prototype.onConstruct=function(){this.m_arrow=this.getChildAt(0)},e.URL="ui://a7e9jhhhu1et5i",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_requireTaskItem:[function(t,e,n){"use strict";cc._RF.push(e,"8efed8MmLNCVb7Mp4UpdjF0","UI_requireTaskItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","requireTaskItem")},e.prototype.onConstruct=function(){this.m_cStatus=this.getControllerAt(0),this.m_taskItem=this.getChildAt(1),this.m_refreshTime=this.getChildAt(3),this.m_from=this.getChildAt(6)},e.URL="ui://a7e9jhhhl1kx4v",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_requireTaskReward:[function(t,e,n){"use strict";cc._RF.push(e,"92debbJKyVCr6pSPYxXt0i2","UI_requireTaskReward");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","requireTaskReward")},e.prototype.onConstruct=function(){this.m_c1=this.getControllerAt(0),this.m_frame=this.getChildAt(0),this.m_targetIcon=this.getChildAt(1),this.m_coinNum2=this.getChildAt(3),this.m_coinNum=this.getChildAt(5)},e.URL="ui://a7e9jhhhgt098o",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_requireTaskSubCom:[function(t,e,n){"use strict";cc._RF.push(e,"b9186R6iPpOWKm76X9GJSFh","UI_requireTaskSubCom");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","requireTaskSubCom")},e.prototype.onConstruct=function(){this.m_cFinish=this.getControllerAt(0),this.m_matList=this.getChildAt(1),this.m_trackBtn=this.getChildAt(2),this.m_finishBtn=this.getChildAt(3),this.m_reward=this.getChildAt(4)},e.URL="ui://a7e9jhhhidfi6d",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_shopCraftItem:[function(t,e,n){"use strict";cc._RF.push(e,"d1adeq67R1KmoWkNGqA9gk+","UI_shopCraftItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","shopCraftItem")},e.prototype.onConstruct=function(){this.m_cEnd=this.getControllerAt(0),this.m_cNew=this.getControllerAt(1),this.m_item=this.getChildAt(1),this.m_name=this.getChildAt(2),this.m_craftBtn=this.getChildAt(3),this.m_matList=this.getChildAt(4),this.m_price=this.getChildAt(6)},e.URL="ui://a7e9jhhhi6x090",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_shopCraftMatItem:[function(t,e,n){"use strict";cc._RF.push(e,"2df01NUTRFOdohP9dejdpPp","UI_shopCraftMatItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","shopCraftMatItem")},e.prototype.onConstruct=function(){this.m_icon=this.getChildAt(0),this.m_num=this.getChildAt(1)},e.URL="ui://a7e9jhhhi6x08z",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_slot:[function(t,e,n){"use strict";cc._RF.push(e,"89053t2Hb1FdanP5KGT8Cg2","UI_slot");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","slot")},e.prototype.onConstruct=function(){this.m_cSelect=this.getControllerAt(0),this.m_cType=this.getControllerAt(1),this.m_cQuality=this.getControllerAt(2),this.m_icon=this.getChildAt(21),this.m_count=this.getChildAt(22),this.m_duration=this.getChildAt(26),this.m_tWarn=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhpsjgco",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_tabBtn:[function(t,e,n){"use strict";cc._RF.push(e,"b78ec/pTxFOKpL3aFTtWgad","UI_tabBtn");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","tabBtn")},e.prototype.onConstruct=function(){this.m_cSelect=this.getControllerAt(0),this.m_cTabType=this.getControllerAt(1),this.m_name=this.getChildAt(5)},e.URL="ui://a7e9jhhhidfi5l",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_taskBoard:[function(t,e,n){"use strict";cc._RF.push(e,"c498fBQJdRM75L8OcpnrdGO","UI_taskBoard");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","taskBoard")},e.prototype.onConstruct=function(){this.m_cFinish=this.getControllerAt(0),this.m_title=this.getChildAt(1),this.m_desc=this.getChildAt(2),this.m_enter=this.getTransitionAt(0),this.m_finish=this.getTransitionAt(1)},e.URL="ui://a7e9jhhhpsjgc4",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_taskRequireMatItem:[function(t,e,n){"use strict";cc._RF.push(e,"f72bdehqoxHYKbsLEa9vB+j","UI_taskRequireMatItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","taskRequireMatItem")},e.prototype.onConstruct=function(){this.m_icon=this.getChildAt(0),this.m_num=this.getChildAt(1)},e.URL="ui://a7e9jhhhl1kx5g",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_topUI:[function(t,e,n){"use strict";cc._RF.push(e,"aeb00kLCb5LCJFbwuxW4ZrK","UI_topUI");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","topUI")},e.prototype.onConstruct=function(){this.m_hpBar=this.getChildAt(1),this.m_foodBar=this.getChildAt(2),this.m_hp=this.getChildAt(4),this.m_food=this.getChildAt(5)},e.URL="ui://a7e9jhhhl1kx57",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_trackingCraft:[function(t,e,n){"use strict";cc._RF.push(e,"95e60FnqO1ENrwfzcnTRnL+","UI_trackingCraft");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","trackingCraft")},e.prototype.onConstruct=function(){this.m_cFinish=this.getControllerAt(0),this.m_requireList=this.getChildAt(2),this.m_frame=this.getChildAt(3),this.m_targetIcon=this.getChildAt(5),this.m_guideArea=this.getChildAt(7),this.m_t0=this.getTransitionAt(0)},e.URL="ui://a7e9jhhhl1kx4t",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI_trackingRequireItem:[function(t,e,n){"use strict";cc._RF.push(e,"32db7uWm+BL3IRCbhFNsEIQ","UI_trackingRequireItem");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(n,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.createInstance=function(){return fgui.UIPackage.createObject("DiggingUI","trackingRequireItem")},e.prototype.onConstruct=function(){this.m_icon=this.getChildAt(0),this.m_num=this.getChildAt(1)},e.URL="ui://a7e9jhhhl1kx4s",e}(fgui.GComponent);n.default=i,cc._RF.pop()},{}],UI:[function(t,e,n){"use strict";cc._RF.push(e,"8c851v3rvxDjpKDRFU5QH2I","UI"),Object.defineProperty(n,"__esModule",{value:!0});var o=t("../Managers/EventCenter"),r=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return this.instance},enumerable:!1,configurable:!0}),t.getUI=function(t){return this.uiMap.get(t)},t.registUI=function(t,e){this.uiMap.set(t,e)},t.clearUI=function(){this.uiMap.clear()},t.send=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];o.default.send("UIEvent_"+t,e)},t.on=function(t,e,n){o.default.on(t,e,n)},t.off=function(t,e,n){o.default.off(t,e,n)},t.instance=null,t.uiMap=new Map,t}();n.default=r,window.UI=r,cc._RF.pop()},{"../Managers/EventCenter":"EventCenter"}],U_Backpack:[function(t,e,n){"use strict";cc._RF.push(e,"543e1w+1lNDi6ZS8A6RNZ4d","U_Backpack");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Managers/EventCenter"),s=t("../../Model/Inventory"),c=t("../../Res"),u=t("../FuiCom"),l=t("../UI"),f=t("./U_ItemDetail"),p=cc._decorator,h=p.ccclass,d=(p.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.itemList=[],e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"Backpack"}},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){this._view.m_com.m_list.itemRenderer=this.renderItem.bind(this),this._view.m_com.m_list.on(fgui.Event.CLICK_ITEM,this.onClickItem,this),this._view.m_hideBtn.onClick(this.onClickHide,this)},e.prototype.show=function(){t.prototype.show.call(this),this.refresh(),a.default.on(a.E_InfoChange,this.refresh,this)},e.prototype.hide=function(){t.prototype.hide.call(this),a.default.off(a.E_InfoChange,this.refresh,this)},e.prototype.onClickHide=function(){this.hide()},e.prototype.refresh=function(){this.itemList=s.default.Ins.resList,this._view.m_com.m_list.numItems=this.itemList.length},e.prototype.renderItem=function(t,e){var n=this.itemList[t],o=c.default.getIconUrl(n.cfg.url);e.m_icon.url=o,e.m_num.visible=n.count>1,e.m_num.text=n.count.toString();var r=config.Item.getById(n.cfg.id);e.m_frame.m_cQuality.selectedIndex=r.quality,e.data=r.id},e.prototype.onClickItem=function(t){var e=t.data;l.default.getUI(f.default).setData(e)},i([h],e)}(u.default));n.default=d,cc._RF.pop()},{"../../Managers/EventCenter":"EventCenter","../../Model/Inventory":"Inventory","../../Res":"Res","../FuiCom":"FuiCom","../UI":"UI","./U_ItemDetail":"U_ItemDetail"}],U_Boardcast:[function(t,e,n){"use strict";cc._RF.push(e,"3d817GwFX9GCIf/A52c8tc2","U_Boardcast");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0});var s=t("../Managers/PoolManager"),c=t("./Coms/BoardcastItem"),u=t("./UINode"),l=t("../Controller/GameManager"),f=t("../CollectMgr"),p=t("./Coms/BoardcastItemNew"),h=cc._decorator,d=h.ccclass,g=h.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.items=[],e.timer=0,e.item=null,e.newItem=null,e.spaceY=3,e}return r(e,t),e.prototype.start=function(){t.prototype.start.call(this),f.default.Ins.on(f.ECollectEvent.E_CollectRes,this.sendNewItem,this)},e.prototype.initItem=function(t){t.node.parent=this.node,this.items.unshift(t),t.startTime=this.timer,t.node.position=cc.v3(0,-this.spaceY,0),this.refreshItem()},e.prototype.sendGetItem=function(t,e){var n=this,o=s.PoolManager.GetPrefab(this.item).getComponent(c.default);this.initItem(o),o.setData(t,e),o.node.opacity=0,cc.tween(o.node).to(.3,{opacity:255}).delay(1).to(.5,{opacity:0}).call(function(){n.items.splice(n.items.indexOf(o),1),s.PoolManager.PutPrefab(o.node),n.refreshItem()}).start()},e.prototype.sendNewItem=function(t){var e=this,n=s.PoolManager.GetPrefab(this.newItem).getComponent(p.default);this.initItem(n),n.setData(t),n.node.opacity=0,cc.tween(n.node).to(.3,{opacity:255}).delay(2).to(.5,{opacity:0}).call(function(){e.items.splice(e.items.indexOf(n),1),s.PoolManager.PutPrefab(n.node),e.refreshItem()}).start()},e.prototype.update=function(t){t*=l.default.Ins.timeScale,this.timer+=t},e.prototype.refreshItem=function(){var t=this.items.length,e=a(this.items);e.sort(function(t,e){var n=e.sortingOrder-t.sortingOrder;return 0!=n?n:t.startTime-e.startTime});for(var n=0,o=0;o<t;o++){var r=e[o];r.targetY=o*this.spaceY+n,n+=r.height}},i([g(cc.Prefab)],e.prototype,"item",void 0),i([g(cc.Prefab)],e.prototype,"newItem",void 0),i([g],e.prototype,"spaceY",void 0),i([d],e)}(u.default);n.default=y,cc._RF.pop()},{"../CollectMgr":"CollectMgr","../Controller/GameManager":"GameManager","../Managers/PoolManager":"PoolManager","./Coms/BoardcastItem":"BoardcastItem","./Coms/BoardcastItemNew":"BoardcastItemNew","./UINode":"UINode"}],U_BuildMenu:[function(t,e,n){"use strict";cc._RF.push(e,"9de2e3LBc1HAr4Z9z1pw0td","U_BuildMenu");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Controller/Map/MapCtrl"),s=t("../../Controller/Map/TileTips"),c=t("../../Model/Inventory"),u=t("../../Res"),l=t("../Coms/BuildItem"),f=t("../Coms/MatItem"),p=t("../FuiCom"),h=t("../UI"),d=t("../U_TaskTips"),g=cc._decorator,y=g.ccclass,m=(g.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectIdx=0,e.mats=[],e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"BuildMenu",exts:[{extName:"buildItem",extClass:l.default},{extName:"matItem",extClass:f.default}]}},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){this._view.onClick(this.onClickHide,this),this.getList("buildList").itemRenderer=this.renderBuildItem.bind(this),this.getList("matList").itemRenderer=this.renderMatItem.bind(this),this.getChild("confirmBtn").onClick(this.onClickBuild,this)},e.prototype.onClickHide=function(){this.hide()},e.prototype.show=function(){t.prototype.show.call(this),this.onCancel(),this.refresh()},e.prototype.refresh=function(){this.cfgs=config.Works.list,this.getList("buildList").numItems=this.cfgs.length},e.prototype.renderBuildItem=function(t,e){var n=this,o=this.cfgs[t];e.setData(o.id,this.selectIdx==t,u.default.getIconUrl(o.url),function(){n.onSelect(t)},function(){n.onCancel()})},e.prototype.onClickBuild=function(t){t.stopPropagation();for(var e=this.cfgs[this.selectIdx],n=!0,o=0;o<e.matId.length;o++){var r=e.matId[o],i=e.matNum[o],s=c.default.Ins.findRes(r);if(i>(s?s.count:0)){n=!1;break}}n?(a.default.Ins.buildWorks(e.id,this.targetGrid),this.hide()):h.default.getUI(d.default).setTxt("\u6750\u6599\u4e0d\u8db3")},e.prototype.onCancel=function(){this.selectIdx=-1,this.getChild("matList").visible=!1,this.getChild("matBg").visible=!1,this.getChild("confirmBtn").visible=!1},e.prototype.setTargetGrid=function(t){this.targetGrid=t,s.default.Ins.selectTile(t)},e.prototype.hide=function(){t.prototype.hide.call(this),a.default.Ins.returnToPlayer(),this.targetGrid&&s.default.Ins.cancelSelectTile(this.targetGrid)},e.prototype.onSelect=function(t){this.getChild("matList").visible=!0,this.getChild("matBg").visible=!0,this.selectIdx=t;var e=this.cfgs[t];this.mats=[],this.getChild("confirmBtn").visible=!0;for(var n=0;n<e.matId.length;n++)this.mats.push({resId:e.matId[n],count:e.matNum[n]});this.getList("matList").numItems=this.mats.length,this.refresh()},e.prototype.renderMatItem=function(t,e){var n=this.mats[t];config.Item.getById(n.resId),e.setData(n.resId,n.count)},i([y],e)}(p.default));n.default=m,cc._RF.pop()},{"../../Controller/Map/MapCtrl":"MapCtrl","../../Controller/Map/TileTips":"TileTips","../../Model/Inventory":"Inventory","../../Res":"Res","../Coms/BuildItem":"BuildItem","../Coms/MatItem":"MatItem","../FuiCom":"FuiCom","../UI":"UI","../U_TaskTips":"U_TaskTips"}],U_CollectionTips:[function(t,e,n){"use strict";cc._RF.push(e,"e327cen8HdKPZeotvsk2aHn","U_CollectionTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Res"),s=t("../FuiCom"),c=cc._decorator,u=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.collectQueue=[],e.isPlaying=!1,e.tween=null,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"CollectionTips"}},enumerable:!1,configurable:!0}),e.prototype.onCollectNewRes=function(t){this.collectQueue.push(t),this.detectShow()},e.prototype.detectShow=function(){if(!this.isPlaying)return this.collectQueue.length>0&&(this.setData(this.collectQueue.shift()),!0)},e.prototype.setData=function(t){var e=this,n=config.Item.getById(t);this._view.m_icon.url=a.default.getIconUrl(n.url),this._view.m_desc.text=n.desc,this._view.m_name.text=n.name,this._view.m_frame.m_cQuality.selectedIndex=n.quality,this.isPlaying=!0,this._view.m_enter.play(),this.show(),this.tween&&this.tween.stop(),this.tween=cc.tween(this.node).delay(3).call(function(){e.tween=null,e._view.m_exit.play(),e._view.m_exit.setHook("end",function(){e.isPlaying=!1,e.detectShow()||e.hide()})}).start()},i([u],e)}(s.default));n.default=l,cc._RF.pop()},{"../../Res":"Res","../FuiCom":"FuiCom"}],U_CollectionWindow:[function(t,e,n){"use strict";cc._RF.push(e,"849bafILqtCurXwTYwpUp6B","U_CollectionWindow");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a,s=t("../../CollectMgr"),c=t("../FuiCom"),u=cc._decorator,l=u.ccclass;u.property,function(t){t[t.BLOCK=0]="BLOCK",t[t.ITEM=1]="ITEM",t[t.MONSTER=2]="MONSTER"}(a||(a={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=0,e.selectType=a.BLOCK,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"CollectionWindow"}},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){this._view.m_backBtn.onClick(this.onBack,this),this._view.m_menu.m_block.onClick(this.onClickBlock,this),this._view.m_menu.m_item.onClick(this.onClickItem,this),this._view.m_menu.m_monster.onClick(this.onClickMonster,this),this._view.m_content.m_list.itemRenderer=this.onRenderContent.bind(this),this._view.m_content.m_list.setVirtual()},e.prototype.getDataList=function(t){switch(t){case a.BLOCK:return s.default.Ins.blockCollectList;case a.ITEM:return s.default.Ins.itemCollectList;case a.MONSTER:return s.default.Ins.monsterCollectList}},Object.defineProperty(e.prototype,"contentData",{get:function(){return this.getDataList(this.selectType)},enumerable:!1,configurable:!0}),e.prototype.getDataCfg=function(t,e){switch(e){case a.BLOCK:return config.MapObject.getById(t);case a.ITEM:return config.Item.getById(t);case a.MONSTER:return config.MonsterData.getById(t)}},e.prototype.isCollect=function(t,e){switch(e){case a.BLOCK:return s.default.Ins.isCollectedBlock(t);case a.ITEM:return s.default.Ins.isCollectedItem(t);case a.MONSTER:return s.default.Ins.isCollectedMonster(t)}},e.prototype.openContent=function(t){this.selectType=t,this.state=2,this._view.m_content.m_list.numItems=this.contentData.length,this._view.m_content.visible=!0,this._view.m_menu.visible=!1},e.prototype.onRenderContent=function(t,e){var n=this.contentData[t];this.getDataCfg(n,this.selectType),e.m_item.m_label.visible=!1,e.m_lock.visible=!this.isCollect(n,this.selectType)},e.prototype.onBack=function(){2==this.state?(this.state=1,this._view.m_content.visible=!1,this._view.m_menu.visible=!0):1==this.state&&(this.state=0,this.hide())},e.prototype.show=function(){t.prototype.show.call(this),this.state=1,this._view.m_content.visible=!1,this._view.m_menu.visible=!0},e.prototype.onClickBlock=function(){this.openContent(a.BLOCK)},e.prototype.onClickMonster=function(){this.openContent(a.MONSTER)},e.prototype.onClickItem=function(){this.openContent(a.ITEM)},i([l],e)}(c.default);n.default=f,cc._RF.pop()},{"../../CollectMgr":"CollectMgr","../FuiCom":"FuiCom"}],U_ContTips:[function(t,e,n){"use strict";cc._RF.push(e,"dd80au2eO5D4ZZ//j3NaZ9u","U_ContTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../Managers/EventCenter"),u=t("../../Utils/CocosExtension"),l=t("../FuiCom"),f=cc._decorator,p=f.ccclass,h=(f.property,function(){}),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allowHide=!1,e.contInfos=[],e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"ContTips"}},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){var t=this;this._view.m_hide.onClick(function(){t.allowHide&&t.detect()},this)},e.prototype.detect=function(){if(this.contInfos.length<=0)return this.hide(),void c.default.send(c.E_ContHide);this.showData(this.contInfos.shift())},e.prototype.showData=function(t){return a(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return this._view.m_desc.text=t.desc,this._view.m_title.text=t.title,this._view.m_icon.url=t.icon,this._view.m_name.text=t.name,this._view.m_name.color=cc.Color.fromHEX(cc.color(),config.QualityColor.getById(t.quality).color),this._view.m_enter.play(),this.show(),this.allowHide=!1,[4,u.delay(1e3)];case 1:return e.sent(),this.allowHide=!0,[2]}})})},e.prototype.setData=function(t,e,n,o,r){var i=new h;i.title=t,i.icon=e,i.quality=n,i.name=o,i.desc=r,this.contInfos.push(i),this.isShow||this.detect()},i([p],e)}(l.default);n.default=d,cc._RF.pop()},{"../../Managers/EventCenter":"EventCenter","../../Utils/CocosExtension":"CocosExtension","../FuiCom":"FuiCom"}],U_CraftMenu2:[function(t,e,n){"use strict";cc._RF.push(e,"10b3dNd2iNG6bIpSLaqXcgh","U_CraftMenu2");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./U_CraftMenu"),s=cc._decorator,c=s.ccclass,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"CraftMenu2"}},enumerable:!1,configurable:!0}),i([c],e)}(a.default));n.default=u,cc._RF.pop()},{"./U_CraftMenu":"U_CraftMenu"}],U_CraftMenu:[function(t,e,n){"use strict";cc._RF.push(e,"b168cYYFJlIkblgCXmnSHmo","U_CraftMenu");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Controller/Map/MapCtrl"),s=t("../../Controller/Map/TileObjects/WorksObj"),c=t("../../Controller/Map/TileTips"),u=t("../../Model/Inventory"),l=t("../../Res"),f=t("../Coms/MatItem"),p=t("../FuiCom"),h=t("../UI"),d=t("../U_TaskTips"),g=t("./U_ItemDetail"),y=cc._decorator,m=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.targetObj=null,e.craftList=[],e.closeFunc=null,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"CraftMenu"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matBg",{get:function(){return this.getChild("matBg")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"craftListCom",{get:function(){return this.getChild("craftList").asList},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"confirmBtn",{get:function(){return this.getChild("confirmBtn").asButton},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"matListCom",{get:function(){return this.getChild("matList").asList},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"craftingSlot",{get:function(){return this.getChild("craftingSlot").asCom},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){this.craftListCom.itemRenderer=this.renderCraftItem.bind(this),this.craftListCom.on(fgui.Event.CLICK_ITEM,this.onClickCraftItem,this),this.confirmBtn.onClick(this.onClickCraftBtn,this),this.matListCom.itemRenderer=this.renderMatItem.bind(this),this.getChild("hideBtn").onClick(this.onClickHide,this),this.craftingSlot.onClick(this.onClickFinishSlot,this)},e.prototype.onClickCraftItem=function(t){var e=t.data;if(u.default.Ins.craftLockMap.get(e.id))return h.default.getUI(d.default).setTxt("\u9700\u8981\u84dd\u56fe"),void this.onCancelSelect();this.selectCraftCfg==e&&h.default.getUI(g.default).setData(e.resId),this.selectCraftCfg=e,this.confirmBtn.visible=!0,this.refreshMatList()},e.prototype.refreshMatList=function(){this.selectCraftCfg?(this.matBg.visible=!0,this.matListCom.visible=!0,this.matListCom.numItems=this.selectCraftCfg.matId.length):(this.matBg.visible=!1,this.matListCom.visible=!1)},e.prototype.onCraftProgressUpdate=function(t){this.craftingSlot.getChild("progress").asProgress.value=100*(1-t),this.craftingSlot.getChild("progress").alpha=.5},e.prototype.onCraftFinishOne=function(){this.refresh()},e.prototype.onCraftAllFinish=function(){this.refresh()},e.prototype.renderCraftItem=function(t,e){var n=this.craftList[t];if(u.default.Ins.craftLockMap.get(n.id))e.getController("cLock").selectedIndex=1;else{e.getController("cLock").selectedIndex=0,n.id==this.targetObj.craftId&&this.targetObj.craftNum>0?(e.getChild("craftNum").visible=!0,e.getChild("craftNum").asLabel.text=this.targetObj.craftNum.toString()):e.getChild("craftNum").visible=!1;var o=config.Item.getById(n.resId);e.getChild("icon").asLoader.url=l.default.getIconUrl(o.url),e.getChild("frame").asCom.getController("cQuality").selectedIndex=o.quality}e.data=n},e.prototype.renderMatItem=function(t,e){var n=this.selectCraftCfg,o=n.matId[t],r=n.matNum[t];e.setData(o,r)},e.prototype.onCancelSelect=function(){this.selectCraftCfg=null,this.confirmBtn.visible=!1,this.refreshMatList()},e.prototype.onClickCraftBtn=function(){var t=this.selectCraftCfg;f.default.isEnough(t.matId,t.matNum)?(this.targetObj.addCraft(this.selectCraftCfg.id),this.refresh()):h.default.getUI(d.default).setTxt("\u6750\u6599\u4e0d\u8db3")},e.prototype.onClickFinishSlot=function(){this.targetObj.gainCraftedItem(),this.refresh()},e.prototype.refresh=function(){var t=this;if(this.targetObj){if(this.craftList=[],config.Craft.list.forEach(function(e){e.worksId==t.targetObj.workCfg.id&&t.craftList.push(e)}),this.craftListCom.numItems=this.craftList.length,!this.targetObj.craftedItem&&this.targetObj.isFinish)this.craftingSlot.visible=!1,this.getChild("tips").visible=!1;else{this.craftingSlot.visible=!0;var e=config.Craft.getById(this.targetObj.craftId),n=config.Item.getById(e.resId);this.craftingSlot.getChild("frame").asCom.getController("cQuality").selectedIndex=n.quality,this.craftingSlot.getChild("icon").asLoader.url=l.default.getIconUrl(n.url),this.craftingSlot.getChild("progress").asProgress.value=0;var o=this.targetObj.craftedItem?this.targetObj.craftedItem.count:0;this.craftingSlot.getChild("num").asLabel.text=o.toString(),this.getChild("tips").visible=o>0}this.refreshMatList()}},e.prototype.setTarget=function(t){this.targetObj=t,t.on(s.ECraftEvent.UpdateProgress,this.onCraftProgressUpdate,this),t.on(s.ECraftEvent.FinishOne,this.onCraftFinishOne,this),t.on(s.ECraftEvent.AllFinish,this.onCraftAllFinish,this),this.show()},e.prototype.onClickHide=function(){this.hide(),a.default.Ins.returnToPlayer()},e.prototype.show=function(){t.prototype.show.call(this),this.refresh(),c.default.Ins.selectTile(this.targetObj.grid),this.onCancelSelect()},e.prototype.hide=function(){t.prototype.hide.call(this),this.targetObj&&(this.targetObj.off(s.ECraftEvent.UpdateProgress,this.onCraftProgressUpdate,this),this.targetObj.off(s.ECraftEvent.FinishOne,this.onCraftFinishOne,this),this.targetObj.off(s.ECraftEvent.AllFinish,this.onCraftAllFinish,this)),this.targetObj&&c.default.Ins.cancelSelectTile(this.targetObj.grid),this.targetObj=null,this.closeFunc&&this.closeFunc(),this.closeFunc=null,a.default.Ins.returnToPlayer()},i([m],e)}(p.default));n.default=_,cc._RF.pop()},{"../../Controller/Map/MapCtrl":"MapCtrl","../../Controller/Map/TileObjects/WorksObj":"WorksObj","../../Controller/Map/TileTips":"TileTips","../../Model/Inventory":"Inventory","../../Res":"Res","../Coms/MatItem":"MatItem","../FuiCom":"FuiCom","../UI":"UI","../U_TaskTips":"U_TaskTips","./U_ItemDetail":"U_ItemDetail"}],U_Dialog:[function(t,e,n){"use strict";cc._RF.push(e,"9fe44PxuvZAxJGMkvkmCMAi","U_Dialog");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../Res"),u=t("../Utils/CocosExtension"),l=t("./FuiCom"),f=cc._decorator,p=f.ccclass,h=(f.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.finishCall=null,e.finishTimer=!1,e.awaitFunc=null,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"Dialog"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dialogCfg",{get:function(){return config.Dialog.getById(this.dialogId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"headCfg",{get:function(){return config.Head.getById(this.dialogCfg.headId)},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){this._view.m_hideBtn.onClick(this.onTapNext,this)},e.prototype.setData=function(t,e){this.dialogId=t,this.show(),this.setCom(!!this.dialogCfg.isLeft,this.headCfg.name,this.headCfg.title,this.headCfg.headUrl,this.dialogCfg.text),this.finishCall=e,this.finishTimer=!1,this.setTimer()},e.prototype.setTxt=function(t,e){this.show();var n=config.Head.getById(1);this.setCom(!0,n.name,n.title,n.headUrl,t),this.finishCall=e,this.finishTimer=!1,this.setTimer()},e.prototype.setCom=function(t,e,n,o,r){var i=this._view.m_com;this._view.m_t0.play(),i.m_cLeft.selectedIndex=t?0:1,i.m_text.text=r,i.m_head.m_name.text=e,i.m_head.m_title.text=n,i.m_head.m_head.url=c.default.getHeadUrl(o)},e.prototype.setTimer=function(){return a(this,void 0,void 0,function(){return s(this,function(t){switch(t.label){case 0:return this._view.m_com.m_continue.visible=!1,[4,u.delay(1e3)];case 1:return t.sent(),this._view.m_com.m_continue.visible=!0,this.finishTimer=!0,[2]}})})},e.prototype.awaitFinish=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){t.isShow?t.awaitFunc=e:e()})]})})},e.prototype.onTapNext=function(){this.finishTimer&&(this.hide(),this.finishCall&&this.finishCall(),this.awaitFunc&&this.awaitFunc(),this.finishCall=null,this.awaitFunc=null)},i([p],e)}(l.default));n.default=h,cc._RF.pop()},{"../Res":"Res","../Utils/CocosExtension":"CocosExtension","./FuiCom":"FuiCom"}],U_HUD:[function(t,e,n){"use strict";cc._RF.push(e,"54c2dXXf5pAwqgCQrx+3pGv","U_HUD");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.EHUDTipsEnum=void 0;var c=t("../../Controller/GameManager"),u=t("../../Controller/Map/MapCtrl"),l=t("../../Controller/Player/PlayerCtrl"),f=t("../../CraftTaskMgr"),p=t("../../GuideMgr"),h=t("../../Managers/EventCenter"),d=t("../../Managers/SoundManager"),g=t("../../Mgr/MiniMapMgr"),y=t("../../Mgr/StorageMgr"),m=t("../../Model/Inventory"),_=t("../../Operator"),v=t("../../Res"),I=t("../FuiCom"),b=t("../UI"),C=t("../U_TaskTips"),M=t("./U_Backpack"),w=t("./U_CollectionWindow"),P=t("./U_ItemDetail"),O=t("./U_MapWindow"),T=function(){},j=cc._decorator,k=j.ccclass;j.property,(n.EHUDTipsEnum||(n.EHUDTipsEnum={})).arenaTips="arenaTips";var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.taskShowQueue=[],e.selectSlotIdx=0,e.idx2type=[config.ItemType.Pickaxe,config.ItemType.Weapon,config.ItemType.Consume],e.isMapNewMsg=!1,e.dataList=[],e.isTaskFinish=!0,e.tipsShowState=new Map,e.sortedRequireList=[],e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"HUD"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"detail",{get:function(){return b.default.getUI(P.default)},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){var t=this;this._view.m_topUI.m_foodBar.value=0,this._view.m_backpackBtn.onClick(this.onClickBackpack,this),this._view.m_followBtn.asButton.onClick(function(){u.default.Ins.returnToPlayer()}),this._view.m_collectionBtn.onClick(this.onClickCollection,this),this._view.m_trackingCraft.m_guideArea.onClick(this.onClickGuideTrack,this);for(var e=function(e){n._view.m_bottomUI.getChild("slot"+e).asCom.onClick(function(){return t.onClickSlotSelect(e)},n)},n=this,o=1;o<=3;o++)e(o);this._view.m_itemSelect.m_backPackCom.m_list.itemRenderer=this.renderSelectList.bind(this),this._view.m_itemSelect.m_backPackCom.m_list.on(fgui.Event.CLICK_ITEM,this.onSelectItem,this),this._view.m_itemSelect.m_hideBtn.onClick(function(){t.clearSlotSelect(),t._view.m_itemSelect.visible=!1},this),this._view.m_saveBtn.onClick(function(){return y.default.save()},this),this._view.m_clearBtn.onClick(function(){return y.default.clear()},this),this._view.m_bottomUI.m_foodBtn.onClick(this.onEatFood,this),this._view.m_returnBtn.onClick(this.onReturn,this),this._view.m_mapBtn.onClick(this.onClickMap,this)},e.prototype.setNewMapMsg=function(){this.isMapNewMsg=!0,this.refreshMapBtn()},e.prototype.refreshMapBtn=function(){this.view.m_mapBtn.m_cNew.selectedIndex=this.isMapNewMsg?1:0},e.prototype.onClickMap=function(){b.default.getUI(O.default).openMap(),this.isMapNewMsg=!1,this.refreshMapBtn()},e.prototype.onReturn=function(){u.default.Ins.focusToCrdAsync(u.default.Ins.heartCtrl.centerCrd)},e.prototype.onEatFood=function(){null!=m.default.Ins.food&&(_.default.useFood(m.default.Ins.food),this.refresh())},e.prototype.showFollow=function(){this._view&&(this._view.m_followBtn.visible=!0)},e.prototype.onClickGuideTrack=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r=this;return s(this,function(i){switch(i.label){case 0:return(t=f.default.Ins.trackingTaskInfo)?f.default.isEnough(t.id)?[4,u.default.Ins.focusToCrdAsync(u.default.Ins.heartCtrl.centerCrd)]:[3,2]:[2];case 1:return i.sent(),p.default.Ins.guideToClick(u.default.Ins.heartCtrl.node,function(){u.default.Ins.returnToPlayer(),u.default.Ins.heartCtrl.onClick()},function(){return u.default.Ins.returnToPlayer()},!0,!1),[3,3];case 2:for(e=0,n=0;n<t.matId.length;n++)if(m.default.Ins.findResNum(t.matId[n])<t.matNum[n]){e=t.matId[n];break}if(!(o=u.default.Ins.findFromGrid(e)))return b.default.getUI(C.default).setTxt("\u9644\u8fd1\u6ca1\u6709\u6765\u6e90\uff0c\uff0c\uff0c"),[2];p.default.Ins.guideToClick(o,function(){return a(r,void 0,void 0,function(){return s(this,function(){return o.onTouchGrid(),u.default.Ins.returnToPlayer(),[2]})})}),i.label=3;case 3:return[2]}})})},e.prototype.hideFollow=function(){this._view&&(this._view.m_followBtn.visible=!1)},e.prototype.onClickBackpack=function(){b.default.getUI(M.default).show(),d.SoundManager.playEffect(d.SoundType.Backpack)},e.prototype.warnPickaxe=function(){this._view.m_bottomUI.getChild("slot1").m_tWarn.play()},e.prototype.warnWeapon=function(){this._view.m_bottomUI.getChild("slot2").m_tWarn.play()},e.prototype.onClickCollection=function(){b.default.getUI(w.default).show()},e.prototype.fadeIn=function(){return a(this,void 0,void 0,function(){var t=this;return s(this,function(){return[2,new Promise(function(e){t._view.m_fadeIn.play(),t._view.m_fadeIn.setHook("end",function(){return e()})})]})})},e.prototype.fadeOut=function(){this._view.m_fadeOut.play()},e.prototype.onClickSlotSelect=function(t){this.clearSlotSelect(),this._view.m_bottomUI.getChild("slot"+t).m_cSelect.selectedIndex=1,this.selectSlotIdx=t,this._view.m_itemSelect.visible=!0,this.dataList=m.default.Ins.resList,this._view.m_itemSelect.m_backPackCom.m_list.numItems=this.dataList.length},e.prototype.getBpCom=function(t){var e=this._view.m_itemSelect.m_backPackCom.m_list.itemIndexToChildIndex(t);return this._view.m_itemSelect.m_backPackCom.m_list.getChildAt(e)},e.prototype.showTask=function(t,e){void 0===e&&(e="\u4efb\u52a1");var n=new T;n.desc=t,n.title=e,this.taskShowQueue.push(n),this.refreshTaskBoard()},e.prototype.refreshTaskBoard=function(){var t=this.taskShowQueue[0];if(t){if(this.isTaskFinish){this.taskShowQueue.shift();var e=this._view.m_taskBoard;e.visible=!0,this.isTaskFinish=!1,e.m_enter.play(),e.m_title.text=t.title,e.m_desc.text=t.desc,e.m_cFinish.selectedIndex=0}}else this.hideTask()},e.prototype.finishTask=function(){var t=this,e=this._view.m_taskBoard;e.m_finish.play(),e.m_finish.clearHooks(),e.m_finish.setHook("end",function(){t.isTaskFinish=!0,t.refreshTaskBoard()}),e.m_cFinish.selectedIndex=1},e.prototype.hideTask=function(){this._view.m_taskBoard.visible=!1},e.prototype.enterTips=function(){},e.prototype.exitAllTips=function(){},e.prototype.exitTips=function(){},e.prototype.getTips=function(){},e.prototype.renderSelectList=function(t,e){var n=this.dataList[t],o=this.idx2type[this.selectSlotIdx-1];n.cfg.type!=o?e.grayed=!0:e.grayed=!1,e.m_frame.m_cQuality.selectedIndex=n.cfg.quality,e.m_icon.url=v.default.getIconUrl(n.cfg.url),e.m_num.text=n.count.toString(),e.m_num.visible=n.count>1,e.data={itemData:n,valid:!e.grayed}},e.prototype.show=function(){t.prototype.show.call(this),this.refresh(),h.default.on(h.E_InfoChange,this.refresh,this),f.default.on(f.ECraftTaskEvent.E_CraftTaskChangeTracking,this.changeTrackingCraft,this),f.default.on(f.ECraftTaskEvent.E_CraftTaskUpdateTracking,this.refreshTrackingCraftInfo,this),f.default.on(f.ECraftTaskEvent.E_CraftTaskFinishTracking,this.onFinishTracking,this),g.default.on(g.EMiniMapEvent.newMsg,this.setNewMapMsg,this),this.changeTrackingCraft()},e.prototype.hide=function(){t.prototype.hide.call(this),h.default.off(h.E_InfoChange,this.refresh,this),f.default.off(f.ECraftTaskEvent.E_CraftTaskChangeTracking,this.changeTrackingCraft,this),f.default.off(f.ECraftTaskEvent.E_CraftTaskUpdateTracking,this.refreshTrackingCraftInfo,this),f.default.off(f.ECraftTaskEvent.E_CraftTaskFinishTracking,this.onFinishTracking,this),g.default.off(g.EMiniMapEvent.newMsg,this.setNewMapMsg,this)},e.prototype.clearSlotSelect=function(){for(var t=0;t<3;t++)this._view.m_bottomUI.getChild("slot"+(t+1)).m_cSelect.selectedIndex=0},e.prototype.onFinishTracking=function(){this._view.m_trackingCraft.m_t0.play()},e.prototype.refresh=function(){this.clearSlotSelect();for(var t=[m.default.Ins.pickaxe,m.default.Ins.weapon,m.default.Ins.food],e=0;e<3;e++)this.refreshSlotData(e+1,t[e]?t[e].cfgId:-1,t[e]?t[e].count:0);this._view.m_bottomUI.m_foodBtn.visible=null!=m.default.Ins.food,this._view.m_itemSelect.visible=!1},e.prototype.refreshSlotData=function(t,e,n){var o=this._view.m_bottomUI.getChild("slot"+t),r=config.Item.getById(e);if(o.m_cSelect.selectedIndex=0,r)if(o.m_icon.url=v.default.getIconUrl(r.url),o.m_cQuality.selectedIndex=r.quality,r.type==config.ItemType.Weapon)(i=m.default.Ins.weapon).weaponCfg.duration<0?o.m_duration.visible=!1:(o.m_duration.visible=!0,o.m_duration.value=i.duration/i.weaponCfg.duration*100);else if(r.type==config.ItemType.Pickaxe){var i;(i=m.default.Ins.pickaxe).pickaxeCfg.duration<0?o.m_duration.visible=!1:(o.m_duration.visible=!0,o.m_duration.value=i.duration/i.pickaxeCfg.duration*100)}else o.m_duration.visible=!1;else o.m_icon.url="",o.m_duration.visible=!1;o.m_count.text=n.toString(),o.m_count.visible=n>1},e.prototype.onUpdate=function(){if(c.default.Ins.isInited){this._view.m_topUI.m_foodBar.value=Math.floor(l.default.Ins.info.food),this._view.m_topUI.m_food.text=Math.round(l.default.Ins.info.food)+"/100",this._view.m_topUI.m_hpBar.value=l.default.Ins.info.hp/l.default.Ins.info.maxHp*100,this._view.m_topUI.m_hp.text=Math.round(l.default.Ins.info.hp)+"/"+l.default.Ins.info.maxHp,this._view.m_coinNum.text=m.default.Ins.coin.toString();var t=this._view.m_posTips.m_arrow,e=cc.v2(l.default.Ins.Hero.node.position),n=u.default.Ins.crd2lp(u.default.Ins.heartCtrl.centerCrd).sub(e).signAngle(cc.Vec2.UP);t.rotation=n/Math.PI*180}},e.prototype.onSelectItem=function(t){var e=t.data;null!=e&&(e.valid?(d.SoundManager.playEffect(d.SoundType.GetItem),this.setSlotData(this.selectSlotIdx,e.itemData),this.refresh()):b.default.getUI(C.default).setTxt("\u8bf7\u9009\u62e9\u5bf9\u5e94\u7c7b\u522b\u7684\u7269\u54c1"))},e.prototype.setSlotData=function(t,e){1==t?m.default.Ins.setPickaxe(e):2==t?m.default.Ins.setWeapon(e):3==t&&m.default.Ins.setFood(e)},e.prototype.getSlotData=function(t){return 1==t?m.default.Ins.pickaxe:2==t?m.default.Ins.weapon:3==t?m.default.Ins.food:void 0},e.prototype.changeTrackingCraft=function(){f.default.Ins.trackingTaskInfo?(this._view.m_trackingCraft.visible=!0,h.default.on(h.E_InfoChange,this.refreshTrackingCraftInfo,this),this.refreshTrackingCraftInfo()):(this._view.m_trackingCraft.visible=!1,h.default.off(h.E_InfoChange,this.refreshTrackingCraftInfo,this))},e.prototype.refreshTrackingCraftInfo=function(){var t=this._view.m_trackingCraft,e=f.default.Ins.trackingTaskInfo,n=f.default.isEnough(e.id);if(t.m_cFinish.selectedIndex=n?1:0,e.resId>=0){t.m_targetIcon.url=v.default.getIconUrl(config.Item.getById(e.resId).url);var o=config.Item.getById(e.resId);t.m_frame.m_cQuality.selectedIndex=o.quality}else t.m_targetIcon.url=v.default.getIconUrl(v.default.coinUrl),t.m_frame.m_cQuality.selectedIndex=1;t.m_requireList.itemRenderer=this.onRenderTaskRequire.bind(this),this.sortedRequireList=[];for(var r=0;r<e.matId.length;r++)this.sortedRequireList.push({id:e.matId[r],num:e.matNum[r]});this.sortedRequireList.sort(function(t,e){return(m.default.Ins.findResNum(t.id)>=t.num?1:0)-(m.default.Ins.findResNum(e.id)>=e.num?1:0)}),t.m_requireList.numItems=this.sortedRequireList.length},e.prototype.onRenderTaskRequire=function(t,e){var n=this.sortedRequireList[t],o=config.Item.getById(n.id);e.m_icon.url=v.default.getIconUrl(o.url);var r=n.num,i=m.default.Ins.findResNum(o.id);e.m_num.text=i+"/"+r,e.m_num.color=i>=r?cc.Color.GREEN:cc.Color.BLACK},i([k],e)}(I.default);n.default=S,cc._RF.pop()},{"../../Controller/GameManager":"GameManager","../../Controller/Map/MapCtrl":"MapCtrl","../../Controller/Player/PlayerCtrl":"PlayerCtrl","../../CraftTaskMgr":"CraftTaskMgr","../../GuideMgr":"GuideMgr","../../Managers/EventCenter":"EventCenter","../../Managers/SoundManager":"SoundManager","../../Mgr/MiniMapMgr":"MiniMapMgr","../../Mgr/StorageMgr":"StorageMgr","../../Model/Inventory":"Inventory","../../Operator":"Operator","../../Res":"Res","../FuiCom":"FuiCom","../UI":"UI","../U_TaskTips":"U_TaskTips","./U_Backpack":"U_Backpack","./U_CollectionWindow":"U_CollectionWindow","./U_ItemDetail":"U_ItemDetail","./U_MapWindow":"U_MapWindow"}],U_ItemDetail:[function(t,e,n){"use strict";cc._RF.push(e,"46be4bPqBFB0KvOmIdcku1I","U_ItemDetail");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Res"),s=t("../FuiCom"),c=cc._decorator,u=c.ccclass,l=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"ItemDetail",exts:[]}},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){this._view.onClick(this.onClickHide,this),this.getChild("foodBtn").asButton.onClick(this.onClickFoodBtn,this)},Object.defineProperty(e.prototype,"icon",{get:function(){return this.getChild("icon").asLoader},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nameCom",{get:function(){return this.getChild("name").asLabel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"typeCom",{get:function(){return this.getChild("type").asLabel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"qualityCom",{get:function(){return this.getChild("quality").asLabel},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"descCom",{get:function(){return this.getChild("desc").asLabel},enumerable:!1,configurable:!0}),e.prototype.setData=function(t,e,n){void 0===n&&(n=null);var o=config.Item.getById(t);this.icon.url=a.default.getIconUrl(o.url),this.qualityCom.text=config.QualityColor.getById(o.quality).name;var r=cc.Color.fromHEX(cc.color(),config.QualityColor.getById(o.quality).color);this.qualityCom.asTextField.color=r,this.nameCom.text=o.name,this.nameCom.asTextField.color=r,this.typeCom.text=config.ItemTypeCfg.getById(o.type).name,this.descCom.text=o.desc,this.closeFunction=e,this.foodFunction=n,this.getChild("foodBtn").visible=null!=this.foodFunction,this.show()},e.prototype.setCoin=function(t){this.icon.url=a.default.getIconUrl(a.default.coinUrl),this.qualityCom.text=config.QualityColor.getById(a.default.coinQuality).name;var e=cc.Color.fromHEX(cc.color(),config.QualityColor.getById(a.default.coinQuality).color);this.qualityCom.asTextField.color=e,this.nameCom.text="\u949e\u7968",this.nameCom.asTextField.color=e,this.typeCom.text=config.ItemTypeCfg.getById(config.ItemType.Res).name,this.descCom.text="\u7528\u4e8e\u4ea4\u6613\u7684\u91cd\u8981\u8d27\u5e01",this.closeFunction=t,this.getChild("foodBtn").visible=null!=this.foodFunction,this.show()},e.prototype.onClickHide=function(){this.hide(),this.closeFunction&&this.closeFunction(),this.closeFunction=null},e.prototype.onClickFoodBtn=function(){this.foodFunction&&this.foodFunction()},i([u],e)}(s.default));n.default=l,cc._RF.pop()},{"../../Res":"Res","../FuiCom":"FuiCom"}],U_MapWindow:[function(t,e,n){"use strict";cc._RF.push(e,"8413fpsYp9EoZLInf4Cwu+F","U_MapWindow");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../../Controller/Map/MapCtrl"),u=t("../../Controller/Map/Region"),l=t("../../Controller/Player/PlayerCtrl"),f=t("../../Mgr/MiniMapMgr"),p=t("../../Utils/CocosExtension"),h=t("../FuiCom"),d=cc._decorator,g=d.ccclass,y=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allowHide=!0,e.isInTouch=!1,e.data=[],e.isSelectTeleport=!1,e.clickCall=null,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"MapWindow"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this._view.m_map.m_grp.m_bottom},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return cc.v2(this._view.m_map.m_grp.scaleX,this._view.m_map.m_grp.scaleY)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tipLayer",{get:function(){return this._view.m_map.m_grp.m_tips},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this._view.m_map.m_grp.m_top},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minX",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxX",{get:function(){return this._view.m_map.m_grp.width*this._view.m_map.m_grp.scaleX-this._view.m_map.width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minY",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxY",{get:function(){return this._view.m_map.m_grp.height*this._view.m_map.m_grp.scaleY-this._view.m_map.height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"focusCenter",{get:function(){return cc.v2(this._view.m_map.width/2,this._view.m_map.height/2)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"playerRegion",{get:function(){return c.default.Ins.getRegionByCrd(l.default.Ins.curCrd)},enumerable:!1,configurable:!0}),e.prototype.getLockNode=function(t){for(var e=config.RegionLockMap.getById(t).lockId,n=[],o=0;o<e.length;o++)n.push(this.top.getChild("n"+e[o]).asCom);return n},e.prototype.getUnlockNode=function(t){var e=config.RegionLockMap.getById(t).unlockId;return this.bottom.getChild("n"+e).asCom},e.prototype.getTipsNode=function(t){var e=config.RegionLockMap.getById(t).unlockId;return this.tipLayer.getChild("n"+e).asCom},e.prototype.onFuiInit=function(){var t=this;this._view.m_map.on(cc.Node.EventType.TOUCH_MOVE,this.onMoveMap,this),this._view.m_map.on(fairygui.Event.TOUCH_BEGIN,this.onTouchMap,this),this._view.m_hideBtn.onClick(function(){return t.hide()},this);for(var e=function(e){var o=config.Region.list[e].id;n.getTipsNode(o).onClick(function(){t.clickCall&&(t.clickCall(o),t.hide())})},n=this,o=0;o<config.Region.list.length;o++)e(o)},e.prototype.onTouchMap=function(){this.isInTouch=!0},e.prototype.onMoveMap=function(t){if(this.isInTouch){var e=t.getDelta();e.y=-e.y,this.moveMap(e)}},e.prototype.limitMapPos=function(t){var e=cc.v2(t);return e.x=cc.misc.clampf(t.x,-(this.minX-60),-(this.maxX+60)),e.y=cc.misc.clampf(e.y,-(this.minY-60),-(this.maxY+60)),e},e.prototype.moveMap=function(t){var e=cc.v2(this._view.m_map.m_grp.x+t.x,this._view.m_map.m_grp.y+t.y),n=this.limitMapPos(e);this._view.m_map.m_grp.x=n.x,this._view.m_map.m_grp.y=n.y,this.focusReject&&this.focusReject(),this.focusReject=null},e.prototype.showUnlockRegion=function(t){return a(this,void 0,void 0,function(){var e,n,o;return s(this,function(r){switch(r.label){case 0:for(this.data=[],e=0;e<config.Region.list.length;e++)n=config.Region.list[e],o=c.default.Ins.getRegionById(n.id),this.data.push({state:o.curState,regionId:n.id}),n.id==t&&(this.data[e].state=u.ERegionState.Sleep);return this.show(),this.focusToRegion(t),this.getUnlockNode(t).visible=!0,this.allowHide=!1,[4,this.unlockRegionAnim(t)];case 1:return r.sent(),[4,p.delay(500)];case 2:return r.sent(),this.allowHide=!0,this.hide(),[2]}})})},e.prototype.openSelectTeleport=function(t,e){this.isSelectTeleport=!0,this.clickCall=t,this.cancelCall=e,this.openMap()},e.prototype.openMap=function(){return a(this,void 0,void 0,function(){var t,e,n,o,r;return s(this,function(i){switch(i.label){case 0:return f.default.Ins.newMsgType!=f.EMiniMapMsgType.newSign?[3,2]:(t=Array.from(f.default.Ins.signMap.values()),[4,this.openToFocus(t)]);case 1:return i.sent(),[2];case 2:for(this.data=[],e=0;e<config.Region.list.length;e++)n=config.Region.list[e],o=c.default.Ins.getRegionById(n.id),this.data.push({state:o.curState,regionId:n.id});this.show(),(r=this.playerRegion)&&this.focusToRegion(r.id),i.label=3;case 3:return[2]}})})},e.prototype.openToFocus=function(t){return a(this,void 0,void 0,function(){var e,n,o;return s(this,function(r){switch(r.label){case 0:for(this.data=[],o=0;o<config.Region.list.length;o++)e=config.Region.list[o],n=c.default.Ins.getRegionById(e.id),this.data.push({state:n.curState,regionId:e.id});this.show(),o=0,r.label=1;case 1:return o<t.length?[4,this.focusMoveToRegion(t[o])]:[3,5];case 2:return r.sent(),[4,p.delay(500)];case 3:r.sent(),r.label=4;case 4:return o++,[3,1];case 5:return[2]}})})},e.prototype.refreshUnlockNodeById=function(t){var e=this.getUnlockNode(t),n=this.getTipsNode(t),o=config.Region.getById(t);switch(c.default.Ins.getRegionById(t).curState){case u.ERegionState.Active:e.visible=!0,n.m_cActive.selectedIndex=1;break;case u.ERegionState.Sleep:e.visible=!1,n.m_cActive.selectedIndex=0;break;case u.ERegionState.Unlock:e.visible=!0,n.m_cActive.selectedIndex=0}e.m_title.text=o.title},e.prototype.unlockRegionAnim=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n){var o=e.getLockNode(t),r=o.length;o.forEach(function(t){t.m_tActive.play(),t.m_tActive.setHook("end",function(){--r<=0&&n()})})})]})})},e.prototype.getFocusOffset=function(t){var e=this.getUnlockNode(t);return cc.v2(this.focusCenter.x-e.x*this.scale.x,this.focusCenter.y-e.y*this.scale.y)},e.prototype.focusToRegion=function(t){var e=this.getFocusOffset(t),n=this.limitMapPos(e);this._view.m_map.m_grp.setPosition(n.x,n.y)},e.prototype.focusMoveToRegion=function(t){return a(this,void 0,void 0,function(){var e=this;return s(this,function(){return[2,new Promise(function(n,o){var r=e.getFocusOffset(t),i=e.limitMapPos(r),a={x:e._view.m_map.m_grp.x,y:e._view.m_map.m_grp.y};e.focusReject=o,cc.tween(a).to(1,{x:i.x,y:i.y},{onUpdate:function(){e._view.m_map.m_grp.setPosition(a.x,a.y)},easing:cc.easing.sineOut}).call(function(){n(),e.focusReject=null}).start()})]})})},e.prototype.refresh=function(){for(var t=0;t<this.data.length;t++){var e=this.data[t],n=e.regionId,o=config.Region.getById(n),r=this.getLockNode(n),i=this.getUnlockNode(n),a=this.getTipsNode(n);switch(i.m_title.text=o.title,e.state){case u.ERegionState.Active:r.forEach(function(t){return t.visible=!1}),i.visible=!0,a.m_cActive.selectedIndex=1;break;case u.ERegionState.Sleep:r.forEach(function(t){return t.visible=!0}),i.visible=!1,a.m_cActive.selectedIndex=0;break;case u.ERegionState.Unlock:r.forEach(function(t){return t.visible=!1}),i.visible=!0,a.m_cActive.selectedIndex=0}a.m_cSign.selectedIndex=f.default.Ins.signMap.has(n)?1:0,a.m_cHeart.selectedIndex=36==n?1:0;var s=c.default.Ins.getRegionById(n);a.m_cTeleport.selectedIndex=s.isUnlock&&s.teleport?1:0,a.m_cSelect.selectedIndex=this.isSelectTeleport&&f.default.Ins.isCanTeleport(n)?1:0,this._view.m_cSelectTeleport.selectedIndex=this.isSelectTeleport?1:0}},e.prototype.show=function(){t.prototype.show.call(this),this.refresh()},e.prototype.hide=function(){this.allowHide&&(t.prototype.hide.call(this),this.isSelectTeleport=!1,this.cancelCall&&this.cancelCall(),this.cancelCall=null,this.clickCall=null)},i([g],e)}(h.default));n.default=y,cc._RF.pop()},{"../../Controller/Map/MapCtrl":"MapCtrl","../../Controller/Map/Region":"Region","../../Controller/Player/PlayerCtrl":"PlayerCtrl","../../Mgr/MiniMapMgr":"MiniMapMgr","../../Utils/CocosExtension":"CocosExtension","../FuiCom":"FuiCom"}],U_Modal:[function(t,e,n){"use strict";cc._RF.push(e,"fecb4oSMG5GUJWxkjoKswsL","U_Modal");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./FuiCom"),s=cc._decorator,c=s.ccclass,u=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"Modal"}},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){this._view.onClick(function(){console.log("click ui modal")})},i([c],e)}(a.default));n.default=u,cc._RF.pop()},{"./FuiCom":"FuiCom"}],U_PopupTips:[function(t,e,n){"use strict";cc._RF.push(e,"7397c26TIZFW6z32jvf6HrX","U_PopupTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./FuiCom"),s=cc._decorator,c=s.ccclass,u=(s.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.confirm=null,e.cancel=null,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"PopupTips"}},enumerable:!1,configurable:!0}),e.prototype.setData=function(t,e,n){this.confirm=e,this.cancel=n,this._view.m_title.text=t,this.show()},e.prototype.onFuiInit=function(){var t=this;this._view.m_confirm.onClick(function(){t.confirm&&t.confirm(),t.hide()}),this._view.m_cancel.onClick(function(){t.cancel&&t.cancel(),t.hide()})},e.prototype.hide=function(){t.prototype.hide.call(this),this.confirm=null,this.cancel=null},i([c],e)}(a.default));n.default=u,cc._RF.pop()},{"./FuiCom":"FuiCom"}],U_PosTips:[function(t,e,n){"use strict";cc._RF.push(e,"ea6f7j//a1PkoVFAlBGuG/4","U_PosTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Controller/Map/MapCtrl"),s=t("../Controller/Player/PlayerCtrl"),c=t("./UINode"),u=cc._decorator,l=u.ccclass,f=u.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.arrowTips=null,e}return r(e,t),e.prototype.update=function(){var t=cc.v2(s.default.Ins.Hero.node.position),e=a.default.Ins.crd2lp(a.default.Ins.heartCtrl.centerCrd).sub(t).signAngle(cc.Vec2.UP);this.arrowTips.angle=-e/Math.PI*180,[1,4,2].sort()},i([f(cc.Node)],e.prototype,"arrowTips",void 0),i([l],e)}(c.default);n.default=p,cc._RF.pop()},{"../Controller/Map/MapCtrl":"MapCtrl","../Controller/Player/PlayerCtrl":"PlayerCtrl","./UINode":"UINode"}],U_Shop:[function(t,e,n){"use strict";cc._RF.push(e,"29f01ZWVWJKv54e15sp1KQI","U_Shop");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Controller/Map/MapCtrl"),s=t("../Managers/EventCenter"),c=t("../Mgr/UnlockMgr"),u=t("../Model/Inventory"),l=t("../Model/ItemInfo"),f=t("../Operator"),p=t("../Res"),h=t("./FuiCom"),d=t("./UI"),g=t("./U_TaskTips"),y=cc._decorator,m=y.ccclass,_=(y.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tabNames=["\u8d2d\u4e70","\u51fa\u552e","\u5236\u4f5c"],e.selectIdx=0,e.buyInfos=[],e.soldItem=[],e.craftInfos=[],e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"Shop"}},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){this._view.m_hideBtn.onClick(this.hide,this),this._view.m_tabList.itemRenderer=this.onRenderTabList.bind(this),this._view.m_buyList.itemRenderer=this.onRenderBuyList.bind(this),this._view.m_soldList.itemRenderer=this.onRenderSoldList.bind(this),this._view.m_craftList.itemRenderer=this.onRenderCraftList.bind(this),this._view.m_buyList.setVirtual(),this._view.m_soldList.setVirtual(),this._view.m_craftList.setVirtual()},e.prototype.refreshData=function(){this.buyInfos=[];for(var t=0;t<config.ShopGoods.list.length;t++){var e=config.ShopGoods.list[t].id,n=config.ShopGoods.getById(e);c.default.Ins.isUnlockBuy(e)&&this.buyInfos.push(n)}for(this.craftInfos=[],t=0;t<config.ShopCraft.list.length;t++){e=config.ShopCraft.list[t].id;var o=config.ShopCraft.getById(e);c.default.Ins.isUnlockCraft(e)&&this.craftInfos.push(o)}for(this.soldItem=[],t=0;t<u.default.Ins.resList.length;t++)if(u.default.Ins.resList[t].cfg.price>0){var r=u.default.Ins.resList[t];this.soldItem.push(new l.default(r.cfgId))}this.refresh()},e.prototype.refresh=function(){this._view.m_tabList.numItems=3,this._view.m_buyList.numItems=this.buyInfos.length+1,this._view.m_soldList.numItems=this.soldItem.length,this._view.m_craftList.numItems=this.craftInfos.length+1,this._view.m_soldTips.visible=1==this.selectIdx&&0==this.soldItem.length,this._view.m_coinNum.text=u.default.Ins.coin.toString()},e.prototype.show=function(){var e=this;t.prototype.show.call(this),this.refreshData(),s.default.on(s.E_InfoChange,this.refresh,this),c.default.Ins.clearNewUnlock(),c.default.on(c.EUnlockEvent.unlockBuy,function(){return e.refresh()},this),c.default.on(c.EUnlockEvent.unlockCraft,function(){return e.refresh()},this)},e.prototype.hide=function(){var e=this;t.prototype.hide.call(this),a.default.Ins.returnToPlayer(),s.default.off(s.E_InfoChange,this.refresh,this),c.default.off(c.EUnlockEvent.unlockBuy,function(){return e.refresh()},this),c.default.on(c.EUnlockEvent.unlockCraft,function(){return e.refresh()},this)},e.prototype.onRenderTabList=function(t,e){var n=this;t==this.selectIdx?e.m_cSelect.selectedIndex=1:e.m_cSelect.selectedIndex=0,e.m_name.text=this.tabNames[t],e.clearClick(),e.onClick(function(){n.selectTab(t)},this)},e.prototype.onRenderBuyList=function(t,e){var n=this;if(t==this.buyInfos.length)e.m_cEnd.selectedIndex=1;else{var o=this.buyInfos[t];e.m_cEnd.selectedIndex=0;var r=config.Item.getById(o.resId);e.m_cNew.selectedIndex=c.default.Ins.isNewBuy(o.id)?1:0,e.m_desc.text=r.desc,e.m_item.m_frame.m_cQuality.selectedIndex=r.quality,e.m_name.text=r.name,e.m_price.text=o.price.toString(),e.m_price.color=u.default.Ins.coin>=o.price?cc.Color.BLACK:cc.Color.RED,e.m_item.m_icon.url=p.default.getIconUrl(r.url),e.m_buyBtn.clearClick(),e.m_buyBtn.onClick(function(){u.default.Ins.coin<o.price?d.default.getUI(g.default).setTxt("\u6ca1\u94b1"):(f.default.costMoney(o.price),f.default.gainRes(o.resId,1),n.refreshData(),d.default.getUI(g.default).setTxt("\u8d2d\u4e70\u6210\u529f"))},this)}},e.prototype.onRenderSoldList=function(t,e){var n=this,o=this.soldItem[t],r={data:o,item:e};e.m_numSlider.data=r,e.m_numSlider.on(fgui.Event.STATUS_CHANGED,this.onChangeSlider,this),e.m_soldAll.clearClick(),e.m_item.m_icon.url=p.default.getIconUrl(o.cfg.url),e.m_item.m_frame.m_cQuality.selectedIndex=o.cfg.quality,e.m_numSlider.value=100,e.m_soldAll.onClick(function(){f.default.addMoney(o.cfg.price*o.count),f.default.reduceByList([o.cfgId],[o.count]),n.refreshData(),d.default.getUI(g.default).setTxt("\u51fa\u552e\u6210\u529f")}),this.onChangeSlider(e.m_numSlider)},e.prototype.onChangeSlider=function(t){var e=t.data,n=e.item,o=e.data,r=u.default.Ins.findResNum(o.cfgId),i=Math.ceil(t.value/100*r);o.count=i,n.m_num.text=i.toFixed(0)+"/"+r,n.m_allPrice.text=(i*o.cfg.price).toFixed(0)},e.prototype.onRenderCraftList=function(t,e){var n=this;if(t!=this.craftInfos.length){e.m_cEnd.selectedIndex=0;var o=this.craftInfos[t],r=config.Item.getById(o.targetId);e.m_cNew.selectedIndex=c.default.Ins.isNewCraft(o.id)?1:0,e.m_item.m_frame.m_cQuality.selectedIndex=r.quality,e.m_item.m_icon.url=p.default.getIconUrl(r.url),e.m_matList.itemRenderer=function(t,e){var n=o.matIds[t],r=config.Item.getById(n);e.m_icon.url=p.default.getIconUrl(r.url);var i=u.default.Ins.findResNum(n);e.m_num.text=i+"/"+o.matNums[t],e.m_num.color=i>=o.matNums[t]?cc.Color.BLACK:cc.Color.RED},e.m_matList.numItems=o.matIds.length,e.m_name.text=r.name,e.m_price.text=o.price.toString(),e.m_price.color=u.default.Ins.coin>=o.price?cc.Color.BLACK:cc.Color.RED,e.m_craftBtn.clearClick(),e.m_craftBtn.onClick(function(){u.default.Ins.coin<o.price?d.default.getUI(g.default).setTxt("\u6ca1\u94b1"):f.default.isEnoughByList(o.matIds,o.matNums)?(f.default.costMoney(o.price),f.default.reduceByList(o.matIds,o.matNums),f.default.gainRes(o.targetId,1),n.refreshData(),d.default.getUI(g.default).setTxt("\u5236\u4f5c\u6210\u529f")):d.default.getUI(g.default).setTxt("\u6750\u6599\u4e0d\u8db3")})}else e.m_cEnd.selectedIndex=1},e.prototype.selectTab=function(t){this.selectIdx=t,this._view.m_cMode.selectedIndex=t,this._view.m_tabList.numItems=3,this._view.m_soldTips.visible=1==this.selectIdx&&0==this.soldItem.length},i([m],e)}(h.default));n.default=_,cc._RF.pop()},{"../Controller/Map/MapCtrl":"MapCtrl","../Managers/EventCenter":"EventCenter","../Mgr/UnlockMgr":"UnlockMgr","../Model/Inventory":"Inventory","../Model/ItemInfo":"ItemInfo","../Operator":"Operator","../Res":"Res","./FuiCom":"FuiCom","./UI":"UI","./U_TaskTips":"U_TaskTips"}],U_TaskRequire:[function(t,e,n){"use strict";cc._RF.push(e,"767504w4BBO2o46fvLYESb+","U_TaskRequire");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../../Controller/Map/MapCtrl"),s=t("../../CraftTaskMgr"),c=t("../../Model/Inventory"),u=t("../../Res"),l=t("../FuiCom"),f=t("../UI"),p=t("../U_TaskTips"),h=t("./U_ItemDetail"),d=cc._decorator,g=d.ccclass,y=(d.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.moduleIdList=[1],e.selectIdx=0,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"TaskRequireMenu"}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectModuleId",{get:function(){return this.selectIdx<0||this.selectIdx>=this.moduleIdList.length?-1:this.moduleIdList[this.selectIdx]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"upgradeCfg",{get:function(){return s.default.Ins.getLevelCfg(this.selectModuleId,this.selectModuleInfo.level+1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"curLevelCfg",{get:function(){return s.default.Ins.getLevelCfg(this.selectModuleId,this.selectModuleInfo.level)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selectModuleInfo",{get:function(){return s.default.Ins.getStatusInfo(this.selectModuleId)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"slotInfos",{get:function(){return s.default.Ins.getSlotsInfo(this.selectModuleId)},enumerable:!1,configurable:!0}),e.prototype.refreshPage=function(){var t=this.upgradeCfg,e=this._view.m_craftPage;if(e.m_list.numItems=this.slotInfos.length,this.upgradeCfg){e.m_level.text="lv"+t.level,e.m_slotNum.text=""+t.slotNum,e.m_refreshTime.text=t.refreshTime+"s",e.m_lastLv.text="lv"+this.curLevelCfg.level,e.m_lv.text="lv"+this.upgradeCfg.level,e.m_lastRefreshTime.text=this.curLevelCfg.refreshTime+"s",e.m_refreshTime.text=this.upgradeCfg.refreshTime+"s",e.m_lastSlotNum.text=""+this.curLevelCfg.slotNum,e.m_slotNum.text=""+this.upgradeCfg.slotNum;var n=s.default.Ins.getTaskNumByLevel(this.selectModuleId,this.upgradeCfg.level),o=s.default.Ins.getTaskNumByLevel(this.selectModuleId,this.curLevelCfg.level);e.m_addNum.text="\u589e\u52a0"+(n-o)+"\u79cd\u65b0\u8ba2\u5355",e.m_addNum.visible=n>o;var r=this.upgradeCfg.levelRequireId[0],i=this.upgradeCfg.levelRequireNum[0],a=config.Item.getById(r);e.m_upgradeIcon.url=u.default.getIconUrl(a.url),e.m_upgradeFrame.m_cQuality.selectedIndex=a.quality,e.m_upgradeNum.text=c.default.Ins.findResNum(r)+"/"+i}},e.prototype.onFuiInit=function(){var t=this;this._view.m_craftPage.m_list.itemRenderer=this.onRenderTaskList.bind(this),this._view.m_tabList.itemRenderer=this.onRenderTabList.bind(this),this._view.m_hideBtn.onClick(function(){return t.hide()},this),this._view.m_craftPage.m_upgradeBtn.onClick(this.onUpgradeModule,this),this._view.m_craftPage.m_upgradeIcon.onClick(function(){return f.default.getUI(h.default).setData(t.upgradeCfg.levelRequireId[0])},this)},e.prototype.selectTab=function(t){this.selectIdx=t,this.selectModuleInfo&&this.refreshPage(),this._view.m_tabList.numItems=this.moduleIdList.length},e.prototype.onRenderUpgradeMatList=function(t,e){var n=this.upgradeCfg,o=n.levelRequireId[t],r=n.levelRequireNum[t],i=c.default.Ins.findResNum(o);e.m_icon.url=u.default.getIconUrl(config.Item.getById(o).url),e.m_num.text=i+"/"+r,e.m_num.color=i>=r?cc.Color.GREEN:cc.Color.RED},e.prototype.onUpgradeModule=function(){this.selectModuleId<0||(s.default.isEnoughByList(this.upgradeCfg.levelRequireId,this.upgradeCfg.levelRequireNum)?(s.default.Ins.req_upgradeStatus(this.selectModuleId),this.refreshTabPage()):f.default.getUI(p.default).setTxt("\u6750\u6599\u4e0d\u8db3"))},e.prototype.onRenderTabList=function(t,e){var n=this;this.moduleIdList[t]==this.selectModuleId?e.m_cSelect.selectedIndex=1:e.m_cSelect.selectedIndex=0,e.clearClick(),e.onClick(function(){n.selectTab(t)},this)},e.prototype.onRenderTaskList=function(t,e){var n=this,o=e.m_taskItem;o.m_matList.itemRenderer=this.onRenderMatList.bind(this);var r=this.slotInfos[t],i=s.default.Ins.getLevelCfg(this.selectModuleId,this.selectModuleInfo.level);if(r.craftTaskId<0)s.default.Ins.hasNewCraftTask(this.selectModuleId,this.selectModuleInfo.level)?(e.m_cStatus.selectedIndex=1,e.m_refreshTime.text=""+Math.floor(i.refreshTime-r.timer)):e.m_cStatus.selectedIndex=2;else{e.m_cStatus.selectedIndex=0;var c=config.CraftTask.getById(r.craftTaskId);if(o.m_matList.data=c,c.costCoin>0?o.m_matList.numItems=c.matId.length+1:o.m_matList.numItems=c.matId.length,e.m_taskItem.m_reward.clearClick(),c.resId>0&&c.rewardCoin>0){o.m_reward.m_c1.selectedIndex=2;var l=config.Item.getById(c.resId);o.m_reward.m_frame.m_cQuality.selectedIndex=l.quality,o.m_reward.m_targetIcon.url=u.default.getIconUrl(l.url),o.m_reward.m_coinNum2.text="+"+c.rewardCoin,e.m_taskItem.m_reward.onClick(function(){return f.default.getUI(h.default).setData(c.resId)},this)}else c.rewardCoin>0?(o.m_reward.m_c1.selectedIndex=1,o.m_reward.m_frame.m_cQuality.selectedIndex=1,o.m_reward.m_coinNum.text="+"+c.rewardCoin,e.m_taskItem.m_reward.onClick(function(){return f.default.getUI(h.default).setCoin()},this)):c.resId>0&&(o.m_reward.m_c1.selectedIndex=0,l=config.Item.getById(c.resId),o.m_reward.m_frame.m_cQuality.selectedIndex=l.quality,o.m_reward.m_targetIcon.url=u.default.getIconUrl(l.url),e.m_taskItem.m_reward.onClick(function(){return f.default.getUI(h.default).setData(c.resId)},this));e.m_taskItem.m_cFinish.selectedIndex=s.default.isEnough(c.id)?1:0,e.m_from.text="\u6765\u81ea"+c.from+"\u7684\u8ba2\u5355",o.m_trackBtn.clearClick(),o.m_trackBtn.onClick(function(){s.default.Ins.setTracking(c.id),f.default.getUI(p.default).setTxt("\u5df2\u6dfb\u52a0\u5230\u8ffd\u8e2a")},this),o.m_finishBtn.clearClick(),o.m_finishBtn.onClick(function(){s.default.Ins.trackingTaskInfo&&c.id==s.default.Ins.trackingTaskInfo.id&&s.default.Ins.clearTracking(),a.default.Ins.heartCtrl.finishCraftTask(c.id,r.slotId),n.refreshTabPage()},this)}},e.prototype.refreshTabPage=function(){this.selectTab(this.selectIdx)},e.prototype.show=function(){t.prototype.show.call(this),this.selectTab(0),s.default.on(s.ECraftTaskEvent.E_CraftTaskUpdateRefresh,this.onListenRefreshUpdate,this),s.default.on(s.ECraftTaskEvent.E_CraftTaskFinishRefresh,this.onListenRefreshFinish,this)},e.prototype.hide=function(){t.prototype.hide.call(this),s.default.off(s.ECraftTaskEvent.E_CraftTaskUpdateRefresh,this.onListenRefreshUpdate,this),s.default.off(s.ECraftTaskEvent.E_CraftTaskFinishRefresh,this.onListenRefreshFinish,this),a.default.Ins.returnToPlayer()},e.prototype.onListenRefreshUpdate=function(t,e){t==this.selectModuleId&&this.onRefreshTaskSlot(e)},e.prototype.onListenRefreshFinish=function(t,e){t==this.selectModuleId&&this.onRefreshTaskSlot(e)},e.prototype.onRefreshTaskSlot=function(t){var e=this._view.m_craftPage.m_list,n=e.itemIndexToChildIndex(t),o=e.getChildAt(n);this.onRenderTaskList(t,o)},e.prototype.onRenderMatList=function(t,e){var n=e.parent.data;if(e.clearClick(),0==t&&n.costCoin>0)return e.m_icon.url=u.default.getIconUrl(u.default.coinUrl),e.m_num.text=""+n.costCoin,e.m_num.color=c.default.Ins.coin>=n.costCoin?cc.Color.GREEN:cc.Color.RED,void e.onClick(function(){return f.default.getUI(h.default).setCoin()},this);var o=n.costCoin>0?t-1:t,r=n.matId[o],i=n.matNum[o];e.onClick(function(){return f.default.getUI(h.default).setData(r)},this);var a=c.default.Ins.findResNum(r),s=config.Item.getById(r);e.m_icon.url=u.default.getIconUrl(s.url),e.m_num.text=a+"/"+i,e.m_num.color=a>=i?cc.Color.GREEN:cc.Color.RED},i([g],e)}(l.default));n.default=y,cc._RF.pop()},{"../../Controller/Map/MapCtrl":"MapCtrl","../../CraftTaskMgr":"CraftTaskMgr","../../Model/Inventory":"Inventory","../../Res":"Res","../FuiCom":"FuiCom","../UI":"UI","../U_TaskTips":"U_TaskTips","./U_ItemDetail":"U_ItemDetail"}],U_TaskTips:[function(t,e,n){"use strict";cc._RF.push(e,"382c2SIGoxLyIjn2jByMD81","U_TaskTips");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Controller/Map/TileTips"),s=t("../Operator"),c=t("./FuiCom"),u=cc._decorator,l=u.ccclass,f=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tween=null,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"TaskTips",exts:[]}},enumerable:!1,configurable:!0}),e.prototype.setData=function(t,e){switch(t){case s.ETaskErrorCode.Unexplored:var n=e[0];a.default.Ins.highLightTile(n,cc.Color.RED);break;case s.ETaskErrorCode.LowPickaxeLevel:break;case s.ETaskErrorCode.NoMatchWeaponMonster:case s.ETaskErrorCode.LowWeaponLevel:}this.setTxt(t.toString())},e.prototype.setTxt=function(t){this.getChild("label").asLabel.text=t,this._view.getTransition("t0").play()},i([l],e)}(c.default));n.default=f,cc._RF.pop()},{"../Controller/Map/TileTips":"TileTips","../Operator":"Operator","./FuiCom":"FuiCom"}],U_TitleBoard:[function(t,e,n){"use strict";cc._RF.push(e,"0152676Er5HzK11dAC29OZZ","U_TitleBoard");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../FuiCom"),s=cc._decorator,c=s.ccclass,u=(s.property,function(){this.title="hello",this.index=0}),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.infoQueue=[],e.isInTitle=!1,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"Springboard"}},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){var t=this;this._view.m_tEnter.setHook("end",function(){t.isInTitle=!1,t.detect()})},e.prototype.setData=function(t,e){void 0===e&&(e=0);var n=new u;n.title=t,n.index=e,this.infoQueue.push(n),this.isInTitle||this.detect()},e.prototype.detect=function(){if(0!=this.infoQueue.length){this.show();var t=this.infoQueue.shift();this.isInTitle=!0,this._view.m_tEnter.play(),this._view.m_title.text=t.title,this._view.m_board.m_cType.selectedIndex=t.index}else this.hide()},i([c],e)}(a.default);n.default=l,cc._RF.pop()},{"../FuiCom":"FuiCom"}],U_TouchPad:[function(t,e,n){"use strict";cc._RF.push(e,"a12a41dP5BDSqjCX8WQsLVw","U_TouchPad");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("../Controller/TouchCtrl/MainTouchCtrl"),s=t("./FuiCom"),c=cc._decorator,u=c.ccclass,l=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isInTouch=!1,e}return r(e,t),Object.defineProperty(e.prototype,"pkg",{get:function(){return{pkgName:"DiggingUI",comName:"TouchPad",exts:[]}},enumerable:!1,configurable:!0}),e.prototype.onFuiInit=function(){this._view.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this._view.on(fairygui.Event.TOUCH_BEGIN,this.onTouch,this),this._view.on(fairygui.Event.TOUCH_END,this.onTouchEnd,this)},e.prototype.onTouch=function(t){var e=t.touch.getLocation();a.default.Ins.onTouch(e),this.isInTouch=!0},e.prototype.onTouchEnd=function(){this.isInTouch=!1,a.default.Ins.onEndGrid()},e.prototype.onTouchMove=function(t){if(this.isInTouch){var e=t.getTouches();if(e.length>1){var n=e[0]._point,o=e[1]._point;a.default.Ins.onTouchDoubleMove(n,o)}else a.default.Ins.onMoveGrid(t.getDelta())}},i([u],e)}(s.default));n.default=l,cc._RF.pop()},{"../Controller/TouchCtrl/MainTouchCtrl":"MainTouchCtrl","./FuiCom":"FuiCom"}],U_UIEffects:[function(t,e,n){"use strict";cc._RF.push(e,"37961wFAOxJT5k3QSOFSuJ4","U_UIEffects");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(e){i(e)}}function s(t){try{c(o.throw(t))}catch(e){i(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(a,s)}c((o=o.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(t){return function(e){return c([t,e])}}function c(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(s){i=[6,s],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0});var c=t("../Managers/PoolManager"),u=t("../Res"),l=t("../Utils/CocosExtension"),f=t("./Tips/FlyIcon"),p=t("./UINode"),h=cc._decorator,d=h.ccclass,g=h.property,y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.flyCoins=function(t,e,n,o,r){return void 0===r&&(r=50),a(this,void 0,void 0,function(){var i=this;return s(this,function(){return[2,new Promise(function(c){return a(i,void 0,void 0,function(){var i,a;return s(this,function(s){switch(s.label){case 0:i=t,a=0,s.label=1;case 1:return a<t?[4,l.delay(r)]:[3,4];case 2:s.sent(),this.flyCoin(e,n,function(){i--,o&&o(),i<=0&&c()}),s.label=3;case 3:return a++,[3,1];case 4:return[2]}})})})]})})},e.prototype.flyCoin=function(t,e,n,o){void 0===o&&(o=!0);var r=c.PoolManager.GetPrefab(this.p_flyIcon);r.setParent(this.node);var i=this.node.convertToNodeSpaceAR(t.convertToWorldSpaceAR(cc.v2(0,0))),a=this.node.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.v2(0,0)));r.getComponent(f.default).setData(u.default.coinUrl,i,a,n,o)},i([g(cc.Prefab)],e.prototype,"p_flyIcon",void 0),i([d],e)}(p.default);n.default=y,cc._RF.pop()},{"../Managers/PoolManager":"PoolManager","../Res":"Res","../Utils/CocosExtension":"CocosExtension","./Tips/FlyIcon":"FlyIcon","./UINode":"UINode"}],UnlockMgr:[function(t,e,n){"use strict";cc._RF.push(e,"9c1557uu/NP57QIN3t3NjZ3","UnlockMgr");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.EUnlockEvent=void 0;var r,i=t("../Managers/EventCenter"),a=t("./StorageMgr");(function(t){t.unlockCraft="unlockCraft",t.unlockBuy="unlockBuy",t.clearNewUnlock="clearNewUnlock"})(r=n.EUnlockEvent||(n.EUnlockEvent={}));var s=function(){function t(){this.craftUnlockMap=new Map,this.buyUnlockMap=new Map,this.newCraft=new Set,this.newGoods=new Set,this.loadData()}return Object.defineProperty(t,"Ins",{get:function(){return this.instance||(this.instance=new t),this.instance},enumerable:!1,configurable:!0}),t.send=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];i.default.send.apply(i.default,o([t],e))},t.on=function(t,e,n){i.default.on(t,e,n)},t.once=function(t,e,n){i.default.once(t,e,n)},t.off=function(t,e,n){i.default.off(t,e,n)},t.prototype.isUnlockCraft=function(t){return!!this.craftUnlockMap.get(t)},t.prototype.isNewCraft=function(t){return!!this.newCraft.has(t)},t.prototype.unlockCraft=function(e){this.isUnlockCraft(e)||(this.newCraft.add(e),t.send(r.unlockCraft,e)),this.craftUnlockMap.set(e,!0)},t.prototype.clearNewUnlock=function(){this.newCraft.clear(),this.newGoods.clear(),t.send(r.clearNewUnlock)},t.prototype.isUnlockBuy=function(t){return!!this.buyUnlockMap.get(t)},t.prototype.unlockBuy=function(e){this.isUnlockBuy(e)||(this.newGoods.add(e),t.send(r.unlockBuy,e)),this.buyUnlockMap.set(e,!0)},t.prototype.isNewBuy=function(t){return!!this.newGoods.has(t)},t.prototype.saveData=function(){var t=[];this.craftUnlockMap.forEach(function(e,n){t.push({craftId:n,isLock:e})});var e=[];this.buyUnlockMap.forEach(function(t,n){e.push({goodsId:n,isLock:t})}),a.default.setItem(a.EStorageKey.craftLock,JSON.stringify(t)),a.default.setItem(a.EStorageKey.buyLock,JSON.stringify(e))},t.prototype.clearSave=function(){a.default.removeItem(a.EStorageKey.craftLock),a.default.removeItem(a.EStorageKey.buyLock)},t.prototype.loadData=function(){var t=this,e=a.default.getItem(a.EStorageKey.craftLock);if(e)JSON.parse(e).forEach(function(e){t.craftUnlockMap.set(e.craftId,e.isLock)});else for(var n=0;n<config.ShopCraft.list.length;n++)this.craftUnlockMap.set(config.ShopCraft.list[n].id,!1);if(e=a.default.getItem(a.EStorageKey.buyLock))JSON.parse(a.default.getItem(a.EStorageKey.buyLock)).forEach(function(e){t.buyUnlockMap.set(e.goodsId,e.isLock)});else for(n=0;n<config.ShopGoods.list.length;n++)this.buyUnlockMap.set(config.ShopGoods.list[n].id,!!config.ShopGoods.list[n].unlockInit)},t}();n.default=s,window.UnlockMgr=s,cc._RF.pop()},{"../Managers/EventCenter":"EventCenter","./StorageMgr":"StorageMgr"}],WidgetUINode:[function(t,e,n){"use strict";cc._RF.push(e,"a870c347JRL0oKp66Pm5LO7","WidgetUINode");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=t("./UINode"),s=t("./Widget"),c=cc._decorator,u=c.ccclass,l=c.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.privateNode=!0,e.nodesMap=new Map,e}return r(e,t),e.prototype.getCom=function(t,e){var n=this.getNode(t);return n?n.getComponent(e):null},e.prototype.getNode=function(t){return this.nodesMap.get(t)||(console.warn("null node: "+t+" from "+cc.Node.name),null)},e.prototype.scan=function(){this.nodesMap=new Map,this.scanChild(this.node)},e.prototype.scanChild=function(t){var e=this;t.children.forEach(function(t){e.debugChild(t),t.name.length>0&&"_"==t.name[0]&&e.nodesMap.set(t.name,t);var n=t.getComponent(s.default);n&&n.privateNode||e.scanChild(t)})},e.prototype.debugChild=function(){},e.prototype.onLoad=function(){t.prototype.onLoad.call(this),this.scan()},i([l],e.prototype,"privateNode",void 0),i([u],e)}(a.default);n.default=f,cc._RF.pop()},{"./UINode":"UINode","./Widget":"Widget"}],Widget:[function(t,e,n){"use strict";cc._RF.push(e,"d9a79+6FLJDsqmewicM2nQt","Widget");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(n,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,c=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.privateNode=!0,e.nodesMap=new Map,e}var n;return r(e,t),n=e,e.prototype.getCom=function(t,e){var n=this.getNode(t);return n?n.getComponent(e):null},e.prototype.getNode=function(t){return this.nodesMap.get(t)||null},e.prototype.scan=function(){this.nodesMap=new Map,this.scanChild(this.node)},e.prototype.scanChild=function(t){var e=this;t.children.forEach(function(t){e.debugChild(t),t.name.length>0&&"_"==t.name[0]&&e.nodesMap.set(t.name,t);var o=t.getComponent(n);o&&o.privateNode||e.scanChild(t)})},e.prototype.debugChild=function(){},e.prototype.onLoad=function(){this.scan()},i([c],e.prototype,"privateNode",void 0),n=i([s],e)}(cc.Component);n.default=u,cc._RF.pop()},{}],WorksObj:[function(t,e,n){"use strict";cc._RF.push(e,"55107bZwMpHDoEIti6YZlT9","WorksObj");var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(n,"__esModule",{value:!0}),n.ECraftEvent=void 0;var a,s=t("../../../Factory"),c=t("../../../Managers/EventCenter"),u=t("../../../Model/ItemInfo"),l=t("../../../Operator"),f=t("../../../UI/FairyUI/U_CraftMenu"),p=t("../../../UI/FairyUI/U_CraftMenu2"),h=t("../../../UI/UI"),d=t("../../../UI/U_TaskTips"),g=t("../../Player/PlayerCtrl"),y=t("../MapCtrl"),m=t("../TileTips"),_=t("./TileObject");(function(t){t.UpdateProgress="UpdateProgress",t.FinishOne="FinishOne",t.AllFinish="AllFinish"})(a=n.ECraftEvent||(n.ECraftEvent={}));var v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.craftId=-1,e.craftedItem=null,e.isFinish=!0,e.timer=0,e.craftTime=0,e.hasNewRecipe=!1,e}return r(e,t),Object.defineProperty(e.prototype,"workCfg",{get:function(){var t=this;return config.Works.list.find(function(e){return e.objId==t.objId})},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlockMove",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.init=function(e){t.prototype.init.call(this,e),c.default.on(c.E_NewCraft,this.onNewCraft,this)},e.prototype.clear=function(){t.prototype.clear.call(this),c.default.off(c.E_NewCraft,this.onNewCraft,this)},e.prototype.onNewCraft=function(t){this.workCfg.id==t&&(this.hasNewRecipe=!0,this.updateAnim())},e.prototype.updateAnim=function(){this.hasNewRecipe?m.default.Ins.setCraftTips(this.grid,3):this.craftNum>0?(m.default.Ins.setCraftTips(this.grid,1),this.isFinish=!1):this.isFinish&&null!=this.craftedItem?m.default.Ins.setCraftTips(this.grid,2):this.isFinish&&null==this.craftedItem&&m.default.Ins.setCraftTips(this.grid,0)},e.prototype.addCraft=function(t){var e=config.Craft.getById(t),n=u.default.canStack(e.resId);if(this.isFinish&&!this.craftedItem)this.craftId=t,this.craftNum=1,this.craftTime=config.Craft.getById(t).craftTime,this.timer=0,l.default.consumeCraftMat(t);else{if(t!=t||!n)return void h.default.getUI(d.default).setTxt("\u8bf7\u7b49\u5f85\u5f53\u524d\u5236\u4f5c");this.craftNum++,l.default.consumeCraftMat(t)}this.updateAnim()},e.prototype.onUpdate=function(t){if(!(this.craftId<0||this.isFinish)){var e=config.Craft.getById(this.craftId);this.timer+=t,this.emit(a.UpdateProgress,this.timer/this.craftTime),this.timer>this.craftTime&&(this.craftNum--,null==this.craftedItem&&(this.craftedItem=s.default.getItemInfo(e.resId)),this.timer=0,this.craftedItem.count++,this.emit(a.FinishOne),this.craftNum<=0&&(this.isFinish=!0,this.emit(a.AllFinish),this.updateAnim()))}},e.prototype.on=function(t,e,n){this.grid.on(t,e,n)},e.prototype.off=function(t,e,n){this.grid.off(t,e,n)},e.prototype.emit=function(t){for(var e,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];(e=this.grid).emit.apply(e,i([t],n))},e.prototype.gainCraftedItem=function(){null!=this.craftedItem&&(l.default.gainRes(this.craftedItem.cfgId,this.craftedItem.count),this.craftedItem=null,0==this.craftNum&&this.isFinish&&this.updateAnim())},e.prototype.onClick=function(){var t=this,e=y.default.Ins.findCrdSideofObj(this.grid,function(e){return!e.isBlockMove||e.crd.equals(t.grid.crd)});e?g.default.Ins.moveToGrid(e,function(){(11==t.objId?h.default.getUI(p.default):h.default.getUI(f.default)).setTarget(t,function(){}),y.default.Ins.focusToCrdAsync(t.grid.crd),t.hasNewRecipe=!1,t.updateAnim()}):h.default.getUI(d.default).setTxt("\u4e0d\u53ef\u5230\u8fbe")},e}(_.default);n.default=v,cc._RF.pop()},{"../../../Factory":"Factory","../../../Managers/EventCenter":"EventCenter","../../../Model/ItemInfo":"ItemInfo","../../../Operator":"Operator","../../../UI/FairyUI/U_CraftMenu":"U_CraftMenu","../../../UI/FairyUI/U_CraftMenu2":"U_CraftMenu2","../../../UI/UI":"UI","../../../UI/U_TaskTips":"U_TaskTips","../../Player/PlayerCtrl":"PlayerCtrl","../MapCtrl":"MapCtrl","../TileTips":"TileTips","./TileObject":"TileObject"}],arraycollection:[function(t,e,n){"use strict";cc._RF.push(e,"a6871f9r3xF449ZLRRhMgOx","arraycollection"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function t(t){if(this.sizeNum=0,"number"==typeof t){if(t<0)throw new Error("is no arrayList index : "+t);this.elementData=new Array(t)}else this.constructor(10)}return t.prototype.add=function(t,e){"number"==typeof t?(this.ensureExplicitVapacity(),this.rangeCheck(t),this.elementData.splice(t,0,e),this.sizeNum++):(this.ensureExplicitVapacity(),this.elementData[this.sizeNum]=t,this.sizeNum++)},t.prototype.get=function(t){return this.rangeCheck(t),this.elementData[t]},t.prototype.contains=function(t){return-1!=this.elementData.indexOf(t)},t.prototype.clear=function(){this.elementData=[],this.sizeNum=0},t.prototype.update=function(t,e){this.rangeCheck(t),this.elementData[t]=e},t.prototype.remove=function(t){for(var e=!1,n=0;n<this.sizeNum;n++)this.get(n)===t&&(e=this.removeAt(n));if(0==e)return console.log("is no object?"),e},t.prototype.removeAt=function(t){return this.elementData.splice(t,1),this.sizeNum--,!0},t.prototype.size=function(){return this.sizeNum},t.prototype.rangeCheck=function(t){if(t>=this.sizeNum||t<0)throw new Error("is no index---\x3e"+t)},t.prototype.ensureExplicitVapacity=function(){if(this.elementData.length<this.sizeNum+1){var t=this.elementData.length,e=t+(t>>1);this.elementData.length=e}},t}();n.default=o,cc._RF.pop()},{}],collectutil:[function(t,e,n){"use strict";cc._RF.push(e,"db5dflPoP9JCINuazUNBX1t","collectutil"),Object.defineProperty(n,"__esModule",{value:!0}),n.MULTIPLE_INSTANCES_FOUND_MSG=n.ITEM_NOT_FOUND_MSG=n.objCompare=n.Group=void 0;var o=t("./list");n.Group=function(t,e){this.list=new o.List,this.groups=t,this.list=new o.List(e)},n.objCompare=function(t,e){return t==e},n.ITEM_NOT_FOUND_MSG="Item does not exist.",n.MULTIPLE_INSTANCES_FOUND_MSG="Multiple instances of entity found.",cc._RF.pop()},{"./list":"list"}],config:[function(t,e){"use strict";var n;cc._RF.push(e,"6c0dbKNXW1FabOgJpe9NGoD","config"),function(t){var e=function(t,n,o){var r=n[o];if(void 0===r)return t;if(0===r){for(var i=[],a=0,s=t.length;a<s;++a)i.push(e(t[a],n,o+1));return i}if(1===r){for(var c in i=new Map,t)i.set(c,e(t[c],n,o+1));return i}if(2===r){for(var c in i=new Map,t)i.set(parseInt(c),e(t[c],n,o+1));return i}return i=new r,Object.assign(i,t),i};(function(t){t[t.AddCoin=1]="AddCoin",t[t.AddExp=2]="AddExp"})(t.GameRewardType||(t.GameRewardType={})),function(t){t[t.Res=0]="Res",t[t.Pickaxe=1]="Pickaxe",t[t.Weapon=2]="Weapon",t[t.Blueprint=3]="Blueprint",t[t.Consume=4]="Consume",t[t.Slabstone=5]="Slabstone",t[t.Fake=6]="Fake"}(t.ItemType||(t.ItemType={})),function(t){t[t.WHITE=0]="WHITE",t[t.GREEN=1]="GREEN",t[t.BLUE=2]="BLUE",t[t.PURPLE=3]="PURPLE",t[t.ORANGE=4]="ORANGE",t[t.RED=5]="RED",t[t.PINK=6]="PINK"}(t.Quality||(t.Quality={}));var n=function(){};t.GameRewardData=n;var o=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Building=o;var r=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.BuildingHeadquarter=r;var i=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Equipment=i;var a=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(n,o){o||(t.list.length=0,t.map.clear(),t.sheetMap.clear(),t.sheetList.clear());var r=t.sheetList.get("agile")||[],i=t.sheetMap.get("agile")||new Map;for(var a in t.sheetList.set("agile",r),t.sheetMap.set("agile",i),n.heroAgile){var s=n.heroAgile[a],c=(f=t.map.get(s.id))||new t;Object.assign(c,s),s.testMap&&(c.testMap=e(s.testMap,[1],0)),f||(t.list.push(c),t.map.set(c.id,c),r.push(c),i.set(c.id,c))}var u=t.sheetList.get("strength")||[],l=t.sheetMap.get("strength")||new Map;for(var a in t.sheetList.set("strength",u),t.sheetMap.set("strength",l),n.heroStrength){var f;s=n.heroStrength[a],c=(f=t.map.get(s.id))||new t,Object.assign(c,s),s.testMap&&(c.testMap=e(s.testMap,[1],0)),f||(t.list.push(c),t.map.set(c.id,c),u.push(c),l.set(c.id,c))}},t.list=[],t.map=new Map,t.sheetMap=new Map,t.sheetList=new Map,t}();t.Hero=a;var s=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.link=function(){for(var e=t.list,n=0,r=e.length;n<r;++n){var i=e[n],a=i.c_item_buildingId;a&&(i.buildingId=o.getById(a),delete i.c_item_buildingId)}},t.list=[],t.map=new Map,t}();t.IslandConfig=s;var c=function(){function t(){}return t.decode=function(e,n){for(var o in!n&&(t.config=new t),e)t.config[o]=e[o]},t}();t.Player=c;var u=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(o,r){for(var i in r||(t.list.length=0,t.map.clear()),o){var a=o[i],s=t.map.get(a.id),c=s||new t;Object.assign(c,a),a.dynamicArray&&(c.dynamicArray=e(a.dynamicArray,[0,n],0)),a.dynamicMap&&(c.dynamicMap=e(a.dynamicMap,[2,n],0)),a.enumMap&&(c.enumMap=e(a.enumMap,[1],0)),a.arrayMap&&(c.arrayMap=e(a.arrayMap,[0,1,0],0)),a.arrayMap2&&(c.arrayMap2=e(a.arrayMap2,[0,0,1],0)),a.dynamic&&(c.dynamic=e(a.dynamic,[n],0)),a.dynamicMapArray&&(c.dynamicMapArray=e(a.dynamicMapArray,[1,0,n],0)),a.dynamicArrayArray&&(c.dynamicArrayArray=e(a.dynamicArrayArray,[0,0,n],0)),a.enumKeyMap&&(c.enumKeyMap=e(a.enumKeyMap,[2,0],0)),s||(t.list.push(c),t.map.set(c.id,c))}},t.list=[],t.map=new Map,t}();t.Task=u;var l=function(){function t(){}return t.decode=function(e,n){for(var o in!n&&(t.config=new t),e)t.config[o]=e[o]},t}();t.MonsterCfg=l;var f=function(){function t(){}return t.decode=function(e,n){for(var o in!n&&(t.config=new t),e)t.config[o]=e[o]},t}();t.MapCfg=f;var p=function(){function t(){}return t.decode=function(e,n){for(var o in!n&&(t.config=new t),e)t.config[o]=e[o]},t}();t.GameCfg=p;var h=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Craft=h;var d=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Works=d;var g=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.CraftTask=g;var y=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.CraftModule=y;var m=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.ModuleLevel=m;var _=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Dialog=_;var v=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Head=v;var I=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.BlockDrop=I;var b=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.MonsterDrop=b;var C=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Pickaxe=C;var M=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Item=M;var w=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Weapon=w;var P=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Blueprint=P;var O=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.ItemTypeCfg=O;var T=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Consume=T;var j=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.MonsterData=j;var k=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.QualityColor=k;var S=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Region=S;var U=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.RegionLockMap=U;var R=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.ShopGoods=R;var E=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.ShopCraft=E;var A=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.HeartTask=A;var x=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.MapObject=x;var D=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.MapOre=D;var F=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.BlockObj=F;var G=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Plant=G;var B=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.MapGrid=B;var N=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.BigOre=N;var L=function(){function t(){}return t.getById=function(e){return t.map.get(e)},t.decode=function(e,n){for(var o in n||(t.list.length=0,t.map.clear()),e){var r=e[o],i=t.map.get(r.id),a=i||new t;Object.assign(a,r),i||(t.list.push(a),t.map.set(a.id,a))}},t.list=[],t.map=new Map,t}();t.Door=L,t.decodeConfig=function(t,e){for(var n in void 0===e&&(e=!1),t)"building"===n&&o.decode(t[n],e),"buildingHeadquarter"===n&&r.decode(t[n],e),"equipment"===n&&i.decode(t[n],e),"hero"===n&&a.decode(t[n],e),"islandConfig"===n&&s.decode(t[n],e),"player"===n&&c.decode(t[n],e),"task"===n&&u.decode(t[n],e),"monsterCfg"===n&&l.decode(t[n],e),"mapCfg"===n&&f.decode(t[n],e),"gameCfg"===n&&p.decode(t[n],e),"craft"===n&&h.decode(t[n],e),"works"===n&&d.decode(t[n],e),"craftTask"===n&&g.decode(t[n],e),"craftModule"===n&&y.decode(t[n],e),"moduleLevel"===n&&m.decode(t[n],e),"dialog"===n&&_.decode(t[n],e),"head"===n&&v.decode(t[n],e),"blockDrop"===n&&I.decode(t[n],e),"monsterDrop"===n&&b.decode(t[n],e),"pickaxe"===n&&C.decode(t[n],e),"item"===n&&M.decode(t[n],e),"weapon"===n&&w.decode(t[n],e),"blueprint"===n&&P.decode(t[n],e),"itemTypeCfg"===n&&O.decode(t[n],e),"consume"===n&&T.decode(t[n],e),"monsterData"===n&&j.decode(t[n],e),"qualityColor"===n&&k.decode(t[n],e),"region"===n&&S.decode(t[n],e),"regionLockMap"===n&&U.decode(t[n],e),"shopGoods"===n&&R.decode(t[n],e),"shopCraft"===n&&E.decode(t[n],e),"heartTask"===n&&A.decode(t[n],e),"mapObject"===n&&x.decode(t[n],e),"mapOre"===n&&D.decode(t[n],e),"blockObj"===n&&F.decode(t[n],e),"plant"===n&&G.decode(t[n],e),"mapGrid"===n&&B.decode(t[n],e),"bigOre"===n&&N.decode(t[n],e),"door"===n&&L.decode(t[n],e);s.link()},t.configList=["GameRewardData","building","buildingHeadquarter","equipment","hero","islandConfig","player","task","monsterCfg","mapCfg","gameCfg","craft","works","craftTask","craftModule","moduleLevel","dialog","head","blockDrop","monsterDrop","pickaxe","item","weapon","blueprint","itemTypeCfg","consume","monsterData","qualityColor","region","regionLockMap","shopGoods","shopCraft","heartTask","mapObject","mapOre","blockObj","plant","mapGrid","bigOre","door"]}(n||(n={})),window.config=n,cc._RF.pop()},{}],dictionary:[function(t,e,n){"use strict";cc._RF.push(e,"2f02cG+qlhIqY28MUCLdAuM","dictionary"),Object.defineProperty(n,"__esModule",{value:!0}),n.KeyValuePair=n.Dictionary=void 0;var o=t("./list"),r=t("./collectutil"),i=function(){function t(t){void 0===t&&(t=null),this.list=new Array,t&&(this.list=t)}return t.prototype.add=function(t,e){var n=new a(t,e);if(this.containsKey(t))throw"Duplicate key. Cannot add.";this.list.push(n)},t.prototype.addRange=function(t){var e=this;t.forEach(function(t){return e.add(t.key,t.value)})},t.prototype.clear=function(){this.list=new Array},t.prototype.remove=function(t){var e=new Array;this.list.forEach(function(n){t(n)||e.push(n)}),this.list=e},t.prototype.containsKey=function(t){return this.any(function(e){return r.objCompare(e.key,t)})},t.prototype.containsValue=function(t){return this.any(function(e){return r.objCompare(e.value,t)})},t.prototype.tryGetValue=function(t){var e=this.singleOrDefault(function(e){return r.objCompare(e.key,t)});return e?e.value:null},t.prototype.asEnumerable=function(){return this},Object.defineProperty(t.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),t.prototype.elementAt=function(t){try{return this.list[t]}catch(e){return null}},t.prototype.any=function(t){if(!t)return this.list.length>0;for(var e=0;e<this.list.length;e++)if(t(this.list[e]))return!0;return!1},t.prototype.all=function(t){if(!t)return this.list.length>0;for(var e=0;e<this.list.length;e++)if(!t(this.list[e]))return!1;return!0},t.prototype.single=function(t){if(void 0===t&&(t=null),this.list.length<=0)throw r.ITEM_NOT_FOUND_MSG;if(t){var e=this.singleOrDefault(t);if(!e)throw r.ITEM_NOT_FOUND_MSG;return e}return this.list[0]},t.prototype.first=function(t){if(void 0===t&&(t=null),this.list.length<=0)throw r.ITEM_NOT_FOUND_MSG;if(t){var e=this.firstOrDefault(t);if(!e)throw r.ITEM_NOT_FOUND_MSG;return e}return this.list[0]},t.prototype.last=function(t){if(this.list.length<=0)throw r.ITEM_NOT_FOUND_MSG;if(t){var e=this.lastOrDefault(t);if(!e)throw r.ITEM_NOT_FOUND_MSG;return e}return this.list[this.list.length-1]},t.prototype.singleOrDefault=function(t){var e=new Array;if(this.list.filter(function(n){t(n)&&e.push(n)}),e.length>1)throw r.MULTIPLE_INSTANCES_FOUND_MSG;return e.length<=0?null:e[0]},t.prototype.firstOrDefault=function(t){for(var e=0;e<this.length;e++){var n=this.list[e];if(t(n))return n}return null},t.prototype.lastOrDefault=function(t){for(var e=this.length;e>=0;e--){var n=this.list[e-1];if(t(n))return n}return null},t.prototype.where=function(e){var n=new t;return this.list.filter(function(t){e(t)&&n.add(t.key,t.value)}),n},t.prototype.select=function(t){var e=new o.List;return this.forEach(function(n){return e.add(t(n))}),e},t.prototype.forEach=function(t){this.list.forEach(function(e){return t(e)})},t.prototype.toArray=function(){return this.list},t.prototype.join=function(t,e,n,r,i){void 0===i&&(i=!1);var a=new o.List;return this.list.forEach(function(o){var s=t.toArray().filter(function(t){return e(o)===n(t)});i&&s&&s.length<=0?a.add(r(o,null)):s.forEach(function(t){return a.add(r(o,t))})}),a},t.prototype.groupBy=function(t){var e={};this.list.forEach(function(n){var o=JSON.stringify(t(n));e[o]=e[o]||[],e[o].push(n)});var n=Object.keys(e).map(function(t){var n=t.substr(1,t.length-2);return new r.Group(n.split(","),e[t])});return new o.List(n)},t.prototype.orderBy=function(t){var e=this.list.sort(function(e,n){return t.compare(e,n)});return new o.List(e)},t.prototype.distinct=function(t){var e=new o.List;return this.forEach(function(n){e.forEach(function(o){t.equals(n,o)||e.add(n)})}),e},t.prototype.union=function(t){return this.addRange(t.toArray()),this},t.prototype.skip=function(e){return e>0?new t(this.list.slice(e,this.list.length-1)):this},t.prototype.take=function(e){return e>0?new t(this.list.slice(0,e)):this},t.prototype.sum=function(t){var e=0;return this.list.forEach(function(n){return e+=t(n)}),e},t.prototype.avg=function(t){return this.sum(t)/this.length},t.prototype.min=function(t){var e=0,n=0;return this.list.forEach(function(o){if(0==n)e=t(o);else{var r=t(o);r<e&&(e=r)}n++}),e},t.prototype.max=function(t){var e=0,n=0;return this.list.forEach(function(o){if(0==n)e=t(o);else{var r=t(o);r>e&&(e=r)}n++}),e},t.prototype.count=function(t){if(void 0===t&&(t=null),!t)return this.length;var e=0;return this.list.forEach(function(n){t(n)&&e++}),e},t}();n.Dictionary=i;var a=function(t,e){this.key=t,this.value=e};n.KeyValuePair=a,cc._RF.pop()},{"./collectutil":"collectutil","./list":"list"}],interfaces:[function(t,e,n){"use strict";cc._RF.push(e,"1f7fc41HCxMBJn+WQrBQgwb","interfaces"),Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],list:[function(t,e,n){"use strict";cc._RF.push(e,"95a9bbn+wdD7pQUKgZXRTU6","list"),Object.defineProperty(n,"__esModule",{value:!0}),n.List=void 0;var o=t("./collectutil"),r=function(){function t(t){void 0===t&&(t=null),this.list=new Array,t&&(this.list=t)}return t.prototype.add=function(t){this.list.push(t)},t.prototype.addRange=function(t){var e=this;t.forEach(function(t){return e.add(t)})},t.prototype.remove=function(t){var e=new Array;this.list.forEach(function(n){t(n)||e.push(n)}),this.list=e},t.prototype.clear=function(){this.list=new Array},t.prototype.asEnumerable=function(){return this},Object.defineProperty(t.prototype,"length",{get:function(){return this.list.length},enumerable:!1,configurable:!0}),t.prototype.elementAt=function(t){try{return this.list[t]}catch(e){return null}},t.prototype.any=function(t){if(!t)return this.list.length>0;for(var e=0;e<this.list.length;e++)if(t(this.list[e]))return!0;return!1},t.prototype.all=function(t){if(!t)return this.list.length>0;for(var e=0;e<this.list.length;e++)if(!t(this.list[e]))return!1;return!0},t.prototype.single=function(t){if(void 0===t&&(t=null),this.list.length<=0)throw o.ITEM_NOT_FOUND_MSG;if(t){var e=this.singleOrDefault(t);if(!e)throw o.ITEM_NOT_FOUND_MSG;return e}return this.list[0]},t.prototype.first=function(t){if(void 0===t&&(t=null),this.list.length<=0)throw o.ITEM_NOT_FOUND_MSG;if(t){var e=this.firstOrDefault(t);if(!e)throw o.ITEM_NOT_FOUND_MSG;return e}return this.list[0]},t.prototype.last=function(t){if(void 0===t&&(t=null),this.list.length<=0)throw o.ITEM_NOT_FOUND_MSG;if(t){var e=this.lastOrDefault(t);if(!e)throw o.ITEM_NOT_FOUND_MSG;return e}return this.list[this.list.length-1]},t.prototype.singleOrDefault=function(t){var e=new Array;if(this.list.filter(function(n){t(n)&&e.push(n)}),e.length>1)throw o.MULTIPLE_INSTANCES_FOUND_MSG;return e.length<=0?null:e[0]},t.prototype.firstOrDefault=function(t){for(var e=0;e<this.length;e++){var n=this.list[e];if(t(n))return n}return null},t.prototype.lastOrDefault=function(t){for(var e=this.length;e>=0;e--){var n=this.list[e-1];if(t(n))return n}return null},t.prototype.where=function(e){var n=new t;return this.list.filter(function(t){e(t)&&n.add(t)}),n},t.prototype.select=function(e){var n=new t;return this.forEach(function(t){return n.add(e(t))}),n},t.prototype.forEach=function(t){this.list.forEach(function(e){return t(e)})},t.prototype.toArray=function(){return this.list},t.prototype.join=function(e,n,o,r,i){void 0===i&&(i=!1);var a=new t;return this.list.forEach(function(t){var s=e.toArray().filter(function(e){return n(t)===o(e)});i&&s&&s.length<=0?a.add(r(t,null)):s.forEach(function(e){return a.add(r(t,e))})}),a},t.prototype.groupBy=function(e){var n={};return this.list.forEach(function(t){var o=JSON.stringify(e(t));n[o]=n[o]||[],n[o].push(t)}),new t(Object.keys(n).map(function(t){var e=t.substr(1,t.length-2);return new o.Group(e.split(","),n[t])}))},t.prototype.orderBy=function(e){return new t(this.list.sort(function(t,n){return e.compare(t,n)}))},t.prototype.union=function(t){return this.addRange(t.toArray()),this},t.prototype.distinct=function(e){var n=new t;return this.forEach(function(t){n.forEach(function(o){e.equals(t,o)||n.add(t)})}),n},t.prototype.skip=function(e){return e>0?new t(this.list.slice(e,this.list.length-1)):this},t.prototype.take=function(e){return e>0?new t(this.list.slice(0,e)):this},t.prototype.sum=function(t){var e=0;return this.list.forEach(function(n){return e+=t(n)}),e},t.prototype.avg=function(t){return this.sum(t)/this.length},t.prototype.min=function(t){var e=0,n=0;return this.list.forEach(function(o){if(0==n)e=t(o);else{var r=t(o);r<e&&(e=r)}n++}),e},t.prototype.max=function(t){var e=0,n=0;return this.list.forEach(function(o){if(0==n)e=t(o);else{var r=t(o);r>e&&(e=r)}n++}),e},t.prototype.count=function(t){if(void 0===t&&(t=null),!t)return this.length;var e=0;return this.list.forEach(function(n){t(n)&&e++}),e},t}();n.List=r,cc._RF.pop()},{"./collectutil":"collectutil"}],platform:[function(t,e,n){"use strict";cc._RF.push(e,"e5badlA9gJEv5+BAixy/tU0","platform");var o=this&&this.__spreadArrays||function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var o=Array(t),r=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};function r(t,e){try{var n=!1;(d||_||h)&&(n=!0),e&&n&&(e=JSON.stringify(e)),console.warn("[platform]: "+t+" ",e||"")}catch(o){console.warn("[platform]: "+t+" \u53c2\u6570\u6253\u5370\u5931\u8d25")}}function i(){r("current platform not support this api")}Object.defineProperty(n,"__esModule",{value:!0}),n.platformEnv=void 0,r("platformVersion","v1.6.5"),r("platformTagTime","2023-11-02");var a=!1;n.platformEnv={get isEgretGame(){return window&&window.egret&&window.egret.Capabilities},get isCocosGame(){return window&&window.cc&&window.cc.sys},get isCocos3(){return n.platformEnv.isCocosGame&&cc.sys.Platform&&cc.sys.Platform.WECHAT_GAME},get isDebug(){return!!a||!n.platformEnv.isCocosGame&&!!window.DEBUG},get isWX(){return n.platformEnv.isCocosGame?!n.platformEnv.isQQ&&(n.platformEnv.isCocos3?cc.sys.platform===cc.sys.Platform.WECHAT_GAME:cc.sys.platform===cc.sys.WECHAT_GAME):!!n.platformEnv.isEgretGame&&egret.Capabilities.runtimeType===egret.RuntimeType.WXGAME&&!n.platformEnv.isQQ},get isWXWindows(){var t,e,o=!1;return n.platformEnv.isWX&&(null===(e=null===(t=wx.getSystemInfoSync())||void 0===t?void 0:t.system.toLocaleLowerCase())||void 0===e?void 0:e.includes("windows"))&&(o=!0),o},get isWXMac(){var t,e,o=!1;return n.platformEnv.isWX&&(null===(e=null===(t=wx.getSystemInfoSync())||void 0===t?void 0:t.system.toLocaleLowerCase())||void 0===e?void 0:e.includes("mac"))&&(o=!0),o},get isTT(){return!!n.platformEnv.isCocosGame&&(cc.sys.platform===cc.sys.BYTEDANCE_GAME||cc.sys.platform===cc.sys.BYTEDANCE_MINI_GAME)},get isQQ(){return window&&window.qq&&"function"==typeof window.qq.login},get isHW(){return window&&window.qg&&"function"==typeof window.qg.gameLogin},get isNativeAPP(){return!n.platformEnv.isCocosGame&&!!n.platformEnv.isEgretGame&&egret.Capabilities.runtimeType===egret.RuntimeType.NATIVE},get isNativeIOSAPP(){return!n.platformEnv.isCocosGame&&!!n.platformEnv.isEgretGame&&egret.Capabilities.runtimeType===egret.RuntimeType.NATIVE&&"iOS"===egret.Capabilities.os},get isNativeAndroidAPP(){return!n.platformEnv.isCocosGame&&!!n.platformEnv.isEgretGame&&egret.Capabilities.runtimeType===egret.RuntimeType.NATIVE&&"Android"===egret.Capabilities.os},get isH5(){return n.platformEnv.isCocosGame?n.platformEnv.isCocos3?cc.sys.platform===cc.sys.Platform.DESKTOP_BROWSER||cc.sys.platform===cc.sys.Platform.MOBILE_BROWSER:cc.sys.platform===cc.sys.DESKTOP_BROWSER||cc.sys.platform===cc.sys.MOBILE_BROWSER:!!n.platformEnv.isEgretGame&&egret.Capabilities.runtimeType===egret.RuntimeType.WEB},get isMixMicroEnd(){if(window&&window.navigator&&window.navigator.userAgent){var t=window.navigator.userAgent;return t.indexOf("mix_micro_end_ios")>-1||t.indexOf("mix_micro_end_android")>-1}return!1},get isH5PageGame(){return n.platformEnv.isH5&&!n.platformEnv.isMixMicroEnd&&!("undefined"!=typeof HSDK&&HSDK.isOverseaH5)},get isH5PageGameOversea(){return n.platformEnv.isH5&&!n.platformEnv.isMixMicroEnd&&"undefined"!=typeof HSDK&&HSDK.isOverseaH5},get isMixMicroEndAndroid(){return!!(window&&window.navigator&&window.navigator.userAgent)&&window.navigator.userAgent.indexOf("mix_micro_end_android")>-1},get isNonMixMicroEnd(){if(window&&window.navigator&&window.navigator.userAgent){var t=window.navigator.userAgent;return t.indexOf("HortorApp")>-1||t.indexOf("gcApp")>-1||t.indexOf("HortorApk")>-1||t.indexOf("gcApk")>-1}return!1}};var s=n.platformEnv.isCocosGame,c=n.platformEnv.isCocos3,u=n.platformEnv.isDebug,l=n.platformEnv.isWX,f=n.platformEnv.isTT,p=n.platformEnv.isQQ,h=n.platformEnv.isHW,d=n.platformEnv.isNativeAPP,g=n.platformEnv.isNativeIOSAPP,y=n.platformEnv.isNativeAndroidAPP,m=n.platformEnv.isH5,_=n.platformEnv.isMixMicroEnd,v=n.platformEnv.isH5PageGame,I=n.platformEnv.isMixMicroEndAndroid,b=n.platformEnv.isNonMixMicroEnd;r(s?"isCocosGame":"isEgretGame"),n.platformEnv.isCocosGame&&r(c?"cocos 3.0":"cocos 2.0"),u&&r("isDebug"),l&&r("isWX"),f&&r("isTT"),p&&r("isQQ"),h&&r("isHW"),d&&r("isNativeAPP"),g&&r("isNativeIOSAPP"),y&&r("isNativeAndroidAPP"),m&&r("isH5"),_&&r("isMixMicroEnd"),v&&r("isH5PageGame"),n.platformEnv.isH5PageGameOversea&&r("isH5PageGameOversea"),I&&r("isMixMicroEndAndroid"),b&&r("isNonMixMicroEnd"),u&&void 0===window.HSDK&&(window.HSDK={},["ENV","LogType","EventType","NoticeType","SMSCodeType","QQScene","WXScene","QQMicroAppType","WXMicroAppType","MicroProgramType","BindPlatformType","AddicationType","SwitchStatus","OverseasCustomerType","ApmPostArea","NotifyRepeatType","NetworkType"].forEach(function(t){window.HSDK[t]={}}));var C=new(function(){function t(){this.user={tryLogin:function(){return r("user.tryLogin"),u?Promise.resolve():d?HSDK.tryLogin():Promise.reject(null)},login:function(t){return r("user.login",t),u?Promise.resolve():l||f||v||p||h||n.platformEnv.isH5PageGameOversea?HSDK.login(t):_||d?HSDK.dialogLogin():Promise.reject(null)},onLogin:function(t){r("user.onLogin",t),(l||f||v||p||h||d||_||n.platformEnv.isH5PageGameOversea)&&HSDK.onLogin(t)},multiPlatformLogin:function(t){return r("user.multiPlatformLogin",t),u?Promise.resolve():d||_?HSDK.dialogLogin(t):v||n.platformEnv.isH5PageGameOversea?HSDK.login():Promise.reject(null)},logout:function(){return r("user.logout"),u?Promise.resolve():d||l||_||n.platformEnv.isH5PageGameOversea?HSDK.logout():Promise.reject(null)},weakLogin:function(t){if(r("user.weakLogin",t),u){var e=localStorage.getItem("userId");e||(e=(new Date).getTime()+"",localStorage.setItem("userId",e));var n={id:e,name:e,authed:!!localStorage.getItem("_fakeAuthed")};return Promise.resolve(n)}return new Promise(function(e,n){l||f||v||p||h?HSDK.weakLogin(t).then(e).catch(function(t){n(t)}):_||d?HSDK.dialogLogin(t).then(e).catch(function(t){n(t)}):n("\u767b\u5f55\u5931\u8d25, \u6682\u4e0d\u652f\u6301\u8be5\u5e73\u53f0")})},createInfoBtn:function(t){return r("user.createInfoBtn",t),l||p?HSDK.createUserInfoButton(t):null},setPlayerInfo:function(t){r("user.setPlayerInfo",t),(l||p||f||h||d||_)&&HSDK.setGameUserInfo(t)},updateInfo:function(t){return r("user.updateInfo",t),u?Promise.resolve():l||f||p||h?HSDK.updateUserInfo(t):Promise.reject(null)},getIsFromChannel:function(){return r("user.getIsFromChannel"),l?HSDK.getIsFromChannel():Promise.reject({isFromChannel:!1})},getFacebookUserInfo:function(){return r("user.getFacebookUserInfo"),d?HSDK.getFacebookUserInfo():Promise.reject(null)},facebookLogin:function(){return r("user.facebookLogin"),u?Promise.resolve():d||_?HSDK.facebookLogin():Promise.reject(null)},googleLogin:function(){return r("user.googleLogin"),u?Promise.resolve():y||_?HSDK.googleLogin():Promise.reject(null)},bindPlatform:function(t){return r("user.bindPlatform",t),u?Promise.resolve():d||_?HSDK.bindPlatform(t):Promise.reject(null)},visitorLogin:function(){return r("user.visitorLogin"),u?Promise.resolve():d||_?HSDK.visitorLogin():Promise.reject(null)},showProtocol:function(){return r("user.showProtocol"),u?Promise.resolve():h||p?HSDK.showProtocol():Promise.reject(null)},onNeedPrivacyAuth:function(t){return r("user.onNeedPrivacyAuth",t),u?Promise.resolve():l?HSDK.onNeedPrivacyAuth(t):Promise.reject(null)},openPrivacyContract:function(){return r("user.openPrivacyContract"),u?Promise.resolve():l?HSDK.openPrivacyContract():Promise.reject(null)},requirePrivacyAuth:function(){return r("user.requirePrivacyAuth"),u?Promise.resolve():l?HSDK.requirePrivacyAuth():Promise.reject(null)},showUserCenter:function(){if(r("user.showUserCenter"),d)return HSDK.showUserCenter({})}},this.share={shareMsg:function(t){return r("share.shareMsg",t),u?Promise.resolve():l||d||_||f||p||h?HSDK.share(t):Promise.reject(null)},onShare:function(t){r("share.onShare",t),(l||p)&&HSDK.onShare(t)},onTimeline:function(t){r("share.onTimeline",t),(l||p)&&HSDK.onShareTimeline(t)},getShareData:function(t){return r("share.getShareData",t),u?Promise.resolve():l||d||p||h?HSDK.getShareData(t):Promise.reject(null)},wxShareMicroApp:function(t){return r("app.wxShareMicroApp",t),u?Promise.resolve():d||b||_?HSDK.wxShareMicroApp(t):Promise.reject(null)},decodeShareTicket:function(){return r("share.decodeShareTicket"),u?Promise.resolve():l?HSDK.decodeShareTicket():Promise.reject(null)},overseaMultiPlatformShare:function(t){return r("share.overseaMultiPlatformShare",t),u?Promise.resolve():d||_?HSDK.overseaMultiPlatformShare(t):Promise.reject(null)}},this.loading={show:function(t){r("loading.show",t),l||d||_||f||p||h?HSDK.showLoading(t):i()},hide:function(){r("loading.hide"),l||d||_||f||p||h?HSDK.hideLoading():i()}},this.ui={showAlert:function(t){r("ui.showAlert",t),(g||y||n.platformEnv.isH5PageGameOversea)&&HSDK.showAlert(t)},exitApp:function(){r("ui.exitApp"),(d||_||h)&&HSDK.exitApp()},onShow:function(t){r("ui.onShow",t),(l||d||_||f)&&HSDK.onShow(t)},onHide:function(t){r("ui.onHide",t),(l||d||_||f)&&HSDK.onHide(t)},showUserProtocol:function(){return r("ui.showUserProtocol"),d||_?(HSDK.openWebview({isShowUserProtocol:!0}),Promise.resolve()):h?HSDK.showUserProtocol():Promise.resolve()},showPrivacyPolicy:function(){return r("ui.showPrivacyPolicy"),d||_?(HSDK.openWebview({isShowUserPrivacy:!0}),Promise.resolve()):h?HSDK.showPrivacyPolicy():Promise.resolve()},closePayModal:function(){return r("ui.closePayModal"),u?Promise.resolve():n.platformEnv.isWXWindows&&HSDK.closeWindowsPayModal?HSDK.closeWindowsPayModal():n.platformEnv.isWXMac&&HSDK.closeMacPayModal?HSDK.closeMacPayModal():Promise.reject(null)}},this.ad={video:{preload:function(t){return r("ad.video.preload",t),u?Promise.resolve():d||_||l||f||p||h?HSDK.preloadAd(t):b?HSDK.preloadVideoAd(t):Promise.reject(null)},show:function(t){r("ad.video.show",t),d||_||l||f||p||h?HSDK.showAd(t):b&&HSDK.showVideoAd(t)}},banner:{preload:function(t){return r("ad.banner.preload",t),l||d||_||f?HSDK.preloadAd(t):Promise.reject(null)},show:function(t){r("ad.banner.show",t),(l||d||_||f)&&HSDK.showAd(t)},hide:function(t){return r("ad.banner.hide",t),u?Promise.resolve():l||d||_||f?HSDK.hideAd(t):Promise.reject(null)}},interstitial:{preload:function(t){return r("ad.interstitial.preload",t),u?Promise.resolve():l||d||_||f?HSDK.preloadAd(t):Promise.reject(null)},show:function(t){r("ad.interstitial.show",t),(l||d||_||f)&&HSDK.showAd(t)}},custom:{preload:function(t){return r("ad.custom.preload",t),u?Promise.resolve():l?HSDK.preloadAd(t):Promise.reject(null)},show:function(t){r("ad.custom.show",t),l&&HSDK.showAd(t)},hide:function(t){return r("ad.hide",t),u?Promise.resolve():l?HSDK.hideAd(t):Promise.reject(null)}}},this.track={gameLog:function(t){r("track.gameLog",t),(l||d||_||b||f||p||h||n.platformEnv.isH5PageGameOversea)&&HSDK.gameTrack(t)},apmLog:function(t){r("track.apmLog",t),(l||f)&&HSDK.postAPMLog(t)},gsLog:function(t){r("track.gsLog",t),l&&HSDK.trackGS(t)},postGameInfo:function(t){r("track.postGameInfo",t),y?HSDK.postGameInfo(t):i()},setTGAAccountId:function(t){r("track.setTGAAccountId",t),d||_?HSDK.setTGAUserAccountId(t):i()}},this.gm={getSwitchData:function(t){return r("gm.getSwitchData",t),u?Promise.resolve():HSDK.checkSwitches(t)},getNotice:function(t){return r("gm.getNotice",t),u?Promise.resolve():d||_?HSDK.getNoticeInfo(t):l||b||f||p||h?HSDK.getNotice(t):Promise.reject(null)},getProtocolText:function(){return r("gm.getProtocolText"),u?Promise.resolve():h||l||f||p?HSDK.getProtocolText():Promise.reject(null)}},this.subscribe={requestMsg:function(t){return r("subscribe.requestMsg",t),u?Promise.resolve():l||f?HSDK.requestSubscribeMessage(t):Promise.reject(null)},getCount:function(){return r("subscribe.getCount"),u?Promise.resolve():l||f?HSDK.getSubscribeMessageCount():Promise.reject(null)},getHasSubscribedGameUpdate:function(){return r("subscribe.getHasSubscribedGameUpdate"),u?Promise.resolve():l?HSDK.getHasSubscribedGameUpdate():Promise.reject(null)},requestSubscribeGameUpdate:function(){return r("subscribe.requestSubscribeGameUpdate"),u?Promise.resolve():l?HSDK.requestSubscribeGameUpdate():Promise.reject(null)}},this.realName={getInfo:function(){return r("realName.getInfo"),u?Promise.resolve():d||_?HSDK.getRealNameInfo():Promise.reject(null)}},this.antiAddiction={listen:function(t){r("antiAddiction.listen",t),(d||_)&&HSDK.onAddictionQuit(t)}},this.apple={showComment:function(t){r("apple.showComment",t),g&&HSDK.showAppComment(t)},onPaySupplement:function(t){r("apple.onPaySupplement",t),g&&HSDK.onApplePaySupplement(t)},deleteAccount:function(){return r("apple.deleteAccount"),u?Promise.resolve():g?HSDK.deleteAppleAccount():Promise.reject(null)}},this.wall={getTaskList:function(t){return r("wall.getTaskList",t),u?Promise.resolve():l?HSDK.getTask(t):Promise.reject(null)},logOpenTaskPanel:function(){r("wall.logOpenTaskPanel"),l&&HSDK.logOpenTaskPanel()},goTask:function(t){return r("wall.goTask",t),u?Promise.resolve():l?HSDK.goTask(t):Promise.reject(null)},getAward:function(t){return r("wall.getAward",t),u?Promise.resolve():l?HSDK.getAward(t):Promise.reject(null)}},this.customer={openMiniApp:function(t){return r("customer.openMiniApp",t),u?Promise.resolve():l?HSDK.openCustomerMiniApp(t):Promise.reject(null)},openConversation:function(t){return r("customer.openConversation"),u?Promise.resolve():l?HSDK.openCustomerServiceConversation(t):Promise.reject(null)},createContactButton:function(t){return r("customer.createContactButton"),u?Promise.resolve():f?HSDK.createContactButton(t):Promise.reject(null)},getGSInfo:function(){return r("customer.getGSInfo"),u?Promise.resolve():l?HSDK.getGSInfo():Promise.reject(null)},jumpGSCustomer:function(){return r("customer.jumpGSCustomer"),u?Promise.resolve():l?HSDK.jumpGSCustomer():Promise.reject(null)},openOverseasCustomer:function(t){if(r("customer.openOverseasCustomer"),d)return HSDK.openOverseasCustomer(t)},onCustomerUnreadMsg:function(t){r("customer.onCustomerUnreadMsg"),d&&HSDK.onCustomerUnreadMsg(t)}},this.app={afReport:function(t){r("app.afReport",t),d&&HSDK.afReport(t)},getTranslateResult:function(t){return r("app.getTranslateResult",t),d?HSDK.getTranslateResult(t):Promise.reject(null)},open:function(t){r("app.open",t),(d||_)&&HSDK.openApp(t)},checkNotifyAuth:function(){return r("app.checkNotifyAuth"),d?HSDK.checkNotifyAuth():Promise.reject(null)},getNotifyData:function(t){return r("app.getNotifyData",t),u?Promise.resolve():d?HSDK.getNotifyData(t):Promise.reject(null)},pushLocalNotify:function(t){r("app.pushLocalNotify",t),d&&HSDK.pushLocalNotify(t)},removeLocalNotify:function(t){r("app.removeLocalNotify",t),d&&HSDK.removeLocalNotify(t)},openNotifyAction:function(){r("app.openNotifyAction"),d&&HSDK.openNotifyAction()},stopLocalNotifyAction:function(){r("app.stopLocalNotifyAction"),d&&HSDK.stopLocalNotifyAction()},stopNotifyAction:function(){r("app.stopNotifyAction"),g&&HSDK.stopNotifyAction()},getNotifyWithLaunch:function(t){r("app.getNotifyWithLaunch",t),g&&HSDK.getNotifyWithLaunch(t)},syncWxUserInfo:function(){return r("app.syncWxUserInfo"),u?Promise.resolve():d||_?HSDK.syncWxUserInfo():Promise.reject(null)},showComment:function(t){r("app.showComment",t),(d||h||l)&&HSDK.showAppComment(t)},openWebview:function(t){r("app.openWebview",t),(d||_)&&HSDK.openWebview(t)},checkRunningProcess:function(t){return r("app.checkRunningProcess",t),u?Promise.resolve():y||_?HSDK.checkRunningProcess(t):Promise.reject(null)},deleteAccount:function(){return r("app.deleteAccount"),u?Promise.resolve():g?HSDK.deleteAppleAccount():h?HSDK.deleteAccount():Promise.reject(null)},createDesktopIcon:function(t){return r("app.createDesktopIcon",t),u?Promise.resolve():h?HSDK.createDesktopIcon(t):Promise.reject(null)},getDesktopIcon:function(){return r("app.getDesktopIcon"),u?Promise.resolve():h?HSDK.getDesktopIcon():Promise.reject(null)}},this.web={createShortcut:function(t){return r("h5.createShortcut",t),u?Promise.resolve():n.platformEnv.isH5PageGameOversea?HSDK.createShortcut(t):Promise.reject(null)}},this.file={saveImage:function(t){return r("file.saveImage",t),u?Promise.resolve():d||_||b||l||p||f?HSDK.saveImage(t):Promise.reject(null)},getPath:function(t){return r("file.getPath",t),u?Promise.resolve():y||I?HSDK.getFilePath(t):Promise.reject(null)},download:function(t){r("file.download",t),(y||I)&&HSDK.downloadFile(t)}},this.device={getBrightness:function(){return r("device.getBrightness"),u?Promise.resolve():d||l||f?HSDK.getBrightness():Promise.reject(null)},setBrightness:function(t){return r("device.setBrightness",t),u?Promise.resolve():d||l||f?HSDK.setBrightness(t):Promise.reject(null)},getBattery:function(){return r("device.getBattery"),u?Promise.resolve():d||l||f?HSDK.getBattery():Promise.reject(null)},getNetworkType:function(){return r("device.getNetworkType"),u?Promise.resolve():d||l||f?HSDK.getNetworkType():Promise.reject(null)},setClipboard:function(t){if(r("device.setClipboard"),d||_||h)return HSDK.setClipboard(t)},getClipboard:function(){return r("device.getClipboard"),h?HSDK.getClipboard():Promise.resolve()},setKeepScreenOn:function(t){return u?Promise.resolve():d||l||f||_?HSDK.setKeepScreenOn(t):Promise.reject(null)},setVibrate:function(t){return u?Promise.reject():d||_||p||l||f?HSDK.setVibrate(t):Promise.reject(null)},onBackBtnTap:function(t){return!!y&&HSDK.onBackBtnTap(t)},selectLocalImage:function(){return u?Promise.resolve():d?HSDK.selectLocalImage():Promise.reject(null)}},this.tool={getGameRecorderManager:function(){return u?Promise.resolve():f?HSDK.getGameRecorderManager():Promise.reject(null)},openWebview:function(){return HSDK.openWebview()},getSecretKey:function(t){return r("tool.getSecretKey"),u?Promise.resolve():l||d?HSDK.getKeyByKeyType(t):Promise.reject(null)},getPayCurrency:function(t){return r("tool.getPayCurrency"),u?Promise.resolve():d?HSDK.getPayCurrency(t):Promise.reject(null)},debugInfo:function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(r("tool.debugInfo"),l)return HSDK.debug.apply(HSDK,o([t],e))}},this.miniProgram={checkIsAddedToMyMiniProgram:function(){return r("miniProgram.checkIsAddedToMyMiniProgram"),l?HSDK.checkIsAddedToMyMiniProgram():Promise.reject(null)},checkGift:function(){return r("miniProgram.checkGift"),l?HSDK.checkGift():Promise.resolve(!1)},showGift:function(t){return r("miniProgram.showGift"),l?HSDK.showGift(t):Promise.reject(null)},payGift:function(t){return r("miniProgram.payGift"),l?HSDK.payGift(t):Promise.reject(null)}},this.brandWall={getGameList:function(){return r("brandWall.getGameList"),u?Promise.resolve():l?HSDK.getBrandWallList():Promise.reject(null)},jumpGame:function(t){return r("brandWall.jumpGame",t),u?Promise.resolve():l?HSDK.jumpBrandWallGame(t):Promise.reject(null)},trackShow:function(){r("brandWall.trackShow"),u||l&&HSDK.brandWallShowTrack()}}}return t.prototype.init=function(t){return r("init",t),t.isPlatformForceDebug&&(a=!0,u=!0),u?Promise.resolve():HSDK.init(t)},t.prototype.getHTLauchOptions=function(){return r("getHTLauchOptions"),l||f?HSDK.getHTLauchOptions():null},t.prototype.pay=function(t){return r("pay"),u?Promise.resolve():y||I?r("android pay",t)||HSDK.dialogPay(t):g?r("ios pay",t)||HSDK.applePay(t):l||h?r("wx | hw pay",t)||HSDK.pay(t):b?r("h5 pay",t)||HSDK.pay(t):f?r("tt pay",t)||HSDK.pay(t):p?r("qq pay",t)||HSDK.pay(t):v?r("h5-public pay",t)||HSDK.pay(t):n.platformEnv.isH5PageGameOversea?r("h5-oversea pay",t)||HSDK.pay(t):Promise.reject(null)},t.prototype.closeWindowsPayModal=function(){return r("closeWindowsPayModal"),u?Promise.resolve():n.platformEnv.isWXWindows?HSDK.closeWindowsPayModal():Promise.reject(null)},t.prototype.resetSDK=function(){r("resetSDK"),u||f&&HSDK.resetSDK()},t}());n.default=C,cc._RF.pop()},{}]},{},["ArenaManager","Guide_Auto","RequireTips_Auto","Tips_Auto","AutoSorting","ChestAnim","CollectMgr","CameraCtrl","DamageTxt","Drops","GameManager","GuideView","HeartCtrl","HeroView","AreaInfo","BossRegion","MapCtrl","ObjStruct","Region","MineObj","TeleportObj","TileDrops","TileGrid","TileGround","BlockObj","ChestObj","DoorObj","HomeObj","PlantObj","SpawnObj","TileObject","TriggerObj","WorksObj","TileTips","Bat2Monster","BatMonster","Monster","MonsterAttack","MonsterChase","MonsterDead","MonsterIdle","MonsterPatrol","MonsterStateBase","Slime2Attack","Slime2Dead","Slime2Idle","Slime2Monster","SlimeAttack","SlimeChase","SlimeMonster","SlimePatrol","PlayerCtrl","PlayerDead","PlayerDig","PlayerFight","PlayerHurt","PlayerIdle","PlayerMove","PlayerStateBase","ScreenEffectMask","StartGameCtrl","MainTouchCtrl","MapScroll","TouchPad","CraftTaskMgr","Factory","GuideMgr","platform","Main","AnimationManager","EffectManager","EventCenter","MoveManager","PoolManager","SoundManager","DialogMgr","MiniMapMgr","StorageMgr","UnlockMgr","Inventory","ItemInfo","Operator","PlayerTask","RequireTips","Res","ScaleScreen","MapTest","TouchPad2","BlockCrack","TipsBoard","BoardcastItem","BoardcastItemBase","BoardcastItemNew","BpItem","BuildItem","MatItem","MyListCom","U_Backpack","U_BuildMenu","U_CollectionTips","U_CollectionWindow","U_ContTips","U_CraftMenu","U_CraftMenu2","U_HUD","U_ItemDetail","U_MapWindow","U_TaskRequire","U_TitleBoard","FuiCom","FlyIcon","GetItemTips","UI","UICtrl","UINode","U_Boardcast","U_Dialog","U_Modal","U_PopupTips","U_PosTips","U_Shop","U_TaskTips","U_TouchPad","U_UIEffects","Widget","WidgetUINode","CocosExtension","CocosFixed","NumberFormatter","StateCtrl","arraycollection","collectutil","dictionary","interfaces","list","config","DiggingUIBinder","UI_Backpack","UI_CollectionTips","UI_CollectionWindow","UI_ContTips","UI_Dialog","UI_DialogHead","UI_HUD","UI_ItemDetail","UI_Map","UI_MapBottom","UI_MapBtn","UI_MapGrp","UI_MapTips","UI_MapTop","UI_MapWindow","UI_Modal","UI_PopupTips","UI_Shop","UI_ShopBuyItem","UI_ShopSoldItem","UI_Springboard","UI_TaskRequireMenu","UI_TaskTips","UI_TipsBoard","UI_backpackCom","UI_bottomUI","UI_bpItem","UI_buildItem","UI_collectionContentCom","UI_collectionContentItem","UI_collectionMenuCom","UI_craftPage","UI_dialogCom","UI_dialogContinue","UI_frame","UI_itemSelectPanel","UI_lockFrame","UI_mapLockNode","UI_mapTipsNode","UI_mapUnlockNode","UI_matItem","UI_newTips","UI_posTips","UI_requireTaskItem","UI_requireTaskReward","UI_requireTaskSubCom","UI_shopCraftItem","UI_shopCraftMatItem","UI_slot","UI_tabBtn","UI_taskBoard","UI_taskRequireMatItem","UI_topUI","UI_trackingCraft","UI_trackingRequireItem"]);